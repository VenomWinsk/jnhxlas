{"remainingRequest":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/babel-loader/lib/index.js!/home/hx_ygg/job/hx_logana3.0/web/node_modules/eslint-loader/index.js??ref--13-0!/home/hx_ygg/job/hx_logana3.0/web/src/lib/plugin/zTree_v3/js/jquery.ztree.core.js","dependencies":[{"path":"/home/hx_ygg/job/hx_logana3.0/web/src/lib/plugin/zTree_v3/js/jquery.ztree.core.js","mtime":1631238422177},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YgPSByZXF1aXJlKCIvaG9tZS9oeF95Z2cvam9iL2h4X2xvZ2FuYTMuMC93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIikuZGVmYXVsdDsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIik7CgovKgogKiBKUXVlcnkgelRyZWUgY29yZQogKiB2My41LjQ2CiAqIGh0dHA6Ly90cmVlanMuY24vCiAqCiAqIENvcHlyaWdodCAoYykgMjAxMCBIdW50ZXIuegogKgogKiBMaWNlbnNlZCBzYW1lIGFzIGpxdWVyeSAtIE1JVCBMaWNlbnNlCiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwCiAqCiAqIERhdGU6IDIwMjAtMTEtMjEKICovCihmdW5jdGlvbiAoXyQpIHsKICB2YXIgc2V0dGluZ3MgPSB7fSwKICAgICAgcm9vdHMgPSB7fSwKICAgICAgY2FjaGVzID0ge30sCiAgICAgIC8vZGVmYXVsdCBjb25zdHMgb2YgY29yZQogIF9jb25zdHMgPSB7CiAgICBjbGFzc05hbWU6IHsKICAgICAgQlVUVE9OOiAiYnV0dG9uIiwKICAgICAgTEVWRUw6ICJsZXZlbCIsCiAgICAgIElDT19MT0FESU5HOiAiaWNvX2xvYWRpbmciLAogICAgICBTV0lUQ0g6ICJzd2l0Y2giLAogICAgICBOQU1FOiAnbm9kZV9uYW1lJwogICAgfSwKICAgIGV2ZW50OiB7CiAgICAgIE5PREVDUkVBVEVEOiAienRyZWVfbm9kZUNyZWF0ZWQiLAogICAgICBDTElDSzogInp0cmVlX2NsaWNrIiwKICAgICAgRVhQQU5EOiAienRyZWVfZXhwYW5kIiwKICAgICAgQ09MTEFQU0U6ICJ6dHJlZV9jb2xsYXBzZSIsCiAgICAgIEFTWU5DX1NVQ0NFU1M6ICJ6dHJlZV9hc3luY19zdWNjZXNzIiwKICAgICAgQVNZTkNfRVJST1I6ICJ6dHJlZV9hc3luY19lcnJvciIsCiAgICAgIFJFTU9WRTogInp0cmVlX3JlbW92ZSIsCiAgICAgIFNFTEVDVEVEOiAienRyZWVfc2VsZWN0ZWQiLAogICAgICBVTlNFTEVDVEVEOiAienRyZWVfdW5zZWxlY3RlZCIKICAgIH0sCiAgICBpZDogewogICAgICBBOiAiX2EiLAogICAgICBJQ09OOiAiX2ljbyIsCiAgICAgIFNQQU46ICJfc3BhbiIsCiAgICAgIFNXSVRDSDogIl9zd2l0Y2giLAogICAgICBVTDogIl91bCIKICAgIH0sCiAgICBsaW5lOiB7CiAgICAgIFJPT1Q6ICJyb290IiwKICAgICAgUk9PVFM6ICJyb290cyIsCiAgICAgIENFTlRFUjogImNlbnRlciIsCiAgICAgIEJPVFRPTTogImJvdHRvbSIsCiAgICAgIE5PTElORTogIm5vbGluZSIsCiAgICAgIExJTkU6ICJsaW5lIgogICAgfSwKICAgIGZvbGRlcjogewogICAgICBPUEVOOiAib3BlbiIsCiAgICAgIENMT1NFOiAiY2xvc2UiLAogICAgICBET0NVOiAiZG9jdSIKICAgIH0sCiAgICBub2RlOiB7CiAgICAgIENVUlNFTEVDVEVEOiAiY3VyU2VsZWN0ZWROb2RlIgogICAgfQogIH0sCiAgICAgIC8vZGVmYXVsdCBzZXR0aW5nIG9mIGNvcmUKICBfc2V0dGluZyA9IHsKICAgIHRyZWVJZDogIiIsCiAgICB0cmVlT2JqOiBudWxsLAogICAgdmlldzogewogICAgICBhZGREaXlEb206IG51bGwsCiAgICAgIGF1dG9DYW5jZWxTZWxlY3RlZDogdHJ1ZSwKICAgICAgZGJsQ2xpY2tFeHBhbmQ6IHRydWUsCiAgICAgIGV4cGFuZFNwZWVkOiAiZmFzdCIsCiAgICAgIGZvbnRDc3M6IHt9LAogICAgICBub2RlQ2xhc3Nlczoge30sCiAgICAgIG5hbWVJc0hUTUw6IGZhbHNlLAogICAgICBzZWxlY3RlZE11bHRpOiB0cnVlLAogICAgICBzaG93SWNvbjogdHJ1ZSwKICAgICAgc2hvd0xpbmU6IHRydWUsCiAgICAgIHNob3dUaXRsZTogdHJ1ZSwKICAgICAgdHh0U2VsZWN0ZWRFbmFibGU6IGZhbHNlCiAgICB9LAogICAgZGF0YTogewogICAgICBrZXk6IHsKICAgICAgICBpc1BhcmVudDogImlzUGFyZW50IiwKICAgICAgICBjaGlsZHJlbjogImNoaWxkcmVuIiwKICAgICAgICBuYW1lOiAibmFtZSIsCiAgICAgICAgdGl0bGU6ICIiLAogICAgICAgIHVybDogInVybCIsCiAgICAgICAgaWNvbjogImljb24iCiAgICAgIH0sCiAgICAgIHJlbmRlcjogewogICAgICAgIG5hbWU6IG51bGwsCiAgICAgICAgdGl0bGU6IG51bGwKICAgICAgfSwKICAgICAgc2ltcGxlRGF0YTogewogICAgICAgIGVuYWJsZTogZmFsc2UsCiAgICAgICAgaWRLZXk6ICJpZCIsCiAgICAgICAgcElkS2V5OiAicElkIiwKICAgICAgICByb290UElkOiBudWxsCiAgICAgIH0sCiAgICAgIGtlZXA6IHsKICAgICAgICBwYXJlbnQ6IGZhbHNlLAogICAgICAgIGxlYWY6IGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICBhc3luYzogewogICAgICBlbmFibGU6IGZhbHNlLAogICAgICBjb250ZW50VHlwZTogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIsCiAgICAgIHR5cGU6ICJwb3N0IiwKICAgICAgZGF0YVR5cGU6ICJ0ZXh0IiwKICAgICAgaGVhZGVyczoge30sCiAgICAgIHhockZpZWxkczoge30sCiAgICAgIHVybDogIiIsCiAgICAgIGF1dG9QYXJhbTogW10sCiAgICAgIG90aGVyUGFyYW06IFtdLAogICAgICBkYXRhRmlsdGVyOiBudWxsCiAgICB9LAogICAgY2FsbGJhY2s6IHsKICAgICAgYmVmb3JlQXN5bmM6IG51bGwsCiAgICAgIGJlZm9yZUNsaWNrOiBudWxsLAogICAgICBiZWZvcmVEYmxDbGljazogbnVsbCwKICAgICAgYmVmb3JlUmlnaHRDbGljazogbnVsbCwKICAgICAgYmVmb3JlTW91c2VEb3duOiBudWxsLAogICAgICBiZWZvcmVNb3VzZVVwOiBudWxsLAogICAgICBiZWZvcmVFeHBhbmQ6IG51bGwsCiAgICAgIGJlZm9yZUNvbGxhcHNlOiBudWxsLAogICAgICBiZWZvcmVSZW1vdmU6IG51bGwsCiAgICAgIG9uQXN5bmNFcnJvcjogbnVsbCwKICAgICAgb25Bc3luY1N1Y2Nlc3M6IG51bGwsCiAgICAgIG9uTm9kZUNyZWF0ZWQ6IG51bGwsCiAgICAgIG9uQ2xpY2s6IG51bGwsCiAgICAgIG9uRGJsQ2xpY2s6IG51bGwsCiAgICAgIG9uUmlnaHRDbGljazogbnVsbCwKICAgICAgb25Nb3VzZURvd246IG51bGwsCiAgICAgIG9uTW91c2VVcDogbnVsbCwKICAgICAgb25FeHBhbmQ6IG51bGwsCiAgICAgIG9uQ29sbGFwc2U6IG51bGwsCiAgICAgIG9uUmVtb3ZlOiBudWxsCiAgICB9CiAgfSwKICAgICAgLy9kZWZhdWx0IHJvb3Qgb2YgY29yZQogIC8velRyZWUgdXNlIHJvb3QgdG8gc2F2ZSBmdWxsIGRhdGEKICBfaW5pdFJvb3QgPSBmdW5jdGlvbiBfaW5pdFJvb3Qoc2V0dGluZykgewogICAgdmFyIHIgPSBkYXRhLmdldFJvb3Qoc2V0dGluZyk7CgogICAgaWYgKCFyKSB7CiAgICAgIHIgPSB7fTsKICAgICAgZGF0YS5zZXRSb290KHNldHRpbmcsIHIpOwogICAgfQoKICAgIGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIHIsIFtdKTsKICAgIHIuZXhwYW5kVHJpZ2dlckZsYWcgPSBmYWxzZTsKICAgIHIuY3VyU2VsZWN0ZWRMaXN0ID0gW107CiAgICByLm5vU2VsZWN0aW9uID0gdHJ1ZTsKICAgIHIuY3JlYXRlZE5vZGVzID0gW107CiAgICByLnpJZCA9IDA7CiAgICByLl92ZXIgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICB9LAogICAgICAvL2RlZmF1bHQgY2FjaGUgb2YgY29yZQogIF9pbml0Q2FjaGUgPSBmdW5jdGlvbiBfaW5pdENhY2hlKHNldHRpbmcpIHsKICAgIHZhciBjID0gZGF0YS5nZXRDYWNoZShzZXR0aW5nKTsKCiAgICBpZiAoIWMpIHsKICAgICAgYyA9IHt9OwogICAgICBkYXRhLnNldENhY2hlKHNldHRpbmcsIGMpOwogICAgfQoKICAgIGMubm9kZXMgPSBbXTsKICAgIGMuZG9tcyA9IFtdOwogIH0sCiAgICAgIC8vZGVmYXVsdCBiaW5kRXZlbnQgb2YgY29yZQogIF9iaW5kRXZlbnQgPSBmdW5jdGlvbiBfYmluZEV2ZW50KHNldHRpbmcpIHsKICAgIHZhciBvID0gc2V0dGluZy50cmVlT2JqLAogICAgICAgIGMgPSBjb25zdHMuZXZlbnQ7CiAgICBvLmJpbmQoYy5OT0RFQ1JFQVRFRCwgZnVuY3Rpb24gKGV2ZW50LCB0cmVlSWQsIG5vZGUpIHsKICAgICAgdG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5vbk5vZGVDcmVhdGVkLCBbZXZlbnQsIHRyZWVJZCwgbm9kZV0pOwogICAgfSk7CiAgICBvLmJpbmQoYy5DTElDSywgZnVuY3Rpb24gKGV2ZW50LCBzcmNFdmVudCwgdHJlZUlkLCBub2RlLCBjbGlja0ZsYWcpIHsKICAgICAgdG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5vbkNsaWNrLCBbc3JjRXZlbnQsIHRyZWVJZCwgbm9kZSwgY2xpY2tGbGFnXSk7CiAgICB9KTsKICAgIG8uYmluZChjLkVYUEFORCwgZnVuY3Rpb24gKGV2ZW50LCB0cmVlSWQsIG5vZGUpIHsKICAgICAgdG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5vbkV4cGFuZCwgW2V2ZW50LCB0cmVlSWQsIG5vZGVdKTsKICAgIH0pOwogICAgby5iaW5kKGMuQ09MTEFQU0UsIGZ1bmN0aW9uIChldmVudCwgdHJlZUlkLCBub2RlKSB7CiAgICAgIHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2sub25Db2xsYXBzZSwgW2V2ZW50LCB0cmVlSWQsIG5vZGVdKTsKICAgIH0pOwogICAgby5iaW5kKGMuQVNZTkNfU1VDQ0VTUywgZnVuY3Rpb24gKGV2ZW50LCB0cmVlSWQsIG5vZGUsIG1zZykgewogICAgICB0b29scy5hcHBseShzZXR0aW5nLmNhbGxiYWNrLm9uQXN5bmNTdWNjZXNzLCBbZXZlbnQsIHRyZWVJZCwgbm9kZSwgbXNnXSk7CiAgICB9KTsKICAgIG8uYmluZChjLkFTWU5DX0VSUk9SLCBmdW5jdGlvbiAoZXZlbnQsIHRyZWVJZCwgbm9kZSwgWE1MSHR0cFJlcXVlc3QsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CiAgICAgIHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2sub25Bc3luY0Vycm9yLCBbZXZlbnQsIHRyZWVJZCwgbm9kZSwgWE1MSHR0cFJlcXVlc3QsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duXSk7CiAgICB9KTsKICAgIG8uYmluZChjLlJFTU9WRSwgZnVuY3Rpb24gKGV2ZW50LCB0cmVlSWQsIHRyZWVOb2RlKSB7CiAgICAgIHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2sub25SZW1vdmUsIFtldmVudCwgdHJlZUlkLCB0cmVlTm9kZV0pOwogICAgfSk7CiAgICBvLmJpbmQoYy5TRUxFQ1RFRCwgZnVuY3Rpb24gKGV2ZW50LCB0cmVlSWQsIG5vZGUpIHsKICAgICAgdG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5vblNlbGVjdGVkLCBbdHJlZUlkLCBub2RlXSk7CiAgICB9KTsKICAgIG8uYmluZChjLlVOU0VMRUNURUQsIGZ1bmN0aW9uIChldmVudCwgdHJlZUlkLCBub2RlKSB7CiAgICAgIHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2sub25VblNlbGVjdGVkLCBbdHJlZUlkLCBub2RlXSk7CiAgICB9KTsKICB9LAogICAgICBfdW5iaW5kRXZlbnQgPSBmdW5jdGlvbiBfdW5iaW5kRXZlbnQoc2V0dGluZykgewogICAgdmFyIG8gPSBzZXR0aW5nLnRyZWVPYmosCiAgICAgICAgYyA9IGNvbnN0cy5ldmVudDsKICAgIG8udW5iaW5kKGMuTk9ERUNSRUFURUQpLnVuYmluZChjLkNMSUNLKS51bmJpbmQoYy5FWFBBTkQpLnVuYmluZChjLkNPTExBUFNFKS51bmJpbmQoYy5BU1lOQ19TVUNDRVNTKS51bmJpbmQoYy5BU1lOQ19FUlJPUikudW5iaW5kKGMuUkVNT1ZFKS51bmJpbmQoYy5TRUxFQ1RFRCkudW5iaW5kKGMuVU5TRUxFQ1RFRCk7CiAgfSwKICAgICAgLy9kZWZhdWx0IGV2ZW50IHByb3h5IG9mIGNvcmUKICBfZXZlbnRQcm94eSA9IGZ1bmN0aW9uIF9ldmVudFByb3h5KGV2ZW50KSB7CiAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0LAogICAgICAgIHNldHRpbmcgPSBkYXRhLmdldFNldHRpbmcoZXZlbnQuZGF0YS50cmVlSWQpLAogICAgICAgIHRJZCA9ICIiLAogICAgICAgIG5vZGUgPSBudWxsLAogICAgICAgIG5vZGVFdmVudFR5cGUgPSAiIiwKICAgICAgICB0cmVlRXZlbnRUeXBlID0gIiIsCiAgICAgICAgbm9kZUV2ZW50Q2FsbGJhY2sgPSBudWxsLAogICAgICAgIHRyZWVFdmVudENhbGxiYWNrID0gbnVsbCwKICAgICAgICB0bXAgPSBudWxsOwoKICAgIGlmICh0b29scy5lcXMoZXZlbnQudHlwZSwgIm1vdXNlZG93biIpKSB7CiAgICAgIHRyZWVFdmVudFR5cGUgPSAibW91c2Vkb3duIjsKICAgIH0gZWxzZSBpZiAodG9vbHMuZXFzKGV2ZW50LnR5cGUsICJtb3VzZXVwIikpIHsKICAgICAgdHJlZUV2ZW50VHlwZSA9ICJtb3VzZXVwIjsKICAgIH0gZWxzZSBpZiAodG9vbHMuZXFzKGV2ZW50LnR5cGUsICJjb250ZXh0bWVudSIpKSB7CiAgICAgIHRyZWVFdmVudFR5cGUgPSAiY29udGV4dG1lbnUiOwogICAgfSBlbHNlIGlmICh0b29scy5lcXMoZXZlbnQudHlwZSwgImNsaWNrIikpIHsKICAgICAgaWYgKHRvb2xzLmVxcyh0YXJnZXQudGFnTmFtZSwgInNwYW4iKSAmJiB0YXJnZXQuZ2V0QXR0cmlidXRlKCJ0cmVlTm9kZSIgKyBjb25zdHMuaWQuU1dJVENIKSAhPT0gbnVsbCkgewogICAgICAgIHRJZCA9IHRvb2xzLmdldE5vZGVNYWluRG9tKHRhcmdldCkuaWQ7CiAgICAgICAgbm9kZUV2ZW50VHlwZSA9ICJzd2l0Y2hOb2RlIjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0bXAgPSB0b29scy5nZXRNRG9tKHNldHRpbmcsIHRhcmdldCwgW3sKICAgICAgICAgIHRhZ05hbWU6ICJhIiwKICAgICAgICAgIGF0dHJOYW1lOiAidHJlZU5vZGUiICsgY29uc3RzLmlkLkEKICAgICAgICB9XSk7CgogICAgICAgIGlmICh0bXApIHsKICAgICAgICAgIHRJZCA9IHRvb2xzLmdldE5vZGVNYWluRG9tKHRtcCkuaWQ7CiAgICAgICAgICBub2RlRXZlbnRUeXBlID0gImNsaWNrTm9kZSI7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHRvb2xzLmVxcyhldmVudC50eXBlLCAiZGJsY2xpY2siKSkgewogICAgICB0cmVlRXZlbnRUeXBlID0gImRibGNsaWNrIjsKICAgICAgdG1wID0gdG9vbHMuZ2V0TURvbShzZXR0aW5nLCB0YXJnZXQsIFt7CiAgICAgICAgdGFnTmFtZTogImEiLAogICAgICAgIGF0dHJOYW1lOiAidHJlZU5vZGUiICsgY29uc3RzLmlkLkEKICAgICAgfV0pOwoKICAgICAgaWYgKHRtcCkgewogICAgICAgIHRJZCA9IHRvb2xzLmdldE5vZGVNYWluRG9tKHRtcCkuaWQ7CiAgICAgICAgbm9kZUV2ZW50VHlwZSA9ICJzd2l0Y2hOb2RlIjsKICAgICAgfQogICAgfQoKICAgIGlmICh0cmVlRXZlbnRUeXBlLmxlbmd0aCA+IDAgJiYgdElkLmxlbmd0aCA9PSAwKSB7CiAgICAgIHRtcCA9IHRvb2xzLmdldE1Eb20oc2V0dGluZywgdGFyZ2V0LCBbewogICAgICAgIHRhZ05hbWU6ICJhIiwKICAgICAgICBhdHRyTmFtZTogInRyZWVOb2RlIiArIGNvbnN0cy5pZC5BCiAgICAgIH1dKTsKCiAgICAgIGlmICh0bXApIHsKICAgICAgICB0SWQgPSB0b29scy5nZXROb2RlTWFpbkRvbSh0bXApLmlkOwogICAgICB9CiAgICB9IC8vIGV2ZW50IHRvIG5vZGUKCgogICAgaWYgKHRJZC5sZW5ndGggPiAwKSB7CiAgICAgIG5vZGUgPSBkYXRhLmdldE5vZGVDYWNoZShzZXR0aW5nLCB0SWQpOwoKICAgICAgc3dpdGNoIChub2RlRXZlbnRUeXBlKSB7CiAgICAgICAgY2FzZSAic3dpdGNoTm9kZSI6CiAgICAgICAgICB2YXIgaXNQYXJlbnQgPSBkYXRhLm5vZGVJc1BhcmVudChzZXR0aW5nLCBub2RlKTsKCiAgICAgICAgICBpZiAoIWlzUGFyZW50KSB7CiAgICAgICAgICAgIG5vZGVFdmVudFR5cGUgPSAiIjsKICAgICAgICAgIH0gZWxzZSBpZiAodG9vbHMuZXFzKGV2ZW50LnR5cGUsICJjbGljayIpIHx8IHRvb2xzLmVxcyhldmVudC50eXBlLCAiZGJsY2xpY2siKSAmJiB0b29scy5hcHBseShzZXR0aW5nLnZpZXcuZGJsQ2xpY2tFeHBhbmQsIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0sIHNldHRpbmcudmlldy5kYmxDbGlja0V4cGFuZCkpIHsKICAgICAgICAgICAgbm9kZUV2ZW50Q2FsbGJhY2sgPSBoYW5kbGVyLm9uU3dpdGNoTm9kZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5vZGVFdmVudFR5cGUgPSAiIjsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiY2xpY2tOb2RlIjoKICAgICAgICAgIG5vZGVFdmVudENhbGxiYWNrID0gaGFuZGxlci5vbkNsaWNrTm9kZTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9IC8vIGV2ZW50IHRvIHpUcmVlCgoKICAgIHN3aXRjaCAodHJlZUV2ZW50VHlwZSkgewogICAgICBjYXNlICJtb3VzZWRvd24iOgogICAgICAgIHRyZWVFdmVudENhbGxiYWNrID0gaGFuZGxlci5vblpUcmVlTW91c2Vkb3duOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAibW91c2V1cCI6CiAgICAgICAgdHJlZUV2ZW50Q2FsbGJhY2sgPSBoYW5kbGVyLm9uWlRyZWVNb3VzZXVwOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiZGJsY2xpY2siOgogICAgICAgIHRyZWVFdmVudENhbGxiYWNrID0gaGFuZGxlci5vblpUcmVlRGJsY2xpY2s7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJjb250ZXh0bWVudSI6CiAgICAgICAgdHJlZUV2ZW50Q2FsbGJhY2sgPSBoYW5kbGVyLm9uWlRyZWVDb250ZXh0bWVudTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICB2YXIgcHJveHlSZXN1bHQgPSB7CiAgICAgIHN0b3A6IGZhbHNlLAogICAgICBub2RlOiBub2RlLAogICAgICBub2RlRXZlbnRUeXBlOiBub2RlRXZlbnRUeXBlLAogICAgICBub2RlRXZlbnRDYWxsYmFjazogbm9kZUV2ZW50Q2FsbGJhY2ssCiAgICAgIHRyZWVFdmVudFR5cGU6IHRyZWVFdmVudFR5cGUsCiAgICAgIHRyZWVFdmVudENhbGxiYWNrOiB0cmVlRXZlbnRDYWxsYmFjawogICAgfTsKICAgIHJldHVybiBwcm94eVJlc3VsdDsKICB9LAogICAgICAvL2RlZmF1bHQgaW5pdCBub2RlIG9mIGNvcmUKICBfaW5pdE5vZGUgPSBmdW5jdGlvbiBfaW5pdE5vZGUoc2V0dGluZywgbGV2ZWwsIG4sIHBhcmVudE5vZGUsIGlzRmlyc3ROb2RlLCBpc0xhc3ROb2RlLCBvcGVuRmxhZykgewogICAgaWYgKCFuKSByZXR1cm47CiAgICB2YXIgciA9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKSwKICAgICAgICBjaGlsZHJlbiA9IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIG4pOwogICAgbi5sZXZlbCA9IGxldmVsOwogICAgbi50SWQgPSBzZXR0aW5nLnRyZWVJZCArICJfIiArICsrci56SWQ7CiAgICBuLnBhcmVudFRJZCA9IHBhcmVudE5vZGUgPyBwYXJlbnROb2RlLnRJZCA6IG51bGw7CiAgICBuLm9wZW4gPSB0eXBlb2Ygbi5vcGVuID09ICJzdHJpbmciID8gdG9vbHMuZXFzKG4ub3BlbiwgInRydWUiKSA6ICEhbi5vcGVuOwogICAgdmFyIGlzUGFyZW50ID0gZGF0YS5ub2RlSXNQYXJlbnQoc2V0dGluZywgbik7CgogICAgaWYgKHRvb2xzLmlzQXJyYXkoY2hpbGRyZW4pKSB7CiAgICAgIGRhdGEubm9kZUlzUGFyZW50KHNldHRpbmcsIG4sIHRydWUpOwogICAgICBuLnpBc3luYyA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICBpc1BhcmVudCA9IGRhdGEubm9kZUlzUGFyZW50KHNldHRpbmcsIG4sIGlzUGFyZW50KTsKICAgICAgbi5vcGVuID0gaXNQYXJlbnQgJiYgIXNldHRpbmcuYXN5bmMuZW5hYmxlID8gbi5vcGVuIDogZmFsc2U7CiAgICAgIG4uekFzeW5jID0gIWlzUGFyZW50OwogICAgfQoKICAgIG4uaXNGaXJzdE5vZGUgPSBpc0ZpcnN0Tm9kZTsKICAgIG4uaXNMYXN0Tm9kZSA9IGlzTGFzdE5vZGU7CgogICAgbi5nZXRQYXJlbnROb2RlID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gZGF0YS5nZXROb2RlQ2FjaGUoc2V0dGluZywgbi5wYXJlbnRUSWQpOwogICAgfTsKCiAgICBuLmdldFByZU5vZGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBkYXRhLmdldFByZU5vZGUoc2V0dGluZywgbik7CiAgICB9OwoKICAgIG4uZ2V0TmV4dE5vZGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBkYXRhLmdldE5leHROb2RlKHNldHRpbmcsIG4pOwogICAgfTsKCiAgICBuLmdldEluZGV4ID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gZGF0YS5nZXROb2RlSW5kZXgoc2V0dGluZywgbik7CiAgICB9OwoKICAgIG4uZ2V0UGF0aCA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGRhdGEuZ2V0Tm9kZVBhdGgoc2V0dGluZywgbik7CiAgICB9OwoKICAgIG4uaXNBamF4aW5nID0gZmFsc2U7CiAgICBkYXRhLmZpeFBJZEtleVZhbHVlKHNldHRpbmcsIG4pOwogIH0sCiAgICAgIF9pbml0ID0gewogICAgYmluZDogW19iaW5kRXZlbnRdLAogICAgdW5iaW5kOiBbX3VuYmluZEV2ZW50XSwKICAgIGNhY2hlczogW19pbml0Q2FjaGVdLAogICAgbm9kZXM6IFtfaW5pdE5vZGVdLAogICAgcHJveHlzOiBbX2V2ZW50UHJveHldLAogICAgcm9vdHM6IFtfaW5pdFJvb3RdLAogICAgYmVmb3JlQTogW10sCiAgICBhZnRlckE6IFtdLAogICAgaW5uZXJCZWZvcmVBOiBbXSwKICAgIGlubmVyQWZ0ZXJBOiBbXSwKICAgIHpUcmVlVG9vbHM6IFtdCiAgfSwKICAgICAgLy9tZXRob2Qgb2Ygb3BlcmF0ZSBkYXRhCiAgZGF0YSA9IHsKICAgIGFkZE5vZGVDYWNoZTogZnVuY3Rpb24gYWRkTm9kZUNhY2hlKHNldHRpbmcsIG5vZGUpIHsKICAgICAgZGF0YS5nZXRDYWNoZShzZXR0aW5nKS5ub2Rlc1tkYXRhLmdldE5vZGVDYWNoZUlkKG5vZGUudElkKV0gPSBub2RlOwogICAgfSwKICAgIGdldE5vZGVDYWNoZUlkOiBmdW5jdGlvbiBnZXROb2RlQ2FjaGVJZCh0SWQpIHsKICAgICAgcmV0dXJuIHRJZC5zdWJzdHJpbmcodElkLmxhc3RJbmRleE9mKCJfIikgKyAxKTsKICAgIH0sCiAgICBhZGRBZnRlckE6IGZ1bmN0aW9uIGFkZEFmdGVyQShhZnRlckEpIHsKICAgICAgX2luaXQuYWZ0ZXJBLnB1c2goYWZ0ZXJBKTsKICAgIH0sCiAgICBhZGRCZWZvcmVBOiBmdW5jdGlvbiBhZGRCZWZvcmVBKGJlZm9yZUEpIHsKICAgICAgX2luaXQuYmVmb3JlQS5wdXNoKGJlZm9yZUEpOwogICAgfSwKICAgIGFkZElubmVyQWZ0ZXJBOiBmdW5jdGlvbiBhZGRJbm5lckFmdGVyQShpbm5lckFmdGVyQSkgewogICAgICBfaW5pdC5pbm5lckFmdGVyQS5wdXNoKGlubmVyQWZ0ZXJBKTsKICAgIH0sCiAgICBhZGRJbm5lckJlZm9yZUE6IGZ1bmN0aW9uIGFkZElubmVyQmVmb3JlQShpbm5lckJlZm9yZUEpIHsKICAgICAgX2luaXQuaW5uZXJCZWZvcmVBLnB1c2goaW5uZXJCZWZvcmVBKTsKICAgIH0sCiAgICBhZGRJbml0QmluZDogZnVuY3Rpb24gYWRkSW5pdEJpbmQoYmluZEV2ZW50KSB7CiAgICAgIF9pbml0LmJpbmQucHVzaChiaW5kRXZlbnQpOwogICAgfSwKICAgIGFkZEluaXRVbkJpbmQ6IGZ1bmN0aW9uIGFkZEluaXRVbkJpbmQodW5iaW5kRXZlbnQpIHsKICAgICAgX2luaXQudW5iaW5kLnB1c2godW5iaW5kRXZlbnQpOwogICAgfSwKICAgIGFkZEluaXRDYWNoZTogZnVuY3Rpb24gYWRkSW5pdENhY2hlKGluaXRDYWNoZSkgewogICAgICBfaW5pdC5jYWNoZXMucHVzaChpbml0Q2FjaGUpOwogICAgfSwKICAgIGFkZEluaXROb2RlOiBmdW5jdGlvbiBhZGRJbml0Tm9kZShpbml0Tm9kZSkgewogICAgICBfaW5pdC5ub2Rlcy5wdXNoKGluaXROb2RlKTsKICAgIH0sCiAgICBhZGRJbml0UHJveHk6IGZ1bmN0aW9uIGFkZEluaXRQcm94eShpbml0UHJveHksIGlzRmlyc3QpIHsKICAgICAgaWYgKCEhaXNGaXJzdCkgewogICAgICAgIF9pbml0LnByb3h5cy5zcGxpY2UoMCwgMCwgaW5pdFByb3h5KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfaW5pdC5wcm94eXMucHVzaChpbml0UHJveHkpOwogICAgICB9CiAgICB9LAogICAgYWRkSW5pdFJvb3Q6IGZ1bmN0aW9uIGFkZEluaXRSb290KGluaXRSb290KSB7CiAgICAgIF9pbml0LnJvb3RzLnB1c2goaW5pdFJvb3QpOwogICAgfSwKICAgIGFkZE5vZGVzRGF0YTogZnVuY3Rpb24gYWRkTm9kZXNEYXRhKHNldHRpbmcsIHBhcmVudE5vZGUsIGluZGV4LCBub2RlcykgewogICAgICB2YXIgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKSwKICAgICAgICAgIHBhcmFtczsKCiAgICAgIGlmICghY2hpbGRyZW4pIHsKICAgICAgICBjaGlsZHJlbiA9IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIHBhcmVudE5vZGUsIFtdKTsKICAgICAgICBpbmRleCA9IC0xOwogICAgICB9IGVsc2UgaWYgKGluZGV4ID49IGNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgIGluZGV4ID0gLTE7CiAgICAgIH0KCiAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPiAwICYmIGluZGV4ID09PSAwKSB7CiAgICAgICAgY2hpbGRyZW5bMF0uaXNGaXJzdE5vZGUgPSBmYWxzZTsKICAgICAgICB2aWV3LnNldE5vZGVMaW5lSWNvcyhzZXR0aW5nLCBjaGlsZHJlblswXSk7CiAgICAgIH0gZWxzZSBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMCAmJiBpbmRleCA8IDApIHsKICAgICAgICBjaGlsZHJlbltjaGlsZHJlbi5sZW5ndGggLSAxXS5pc0xhc3ROb2RlID0gZmFsc2U7CiAgICAgICAgdmlldy5zZXROb2RlTGluZUljb3Moc2V0dGluZywgY2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoIC0gMV0pOwogICAgICB9CgogICAgICBkYXRhLm5vZGVJc1BhcmVudChzZXR0aW5nLCBwYXJlbnROb2RlLCB0cnVlKTsKCiAgICAgIGlmIChpbmRleCA8IDApIHsKICAgICAgICBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlLCBjaGlsZHJlbi5jb25jYXQobm9kZXMpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwYXJhbXMgPSBbaW5kZXgsIDBdLmNvbmNhdChub2Rlcyk7CiAgICAgICAgY2hpbGRyZW4uc3BsaWNlLmFwcGx5KGNoaWxkcmVuLCBwYXJhbXMpOwogICAgICB9CiAgICB9LAogICAgYWRkU2VsZWN0ZWROb2RlOiBmdW5jdGlvbiBhZGRTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgcm9vdCA9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKTsKCiAgICAgIGlmICghZGF0YS5pc1NlbGVjdGVkTm9kZShzZXR0aW5nLCBub2RlKSkgewogICAgICAgIHJvb3QuY3VyU2VsZWN0ZWRMaXN0LnB1c2gobm9kZSk7CiAgICAgIH0KICAgIH0sCiAgICBhZGRDcmVhdGVkTm9kZTogZnVuY3Rpb24gYWRkQ3JlYXRlZE5vZGUoc2V0dGluZywgbm9kZSkgewogICAgICBpZiAoISFzZXR0aW5nLmNhbGxiYWNrLm9uTm9kZUNyZWF0ZWQgfHwgISFzZXR0aW5nLnZpZXcuYWRkRGl5RG9tKSB7CiAgICAgICAgdmFyIHJvb3QgPSBkYXRhLmdldFJvb3Qoc2V0dGluZyk7CiAgICAgICAgcm9vdC5jcmVhdGVkTm9kZXMucHVzaChub2RlKTsKICAgICAgfQogICAgfSwKICAgIGFkZFpUcmVlVG9vbHM6IGZ1bmN0aW9uIGFkZFpUcmVlVG9vbHMoelRyZWVUb29scykgewogICAgICBfaW5pdC56VHJlZVRvb2xzLnB1c2goelRyZWVUb29scyk7CiAgICB9LAogICAgZXhTZXR0aW5nOiBmdW5jdGlvbiBleFNldHRpbmcocykgewogICAgICBfJC5leHRlbmQodHJ1ZSwgX3NldHRpbmcsIHMpOwogICAgfSwKICAgIGZpeFBJZEtleVZhbHVlOiBmdW5jdGlvbiBmaXhQSWRLZXlWYWx1ZShzZXR0aW5nLCBub2RlKSB7CiAgICAgIGlmIChzZXR0aW5nLmRhdGEuc2ltcGxlRGF0YS5lbmFibGUpIHsKICAgICAgICBub2RlW3NldHRpbmcuZGF0YS5zaW1wbGVEYXRhLnBJZEtleV0gPSBub2RlLnBhcmVudFRJZCA/IG5vZGUuZ2V0UGFyZW50Tm9kZSgpW3NldHRpbmcuZGF0YS5zaW1wbGVEYXRhLmlkS2V5XSA6IHNldHRpbmcuZGF0YS5zaW1wbGVEYXRhLnJvb3RQSWQ7CiAgICAgIH0KICAgIH0sCiAgICBnZXRBZnRlckE6IGZ1bmN0aW9uIGdldEFmdGVyQShzZXR0aW5nLCBub2RlLCBhcnJheSkgewogICAgICBmb3IgKHZhciBpID0gMCwgaiA9IF9pbml0LmFmdGVyQS5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICBfaW5pdC5hZnRlckFbaV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgfSwKICAgIGdldEJlZm9yZUE6IGZ1bmN0aW9uIGdldEJlZm9yZUEoc2V0dGluZywgbm9kZSwgYXJyYXkpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSBfaW5pdC5iZWZvcmVBLmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICAgIF9pbml0LmJlZm9yZUFbaV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgfSwKICAgIGdldElubmVyQWZ0ZXJBOiBmdW5jdGlvbiBnZXRJbm5lckFmdGVyQShzZXR0aW5nLCBub2RlLCBhcnJheSkgewogICAgICBmb3IgKHZhciBpID0gMCwgaiA9IF9pbml0LmlubmVyQWZ0ZXJBLmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICAgIF9pbml0LmlubmVyQWZ0ZXJBW2ldLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRJbm5lckJlZm9yZUE6IGZ1bmN0aW9uIGdldElubmVyQmVmb3JlQShzZXR0aW5nLCBub2RlLCBhcnJheSkgewogICAgICBmb3IgKHZhciBpID0gMCwgaiA9IF9pbml0LmlubmVyQmVmb3JlQS5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICBfaW5pdC5pbm5lckJlZm9yZUFbaV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgfSwKICAgIGdldENhY2hlOiBmdW5jdGlvbiBnZXRDYWNoZShzZXR0aW5nKSB7CiAgICAgIHJldHVybiBjYWNoZXNbc2V0dGluZy50cmVlSWRdOwogICAgfSwKICAgIGdldE5vZGVJbmRleDogZnVuY3Rpb24gZ2V0Tm9kZUluZGV4KHNldHRpbmcsIG5vZGUpIHsKICAgICAgaWYgKCFub2RlKSByZXR1cm4gbnVsbDsKICAgICAgdmFyIHAgPSBub2RlLnBhcmVudFRJZCA/IG5vZGUuZ2V0UGFyZW50Tm9kZSgpIDogZGF0YS5nZXRSb290KHNldHRpbmcpLAogICAgICAgICAgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwKTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSA8PSBsOyBpKyspIHsKICAgICAgICBpZiAoY2hpbGRyZW5baV0gPT09IG5vZGUpIHsKICAgICAgICAgIHJldHVybiBpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIC0xOwogICAgfSwKICAgIGdldE5leHROb2RlOiBmdW5jdGlvbiBnZXROZXh0Tm9kZShzZXR0aW5nLCBub2RlKSB7CiAgICAgIGlmICghbm9kZSkgcmV0dXJuIG51bGw7CiAgICAgIHZhciBwID0gbm9kZS5wYXJlbnRUSWQgPyBub2RlLmdldFBhcmVudE5vZGUoKSA6IGRhdGEuZ2V0Um9vdChzZXR0aW5nKSwKICAgICAgICAgIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoaWxkcmVuLmxlbmd0aCAtIDE7IGkgPD0gbDsgaSsrKSB7CiAgICAgICAgaWYgKGNoaWxkcmVuW2ldID09PSBub2RlKSB7CiAgICAgICAgICByZXR1cm4gaSA9PSBsID8gbnVsbCA6IGNoaWxkcmVuW2kgKyAxXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfSwKICAgIGdldE5vZGVCeVBhcmFtOiBmdW5jdGlvbiBnZXROb2RlQnlQYXJhbShzZXR0aW5nLCBub2Rlcywga2V5LCB2YWx1ZSkgewogICAgICBpZiAoIW5vZGVzIHx8ICFrZXkpIHJldHVybiBudWxsOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBub2Rlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICB2YXIgbm9kZSA9IG5vZGVzW2ldOwoKICAgICAgICBpZiAobm9kZVtrZXldID09IHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gbm9kZXNbaV07CiAgICAgICAgfQoKICAgICAgICB2YXIgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBub2RlKTsKICAgICAgICB2YXIgdG1wID0gZGF0YS5nZXROb2RlQnlQYXJhbShzZXR0aW5nLCBjaGlsZHJlbiwga2V5LCB2YWx1ZSk7CiAgICAgICAgaWYgKHRtcCkgcmV0dXJuIHRtcDsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAogICAgZ2V0Tm9kZUNhY2hlOiBmdW5jdGlvbiBnZXROb2RlQ2FjaGUoc2V0dGluZywgdElkKSB7CiAgICAgIGlmICghdElkKSByZXR1cm4gbnVsbDsKICAgICAgdmFyIG4gPSBjYWNoZXNbc2V0dGluZy50cmVlSWRdLm5vZGVzW2RhdGEuZ2V0Tm9kZUNhY2hlSWQodElkKV07CiAgICAgIHJldHVybiBuID8gbiA6IG51bGw7CiAgICB9LAogICAgZ2V0Tm9kZVBhdGg6IGZ1bmN0aW9uIGdldE5vZGVQYXRoKHNldHRpbmcsIG5vZGUpIHsKICAgICAgaWYgKCFub2RlKSByZXR1cm4gbnVsbDsKICAgICAgdmFyIHBhdGg7CgogICAgICBpZiAobm9kZS5wYXJlbnRUSWQpIHsKICAgICAgICBwYXRoID0gbm9kZS5nZXRQYXJlbnROb2RlKCkuZ2V0UGF0aCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHBhdGggPSBbXTsKICAgICAgfQoKICAgICAgaWYgKHBhdGgpIHsKICAgICAgICBwYXRoLnB1c2gobm9kZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwYXRoOwogICAgfSwKICAgIGdldE5vZGVzOiBmdW5jdGlvbiBnZXROb2RlcyhzZXR0aW5nKSB7CiAgICAgIHJldHVybiBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBkYXRhLmdldFJvb3Qoc2V0dGluZykpOwogICAgfSwKICAgIGdldE5vZGVzQnlQYXJhbTogZnVuY3Rpb24gZ2V0Tm9kZXNCeVBhcmFtKHNldHRpbmcsIG5vZGVzLCBrZXksIHZhbHVlKSB7CiAgICAgIGlmICghbm9kZXMgfHwgIWtleSkgcmV0dXJuIFtdOwogICAgICB2YXIgcmVzdWx0ID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG5vZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBub2RlID0gbm9kZXNbaV07CgogICAgICAgIGlmIChub2RlW2tleV0gPT0gdmFsdWUpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKG5vZGUpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgbm9kZSk7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdChkYXRhLmdldE5vZGVzQnlQYXJhbShzZXR0aW5nLCBjaGlsZHJlbiwga2V5LCB2YWx1ZSkpOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIGdldE5vZGVzQnlQYXJhbUZ1enp5OiBmdW5jdGlvbiBnZXROb2Rlc0J5UGFyYW1GdXp6eShzZXR0aW5nLCBub2Rlcywga2V5LCB2YWx1ZSkgewogICAgICBpZiAoIW5vZGVzIHx8ICFrZXkpIHJldHVybiBbXTsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICB2YWx1ZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG5vZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBub2RlID0gbm9kZXNbaV07CgogICAgICAgIGlmICh0eXBlb2Ygbm9kZVtrZXldID09ICJzdHJpbmciICYmIG5vZGVzW2ldW2tleV0udG9Mb3dlckNhc2UoKS5pbmRleE9mKHZhbHVlKSA+IC0xKSB7CiAgICAgICAgICByZXN1bHQucHVzaChub2RlKTsKICAgICAgICB9CgogICAgICAgIHZhciBjaGlsZHJlbiA9IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIG5vZGUpOwogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoZGF0YS5nZXROb2Rlc0J5UGFyYW1GdXp6eShzZXR0aW5nLCBjaGlsZHJlbiwga2V5LCB2YWx1ZSkpOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIGdldE5vZGVzQnlGaWx0ZXI6IGZ1bmN0aW9uIGdldE5vZGVzQnlGaWx0ZXIoc2V0dGluZywgbm9kZXMsIGZpbHRlciwgaXNTaW5nbGUsIGludm9rZVBhcmFtKSB7CiAgICAgIGlmICghbm9kZXMpIHJldHVybiBpc1NpbmdsZSA/IG51bGwgOiBbXTsKICAgICAgdmFyIHJlc3VsdCA9IGlzU2luZ2xlID8gbnVsbCA6IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBub2Rlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICB2YXIgbm9kZSA9IG5vZGVzW2ldOwoKICAgICAgICBpZiAodG9vbHMuYXBwbHkoZmlsdGVyLCBbbm9kZSwgaW52b2tlUGFyYW1dLCBmYWxzZSkpIHsKICAgICAgICAgIGlmIChpc1NpbmdsZSkgewogICAgICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXN1bHQucHVzaChub2RlKTsKICAgICAgICB9CgogICAgICAgIHZhciBjaGlsZHJlbiA9IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIG5vZGUpOwogICAgICAgIHZhciB0bXBSZXN1bHQgPSBkYXRhLmdldE5vZGVzQnlGaWx0ZXIoc2V0dGluZywgY2hpbGRyZW4sIGZpbHRlciwgaXNTaW5nbGUsIGludm9rZVBhcmFtKTsKCiAgICAgICAgaWYgKGlzU2luZ2xlICYmICEhdG1wUmVzdWx0KSB7CiAgICAgICAgICByZXR1cm4gdG1wUmVzdWx0OwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0ID0gaXNTaW5nbGUgPyB0bXBSZXN1bHQgOiByZXN1bHQuY29uY2F0KHRtcFJlc3VsdCk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9LAogICAgZ2V0UHJlTm9kZTogZnVuY3Rpb24gZ2V0UHJlTm9kZShzZXR0aW5nLCBub2RlKSB7CiAgICAgIGlmICghbm9kZSkgcmV0dXJuIG51bGw7CiAgICAgIHZhciBwID0gbm9kZS5wYXJlbnRUSWQgPyBub2RlLmdldFBhcmVudE5vZGUoKSA6IGRhdGEuZ2V0Um9vdChzZXR0aW5nKSwKICAgICAgICAgIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGlmIChjaGlsZHJlbltpXSA9PT0gbm9kZSkgewogICAgICAgICAgcmV0dXJuIGkgPT0gMCA/IG51bGwgOiBjaGlsZHJlbltpIC0gMV07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCiAgICBnZXRSb290OiBmdW5jdGlvbiBnZXRSb290KHNldHRpbmcpIHsKICAgICAgcmV0dXJuIHNldHRpbmcgPyByb290c1tzZXR0aW5nLnRyZWVJZF0gOiBudWxsOwogICAgfSwKICAgIGdldFJvb3RzOiBmdW5jdGlvbiBnZXRSb290cygpIHsKICAgICAgcmV0dXJuIHJvb3RzOwogICAgfSwKICAgIGdldFNldHRpbmc6IGZ1bmN0aW9uIGdldFNldHRpbmcodHJlZUlkKSB7CiAgICAgIHJldHVybiBzZXR0aW5nc1t0cmVlSWRdOwogICAgfSwKICAgIGdldFNldHRpbmdzOiBmdW5jdGlvbiBnZXRTZXR0aW5ncygpIHsKICAgICAgcmV0dXJuIHNldHRpbmdzOwogICAgfSwKICAgIGdldFpUcmVlVG9vbHM6IGZ1bmN0aW9uIGdldFpUcmVlVG9vbHModHJlZUlkKSB7CiAgICAgIHZhciByID0gdGhpcy5nZXRSb290KHRoaXMuZ2V0U2V0dGluZyh0cmVlSWQpKTsKICAgICAgcmV0dXJuIHIgPyByLnRyZWVUb29scyA6IG51bGw7CiAgICB9LAogICAgaW5pdENhY2hlOiBmdW5jdGlvbiBpbml0Q2FjaGUoc2V0dGluZykgewogICAgICBmb3IgKHZhciBpID0gMCwgaiA9IF9pbml0LmNhY2hlcy5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICBfaW5pdC5jYWNoZXNbaV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgfSwKICAgIGluaXROb2RlOiBmdW5jdGlvbiBpbml0Tm9kZShzZXR0aW5nLCBsZXZlbCwgbm9kZSwgcGFyZW50Tm9kZSwgcHJlTm9kZSwgbmV4dE5vZGUpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSBfaW5pdC5ub2Rlcy5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICBfaW5pdC5ub2Rlc1tpXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9LAogICAgaW5pdFJvb3Q6IGZ1bmN0aW9uIGluaXRSb290KHNldHRpbmcpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSBfaW5pdC5yb290cy5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICBfaW5pdC5yb290c1tpXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9LAogICAgaXNTZWxlY3RlZE5vZGU6IGZ1bmN0aW9uIGlzU2VsZWN0ZWROb2RlKHNldHRpbmcsIG5vZGUpIHsKICAgICAgdmFyIHJvb3QgPSBkYXRhLmdldFJvb3Qoc2V0dGluZyk7CgogICAgICBmb3IgKHZhciBpID0gMCwgaiA9IHJvb3QuY3VyU2VsZWN0ZWRMaXN0Lmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICAgIGlmIChub2RlID09PSByb290LmN1clNlbGVjdGVkTGlzdFtpXSkgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBub2RlQ2hpbGRyZW46IGZ1bmN0aW9uIG5vZGVDaGlsZHJlbihzZXR0aW5nLCBub2RlLCBuZXdDaGlsZHJlbikgewogICAgICBpZiAoIW5vZGUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIGtleSA9IHNldHRpbmcuZGF0YS5rZXkuY2hpbGRyZW47CgogICAgICBpZiAodHlwZW9mIG5ld0NoaWxkcmVuICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIG5vZGVba2V5XSA9IG5ld0NoaWxkcmVuOwogICAgICB9CgogICAgICByZXR1cm4gbm9kZVtrZXldOwogICAgfSwKICAgIG5vZGVJc1BhcmVudDogZnVuY3Rpb24gbm9kZUlzUGFyZW50KHNldHRpbmcsIG5vZGUsIG5ld0lzUGFyZW50KSB7CiAgICAgIGlmICghbm9kZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIGtleSA9IHNldHRpbmcuZGF0YS5rZXkuaXNQYXJlbnQ7CgogICAgICBpZiAodHlwZW9mIG5ld0lzUGFyZW50ICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIGlmICh0eXBlb2YgbmV3SXNQYXJlbnQgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICBuZXdJc1BhcmVudCA9IHRvb2xzLmVxcyhuZXdJc1BhcmVudCwgInRydWUiKTsKICAgICAgICB9CgogICAgICAgIG5ld0lzUGFyZW50ID0gISFuZXdJc1BhcmVudDsKICAgICAgICBub2RlW2tleV0gPSBuZXdJc1BhcmVudDsKICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygbm9kZVtrZXldID09ICJzdHJpbmciKSB7CiAgICAgICAgbm9kZVtrZXldID0gdG9vbHMuZXFzKG5vZGVba2V5XSwgInRydWUiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBub2RlW2tleV0gPSAhIW5vZGVba2V5XTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5vZGVba2V5XTsKICAgIH0sCiAgICBub2RlTmFtZTogZnVuY3Rpb24gbm9kZU5hbWUoc2V0dGluZywgbm9kZSwgbmV3TmFtZSkgewogICAgICB2YXIga2V5ID0gc2V0dGluZy5kYXRhLmtleS5uYW1lOwoKICAgICAgaWYgKHR5cGVvZiBuZXdOYW1lICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIG5vZGVba2V5XSA9IG5ld05hbWU7CiAgICAgIH0KCiAgICAgIHZhciByYXdOYW1lID0gIiIgKyBub2RlW2tleV07CgogICAgICBpZiAodHlwZW9mIHNldHRpbmcuZGF0YS5yZW5kZXIubmFtZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiBzZXR0aW5nLmRhdGEucmVuZGVyLm5hbWUuY2FsbCh0aGlzLCByYXdOYW1lLCBub2RlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJhd05hbWU7CiAgICB9LAogICAgbm9kZVRpdGxlOiBmdW5jdGlvbiBub2RlVGl0bGUoc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgdCA9IHNldHRpbmcuZGF0YS5rZXkudGl0bGUgPT09ICIiID8gc2V0dGluZy5kYXRhLmtleS5uYW1lIDogc2V0dGluZy5kYXRhLmtleS50aXRsZTsKICAgICAgdmFyIHJhd1RpdGxlID0gIiIgKyBub2RlW3RdOwoKICAgICAgaWYgKHR5cGVvZiBzZXR0aW5nLmRhdGEucmVuZGVyLnRpdGxlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgcmV0dXJuIHNldHRpbmcuZGF0YS5yZW5kZXIudGl0bGUuY2FsbCh0aGlzLCByYXdUaXRsZSwgbm9kZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByYXdUaXRsZTsKICAgIH0sCiAgICByZW1vdmVOb2RlQ2FjaGU6IGZ1bmN0aW9uIHJlbW92ZU5vZGVDYWNoZShzZXR0aW5nLCBub2RlKSB7CiAgICAgIHZhciBjaGlsZHJlbiA9IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIG5vZGUpOwoKICAgICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgIGRhdGEucmVtb3ZlTm9kZUNhY2hlKHNldHRpbmcsIGNoaWxkcmVuW2ldKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGRhdGEuZ2V0Q2FjaGUoc2V0dGluZykubm9kZXNbZGF0YS5nZXROb2RlQ2FjaGVJZChub2RlLnRJZCldID0gbnVsbDsKICAgIH0sCiAgICByZW1vdmVTZWxlY3RlZE5vZGU6IGZ1bmN0aW9uIHJlbW92ZVNlbGVjdGVkTm9kZShzZXR0aW5nLCBub2RlKSB7CiAgICAgIHZhciByb290ID0gZGF0YS5nZXRSb290KHNldHRpbmcpOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSByb290LmN1clNlbGVjdGVkTGlzdC5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICBpZiAobm9kZSA9PT0gcm9vdC5jdXJTZWxlY3RlZExpc3RbaV0gfHwgIWRhdGEuZ2V0Tm9kZUNhY2hlKHNldHRpbmcsIHJvb3QuY3VyU2VsZWN0ZWRMaXN0W2ldLnRJZCkpIHsKICAgICAgICAgIHJvb3QuY3VyU2VsZWN0ZWRMaXN0LnNwbGljZShpLCAxKTsKICAgICAgICAgIHNldHRpbmcudHJlZU9iai50cmlnZ2VyKGNvbnN0cy5ldmVudC5VTlNFTEVDVEVELCBbc2V0dGluZy50cmVlSWQsIG5vZGVdKTsKICAgICAgICAgIGktLTsKICAgICAgICAgIGotLTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzZXRDYWNoZTogZnVuY3Rpb24gc2V0Q2FjaGUoc2V0dGluZywgY2FjaGUpIHsKICAgICAgY2FjaGVzW3NldHRpbmcudHJlZUlkXSA9IGNhY2hlOwogICAgfSwKICAgIHNldFJvb3Q6IGZ1bmN0aW9uIHNldFJvb3Qoc2V0dGluZywgcm9vdCkgewogICAgICByb290c1tzZXR0aW5nLnRyZWVJZF0gPSByb290OwogICAgfSwKICAgIHNldFpUcmVlVG9vbHM6IGZ1bmN0aW9uIHNldFpUcmVlVG9vbHMoc2V0dGluZywgelRyZWVUb29scykgewogICAgICBmb3IgKHZhciBpID0gMCwgaiA9IF9pbml0LnpUcmVlVG9vbHMubGVuZ3RoOyBpIDwgajsgaSsrKSB7CiAgICAgICAgX2luaXQuelRyZWVUb29sc1tpXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9LAogICAgdHJhbnNmb3JtVG9BcnJheUZvcm1hdDogZnVuY3Rpb24gdHJhbnNmb3JtVG9BcnJheUZvcm1hdChzZXR0aW5nLCBub2RlcykgewogICAgICBpZiAoIW5vZGVzKSByZXR1cm4gW107CiAgICAgIHZhciByID0gW107CgogICAgICBpZiAodG9vbHMuaXNBcnJheShub2RlcykpIHsKICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG5vZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgdmFyIG5vZGUgPSBub2Rlc1tpXTsKCiAgICAgICAgICBfZG8obm9kZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIF9kbyhub2Rlcyk7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwoKICAgICAgZnVuY3Rpb24gX2RvKF9ub2RlKSB7CiAgICAgICAgci5wdXNoKF9ub2RlKTsKICAgICAgICB2YXIgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBfbm9kZSk7CgogICAgICAgIGlmIChjaGlsZHJlbikgewogICAgICAgICAgciA9IHIuY29uY2F0KGRhdGEudHJhbnNmb3JtVG9BcnJheUZvcm1hdChzZXR0aW5nLCBjaGlsZHJlbikpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRyYW5zZm9ybVRvelRyZWVGb3JtYXQ6IGZ1bmN0aW9uIHRyYW5zZm9ybVRvelRyZWVGb3JtYXQoc2V0dGluZywgc05vZGVzKSB7CiAgICAgIHZhciBpLAogICAgICAgICAgbCwKICAgICAgICAgIGtleSA9IHNldHRpbmcuZGF0YS5zaW1wbGVEYXRhLmlkS2V5LAogICAgICAgICAgcGFyZW50S2V5ID0gc2V0dGluZy5kYXRhLnNpbXBsZURhdGEucElkS2V5OwogICAgICBpZiAoIWtleSB8fCBrZXkgPT0gIiIgfHwgIXNOb2RlcykgcmV0dXJuIFtdOwoKICAgICAgaWYgKHRvb2xzLmlzQXJyYXkoc05vZGVzKSkgewogICAgICAgIHZhciByID0gW107CiAgICAgICAgdmFyIHRtcE1hcCA9IHt9OwoKICAgICAgICBmb3IgKGkgPSAwLCBsID0gc05vZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgdG1wTWFwW3NOb2Rlc1tpXVtrZXldXSA9IHNOb2Rlc1tpXTsKICAgICAgICB9CgogICAgICAgIGZvciAoaSA9IDAsIGwgPSBzTm9kZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICB2YXIgcCA9IHRtcE1hcFtzTm9kZXNbaV1bcGFyZW50S2V5XV07CgogICAgICAgICAgaWYgKHAgJiYgc05vZGVzW2ldW2tleV0gIT0gc05vZGVzW2ldW3BhcmVudEtleV0pIHsKICAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcCk7CgogICAgICAgICAgICBpZiAoIWNoaWxkcmVuKSB7CiAgICAgICAgICAgICAgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwLCBbXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goc05vZGVzW2ldKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHIucHVzaChzTm9kZXNbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFtzTm9kZXNdOwogICAgICB9CiAgICB9CiAgfSwKICAgICAgLy9tZXRob2Qgb2YgZXZlbnQgcHJveHkKICBldmVudCA9IHsKICAgIGJpbmRFdmVudDogZnVuY3Rpb24gYmluZEV2ZW50KHNldHRpbmcpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSBfaW5pdC5iaW5kLmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICAgIF9pbml0LmJpbmRbaV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgfSwKICAgIHVuYmluZEV2ZW50OiBmdW5jdGlvbiB1bmJpbmRFdmVudChzZXR0aW5nKSB7CiAgICAgIGZvciAodmFyIGkgPSAwLCBqID0gX2luaXQudW5iaW5kLmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICAgIF9pbml0LnVuYmluZFtpXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9LAogICAgYmluZFRyZWU6IGZ1bmN0aW9uIGJpbmRUcmVlKHNldHRpbmcpIHsKICAgICAgdmFyIGV2ZW50UGFyYW0gPSB7CiAgICAgICAgdHJlZUlkOiBzZXR0aW5nLnRyZWVJZAogICAgICB9LAogICAgICAgICAgbyA9IHNldHRpbmcudHJlZU9iajsKCiAgICAgIGlmICghc2V0dGluZy52aWV3LnR4dFNlbGVjdGVkRW5hYmxlKSB7CiAgICAgICAgLy8gZm9yIGNhbid0IHNlbGVjdCB0ZXh0CiAgICAgICAgby5iaW5kKCdzZWxlY3RzdGFydCcsIGhhbmRsZXIub25TZWxlY3RTdGFydCkuY3NzKHsKICAgICAgICAgICItbW96LXVzZXItc2VsZWN0IjogIi1tb3otbm9uZSIKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgby5iaW5kKCdjbGljaycsIGV2ZW50UGFyYW0sIGV2ZW50LnByb3h5KTsKICAgICAgby5iaW5kKCdkYmxjbGljaycsIGV2ZW50UGFyYW0sIGV2ZW50LnByb3h5KTsKICAgICAgby5iaW5kKCdtb3VzZW92ZXInLCBldmVudFBhcmFtLCBldmVudC5wcm94eSk7CiAgICAgIG8uYmluZCgnbW91c2VvdXQnLCBldmVudFBhcmFtLCBldmVudC5wcm94eSk7CiAgICAgIG8uYmluZCgnbW91c2Vkb3duJywgZXZlbnRQYXJhbSwgZXZlbnQucHJveHkpOwogICAgICBvLmJpbmQoJ21vdXNldXAnLCBldmVudFBhcmFtLCBldmVudC5wcm94eSk7CiAgICAgIG8uYmluZCgnY29udGV4dG1lbnUnLCBldmVudFBhcmFtLCBldmVudC5wcm94eSk7CiAgICB9LAogICAgdW5iaW5kVHJlZTogZnVuY3Rpb24gdW5iaW5kVHJlZShzZXR0aW5nKSB7CiAgICAgIHZhciBvID0gc2V0dGluZy50cmVlT2JqOwogICAgICBvLnVuYmluZCgnc2VsZWN0c3RhcnQnLCBoYW5kbGVyLm9uU2VsZWN0U3RhcnQpLnVuYmluZCgnY2xpY2snLCBldmVudC5wcm94eSkudW5iaW5kKCdkYmxjbGljaycsIGV2ZW50LnByb3h5KS51bmJpbmQoJ21vdXNlb3ZlcicsIGV2ZW50LnByb3h5KS51bmJpbmQoJ21vdXNlb3V0JywgZXZlbnQucHJveHkpLnVuYmluZCgnbW91c2Vkb3duJywgZXZlbnQucHJveHkpLnVuYmluZCgnbW91c2V1cCcsIGV2ZW50LnByb3h5KS51bmJpbmQoJ2NvbnRleHRtZW51JywgZXZlbnQucHJveHkpOwogICAgfSwKICAgIGRvUHJveHk6IGZ1bmN0aW9uIGRvUHJveHkoZSkgewogICAgICB2YXIgcmVzdWx0cyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSBfaW5pdC5wcm94eXMubGVuZ3RoOyBpIDwgajsgaSsrKSB7CiAgICAgICAgdmFyIHByb3h5UmVzdWx0ID0gX2luaXQucHJveHlzW2ldLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgogICAgICAgIHJlc3VsdHMucHVzaChwcm94eVJlc3VsdCk7CgogICAgICAgIGlmIChwcm94eVJlc3VsdC5zdG9wKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHRzOwogICAgfSwKICAgIHByb3h5OiBmdW5jdGlvbiBwcm94eShlKSB7CiAgICAgIHZhciBzZXR0aW5nID0gZGF0YS5nZXRTZXR0aW5nKGUuZGF0YS50cmVlSWQpOwogICAgICBpZiAoIXRvb2xzLnVDYW5EbyhzZXR0aW5nLCBlKSkgcmV0dXJuIHRydWU7CiAgICAgIHZhciByZXN1bHRzID0gZXZlbnQuZG9Qcm94eShlKSwKICAgICAgICAgIHIgPSB0cnVlLAogICAgICAgICAgeCA9IGZhbHNlOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSByZXN1bHRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBwcm94eVJlc3VsdCA9IHJlc3VsdHNbaV07CgogICAgICAgIGlmIChwcm94eVJlc3VsdC5ub2RlRXZlbnRDYWxsYmFjaykgewogICAgICAgICAgeCA9IHRydWU7CiAgICAgICAgICByID0gcHJveHlSZXN1bHQubm9kZUV2ZW50Q2FsbGJhY2suYXBwbHkocHJveHlSZXN1bHQsIFtlLCBwcm94eVJlc3VsdC5ub2RlXSkgJiYgcjsKICAgICAgICB9CgogICAgICAgIGlmIChwcm94eVJlc3VsdC50cmVlRXZlbnRDYWxsYmFjaykgewogICAgICAgICAgeCA9IHRydWU7CiAgICAgICAgICByID0gcHJveHlSZXN1bHQudHJlZUV2ZW50Q2FsbGJhY2suYXBwbHkocHJveHlSZXN1bHQsIFtlLCBwcm94eVJlc3VsdC5ub2RlXSkgJiYgcjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogIH0sCiAgICAgIC8vbWV0aG9kIG9mIGV2ZW50IGhhbmRsZXIKICBoYW5kbGVyID0gewogICAgb25Td2l0Y2hOb2RlOiBmdW5jdGlvbiBvblN3aXRjaE5vZGUoZXZlbnQsIG5vZGUpIHsKICAgICAgdmFyIHNldHRpbmcgPSBkYXRhLmdldFNldHRpbmcoZXZlbnQuZGF0YS50cmVlSWQpOwoKICAgICAgaWYgKG5vZGUub3BlbikgewogICAgICAgIGlmICh0b29scy5hcHBseShzZXR0aW5nLmNhbGxiYWNrLmJlZm9yZUNvbGxhcHNlLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdLCB0cnVlKSA9PSBmYWxzZSkgcmV0dXJuIHRydWU7CiAgICAgICAgZGF0YS5nZXRSb290KHNldHRpbmcpLmV4cGFuZFRyaWdnZXJGbGFnID0gdHJ1ZTsKICAgICAgICB2aWV3LnN3aXRjaE5vZGUoc2V0dGluZywgbm9kZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2suYmVmb3JlRXhwYW5kLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdLCB0cnVlKSA9PSBmYWxzZSkgcmV0dXJuIHRydWU7CiAgICAgICAgZGF0YS5nZXRSb290KHNldHRpbmcpLmV4cGFuZFRyaWdnZXJGbGFnID0gdHJ1ZTsKICAgICAgICB2aWV3LnN3aXRjaE5vZGUoc2V0dGluZywgbm9kZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgIG9uQ2xpY2tOb2RlOiBmdW5jdGlvbiBvbkNsaWNrTm9kZShldmVudCwgbm9kZSkgewogICAgICB2YXIgc2V0dGluZyA9IGRhdGEuZ2V0U2V0dGluZyhldmVudC5kYXRhLnRyZWVJZCksCiAgICAgICAgICBjbGlja0ZsYWcgPSBzZXR0aW5nLnZpZXcuYXV0b0NhbmNlbFNlbGVjdGVkICYmIChldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkpICYmIGRhdGEuaXNTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSkgPyAwIDogc2V0dGluZy52aWV3LmF1dG9DYW5jZWxTZWxlY3RlZCAmJiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5KSAmJiBzZXR0aW5nLnZpZXcuc2VsZWN0ZWRNdWx0aSA/IDIgOiAxOwogICAgICBpZiAodG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5iZWZvcmVDbGljaywgW3NldHRpbmcudHJlZUlkLCBub2RlLCBjbGlja0ZsYWddLCB0cnVlKSA9PSBmYWxzZSkgcmV0dXJuIHRydWU7CgogICAgICBpZiAoY2xpY2tGbGFnID09PSAwKSB7CiAgICAgICAgdmlldy5jYW5jZWxQcmVTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmlldy5zZWxlY3ROb2RlKHNldHRpbmcsIG5vZGUsIGNsaWNrRmxhZyA9PT0gMik7CiAgICAgIH0KCiAgICAgIHNldHRpbmcudHJlZU9iai50cmlnZ2VyKGNvbnN0cy5ldmVudC5DTElDSywgW2V2ZW50LCBzZXR0aW5nLnRyZWVJZCwgbm9kZSwgY2xpY2tGbGFnXSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgIG9uWlRyZWVNb3VzZWRvd246IGZ1bmN0aW9uIG9uWlRyZWVNb3VzZWRvd24oZXZlbnQsIG5vZGUpIHsKICAgICAgdmFyIHNldHRpbmcgPSBkYXRhLmdldFNldHRpbmcoZXZlbnQuZGF0YS50cmVlSWQpOwoKICAgICAgaWYgKHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2suYmVmb3JlTW91c2VEb3duLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdLCB0cnVlKSkgewogICAgICAgIHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2sub25Nb3VzZURvd24sIFtldmVudCwgc2V0dGluZy50cmVlSWQsIG5vZGVdKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgb25aVHJlZU1vdXNldXA6IGZ1bmN0aW9uIG9uWlRyZWVNb3VzZXVwKGV2ZW50LCBub2RlKSB7CiAgICAgIHZhciBzZXR0aW5nID0gZGF0YS5nZXRTZXR0aW5nKGV2ZW50LmRhdGEudHJlZUlkKTsKCiAgICAgIGlmICh0b29scy5hcHBseShzZXR0aW5nLmNhbGxiYWNrLmJlZm9yZU1vdXNlVXAsIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0sIHRydWUpKSB7CiAgICAgICAgdG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5vbk1vdXNlVXAsIFtldmVudCwgc2V0dGluZy50cmVlSWQsIG5vZGVdKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgb25aVHJlZURibGNsaWNrOiBmdW5jdGlvbiBvblpUcmVlRGJsY2xpY2soZXZlbnQsIG5vZGUpIHsKICAgICAgdmFyIHNldHRpbmcgPSBkYXRhLmdldFNldHRpbmcoZXZlbnQuZGF0YS50cmVlSWQpOwoKICAgICAgaWYgKHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2suYmVmb3JlRGJsQ2xpY2ssIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0sIHRydWUpKSB7CiAgICAgICAgdG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5vbkRibENsaWNrLCBbZXZlbnQsIHNldHRpbmcudHJlZUlkLCBub2RlXSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgIG9uWlRyZWVDb250ZXh0bWVudTogZnVuY3Rpb24gb25aVHJlZUNvbnRleHRtZW51KGV2ZW50LCBub2RlKSB7CiAgICAgIHZhciBzZXR0aW5nID0gZGF0YS5nZXRTZXR0aW5nKGV2ZW50LmRhdGEudHJlZUlkKTsKCiAgICAgIGlmICh0b29scy5hcHBseShzZXR0aW5nLmNhbGxiYWNrLmJlZm9yZVJpZ2h0Q2xpY2ssIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0sIHRydWUpKSB7CiAgICAgICAgdG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5vblJpZ2h0Q2xpY2ssIFtldmVudCwgc2V0dGluZy50cmVlSWQsIG5vZGVdKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHR5cGVvZiBzZXR0aW5nLmNhbGxiYWNrLm9uUmlnaHRDbGljayAhPSAiZnVuY3Rpb24iOwogICAgfSwKICAgIG9uU2VsZWN0U3RhcnQ6IGZ1bmN0aW9uIG9uU2VsZWN0U3RhcnQoZSkgewogICAgICB2YXIgbiA9IGUub3JpZ2luYWxFdmVudC5zcmNFbGVtZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgIHJldHVybiBuID09PSAiaW5wdXQiIHx8IG4gPT09ICJ0ZXh0YXJlYSI7CiAgICB9CiAgfSwKICAgICAgLy9tZXRob2Qgb2YgdG9vbHMgZm9yIHpUcmVlCiAgdG9vbHMgPSB7CiAgICBhcHBseTogZnVuY3Rpb24gYXBwbHkoZnVuLCBwYXJhbSwgZGVmYXVsdFZhbHVlKSB7CiAgICAgIGlmICh0eXBlb2YgZnVuID09ICJmdW5jdGlvbiIpIHsKICAgICAgICByZXR1cm4gZnVuLmFwcGx5KHp0LCBwYXJhbSA/IHBhcmFtIDogW10pOwogICAgICB9CgogICAgICByZXR1cm4gZGVmYXVsdFZhbHVlOwogICAgfSwKICAgIGNhbkFzeW5jOiBmdW5jdGlvbiBjYW5Bc3luYyhzZXR0aW5nLCBub2RlKSB7CiAgICAgIHZhciBjaGlsZHJlbiA9IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIG5vZGUpOwogICAgICB2YXIgaXNQYXJlbnQgPSBkYXRhLm5vZGVJc1BhcmVudChzZXR0aW5nLCBub2RlKTsKICAgICAgcmV0dXJuIHNldHRpbmcuYXN5bmMuZW5hYmxlICYmIG5vZGUgJiYgaXNQYXJlbnQgJiYgIShub2RlLnpBc3luYyB8fCBjaGlsZHJlbiAmJiBjaGlsZHJlbi5sZW5ndGggPiAwKTsKICAgIH0sCiAgICBjbG9uZTogZnVuY3Rpb24gY2xvbmUob2JqKSB7CiAgICAgIGlmIChvYmogPT09IG51bGwpIHJldHVybiBudWxsOwogICAgICB2YXIgbyA9IHRvb2xzLmlzQXJyYXkob2JqKSA/IFtdIDoge307CgogICAgICBmb3IgKHZhciBpIGluIG9iaikgewogICAgICAgIG9baV0gPSBvYmpbaV0gaW5zdGFuY2VvZiBEYXRlID8gbmV3IERhdGUob2JqW2ldLmdldFRpbWUoKSkgOiBfdHlwZW9mKG9ialtpXSkgPT09ICJvYmplY3QiID8gdG9vbHMuY2xvbmUob2JqW2ldKSA6IG9ialtpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIG87CiAgICB9LAogICAgZXFzOiBmdW5jdGlvbiBlcXMoc3RyMSwgc3RyMikgewogICAgICByZXR1cm4gc3RyMS50b0xvd2VyQ2FzZSgpID09PSBzdHIyLnRvTG93ZXJDYXNlKCk7CiAgICB9LAogICAgaXNBcnJheTogZnVuY3Rpb24gaXNBcnJheShhcnIpIHsKICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuYXBwbHkoYXJyKSA9PT0gIltvYmplY3QgQXJyYXldIjsKICAgIH0sCiAgICBpc0VsZW1lbnQ6IGZ1bmN0aW9uIGlzRWxlbWVudChvKSB7CiAgICAgIHJldHVybiAodHlwZW9mIEhUTUxFbGVtZW50ID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihIVE1MRWxlbWVudCkpID09PSAib2JqZWN0IiA/IG8gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCA6IC8vRE9NMgogICAgICBvICYmIF90eXBlb2YobykgPT09ICJvYmplY3QiICYmIG8gIT09IG51bGwgJiYgby5ub2RlVHlwZSA9PT0gMSAmJiB0eXBlb2Ygby5ub2RlTmFtZSA9PT0gInN0cmluZyI7CiAgICB9LAogICAgJDogZnVuY3Rpb24gJChub2RlLCBleHAsIHNldHRpbmcpIHsKICAgICAgaWYgKCEhZXhwICYmIHR5cGVvZiBleHAgIT0gInN0cmluZyIpIHsKICAgICAgICBzZXR0aW5nID0gZXhwOwogICAgICAgIGV4cCA9ICIiOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIG5vZGUgPT0gInN0cmluZyIpIHsKICAgICAgICByZXR1cm4gXyQobm9kZSwgc2V0dGluZyA/IHNldHRpbmcudHJlZU9iai5nZXQoMCkub3duZXJEb2N1bWVudCA6IG51bGwpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBfJCgiIyIgKyBub2RlLnRJZCArIGV4cCwgc2V0dGluZyA/IHNldHRpbmcudHJlZU9iaiA6IG51bGwpOwogICAgICB9CiAgICB9LAogICAgZ2V0TURvbTogZnVuY3Rpb24gZ2V0TURvbShzZXR0aW5nLCBjdXJEb20sIHRhcmdldEV4cHIpIHsKICAgICAgaWYgKCFjdXJEb20pIHJldHVybiBudWxsOwoKICAgICAgd2hpbGUgKGN1ckRvbSAmJiBjdXJEb20uaWQgIT09IHNldHRpbmcudHJlZUlkKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0YXJnZXRFeHByLmxlbmd0aDsgY3VyRG9tLnRhZ05hbWUgJiYgaSA8IGw7IGkrKykgewogICAgICAgICAgaWYgKHRvb2xzLmVxcyhjdXJEb20udGFnTmFtZSwgdGFyZ2V0RXhwcltpXS50YWdOYW1lKSAmJiBjdXJEb20uZ2V0QXR0cmlidXRlKHRhcmdldEV4cHJbaV0uYXR0ck5hbWUpICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBjdXJEb207CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjdXJEb20gPSBjdXJEb20ucGFyZW50Tm9kZTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAogICAgZ2V0Tm9kZU1haW5Eb206IGZ1bmN0aW9uIGdldE5vZGVNYWluRG9tKHRhcmdldCkgewogICAgICByZXR1cm4gXyQodGFyZ2V0KS5wYXJlbnQoImxpIikuZ2V0KDApIHx8IF8kKHRhcmdldCkucGFyZW50c1VudGlsKCJsaSIpLnBhcmVudCgpLmdldCgwKTsKICAgIH0sCiAgICBpc0NoaWxkT3JTZWxmOiBmdW5jdGlvbiBpc0NoaWxkT3JTZWxmKGRvbSwgcGFyZW50SWQpIHsKICAgICAgcmV0dXJuIF8kKGRvbSkuY2xvc2VzdCgiIyIgKyBwYXJlbnRJZCkubGVuZ3RoID4gMDsKICAgIH0sCiAgICB1Q2FuRG86IGZ1bmN0aW9uIHVDYW5EbyhzZXR0aW5nLCBlKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sCiAgICAgIC8vbWV0aG9kIG9mIG9wZXJhdGUgenRyZWUgZG9tCiAgdmlldyA9IHsKICAgIGFkZE5vZGVzOiBmdW5jdGlvbiBhZGROb2RlcyhzZXR0aW5nLCBwYXJlbnROb2RlLCBpbmRleCwgbmV3Tm9kZXMsIGlzU2lsZW50KSB7CiAgICAgIHZhciBpc1BhcmVudCA9IGRhdGEubm9kZUlzUGFyZW50KHNldHRpbmcsIHBhcmVudE5vZGUpOwoKICAgICAgaWYgKHNldHRpbmcuZGF0YS5rZWVwLmxlYWYgJiYgcGFyZW50Tm9kZSAmJiAhaXNQYXJlbnQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdG9vbHMuaXNBcnJheShuZXdOb2RlcykpIHsKICAgICAgICBuZXdOb2RlcyA9IFtuZXdOb2Rlc107CiAgICAgIH0KCiAgICAgIGlmIChzZXR0aW5nLmRhdGEuc2ltcGxlRGF0YS5lbmFibGUpIHsKICAgICAgICBuZXdOb2RlcyA9IGRhdGEudHJhbnNmb3JtVG96VHJlZUZvcm1hdChzZXR0aW5nLCBuZXdOb2Rlcyk7CiAgICAgIH0KCiAgICAgIGlmIChwYXJlbnROb2RlKSB7CiAgICAgICAgdmFyIHRhcmdldF9zd2l0Y2hPYmogPSAkJChwYXJlbnROb2RlLCBjb25zdHMuaWQuU1dJVENILCBzZXR0aW5nKSwKICAgICAgICAgICAgdGFyZ2V0X2ljb09iaiA9ICQkKHBhcmVudE5vZGUsIGNvbnN0cy5pZC5JQ09OLCBzZXR0aW5nKSwKICAgICAgICAgICAgdGFyZ2V0X3VsT2JqID0gJCQocGFyZW50Tm9kZSwgY29uc3RzLmlkLlVMLCBzZXR0aW5nKTsKCiAgICAgICAgaWYgKCFwYXJlbnROb2RlLm9wZW4pIHsKICAgICAgICAgIHZpZXcucmVwbGFjZVN3aXRjaENsYXNzKHBhcmVudE5vZGUsIHRhcmdldF9zd2l0Y2hPYmosIGNvbnN0cy5mb2xkZXIuQ0xPU0UpOwogICAgICAgICAgdmlldy5yZXBsYWNlSWNvQ2xhc3MocGFyZW50Tm9kZSwgdGFyZ2V0X2ljb09iaiwgY29uc3RzLmZvbGRlci5DTE9TRSk7CiAgICAgICAgICBwYXJlbnROb2RlLm9wZW4gPSBmYWxzZTsKICAgICAgICAgIHRhcmdldF91bE9iai5jc3MoewogICAgICAgICAgICAiZGlzcGxheSI6ICJub25lIgogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBkYXRhLmFkZE5vZGVzRGF0YShzZXR0aW5nLCBwYXJlbnROb2RlLCBpbmRleCwgbmV3Tm9kZXMpOwogICAgICAgIHZpZXcuY3JlYXRlTm9kZXMoc2V0dGluZywgcGFyZW50Tm9kZS5sZXZlbCArIDEsIG5ld05vZGVzLCBwYXJlbnROb2RlLCBpbmRleCk7CgogICAgICAgIGlmICghaXNTaWxlbnQpIHsKICAgICAgICAgIHZpZXcuZXhwYW5kQ29sbGFwc2VQYXJlbnROb2RlKHNldHRpbmcsIHBhcmVudE5vZGUsIHRydWUpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBkYXRhLmFkZE5vZGVzRGF0YShzZXR0aW5nLCBkYXRhLmdldFJvb3Qoc2V0dGluZyksIGluZGV4LCBuZXdOb2Rlcyk7CiAgICAgICAgdmlldy5jcmVhdGVOb2RlcyhzZXR0aW5nLCAwLCBuZXdOb2RlcywgbnVsbCwgaW5kZXgpOwogICAgICB9CiAgICB9LAogICAgYXBwZW5kTm9kZXM6IGZ1bmN0aW9uIGFwcGVuZE5vZGVzKHNldHRpbmcsIGxldmVsLCBub2RlcywgcGFyZW50Tm9kZSwgaW5kZXgsIGluaXRGbGFnLCBvcGVuRmxhZykgewogICAgICBpZiAoIW5vZGVzKSByZXR1cm4gW107CiAgICAgIHZhciBodG1sID0gW107CiAgICAgIHZhciB0bXBQTm9kZSA9IHBhcmVudE5vZGUgPyBwYXJlbnROb2RlIDogZGF0YS5nZXRSb290KHNldHRpbmcpLAogICAgICAgICAgdG1wUENoaWxkID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgdG1wUE5vZGUpLAogICAgICAgICAgaXNGaXJzdE5vZGUsCiAgICAgICAgICBpc0xhc3ROb2RlOwoKICAgICAgaWYgKCF0bXBQQ2hpbGQgfHwgaW5kZXggPj0gdG1wUENoaWxkLmxlbmd0aCAtIG5vZGVzLmxlbmd0aCkgewogICAgICAgIGluZGV4ID0gLTE7CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gbm9kZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgdmFyIG5vZGUgPSBub2Rlc1tpXTsKCiAgICAgICAgaWYgKGluaXRGbGFnKSB7CiAgICAgICAgICBpc0ZpcnN0Tm9kZSA9IChpbmRleCA9PT0gMCB8fCB0bXBQQ2hpbGQubGVuZ3RoID09IG5vZGVzLmxlbmd0aCkgJiYgaSA9PSAwOwogICAgICAgICAgaXNMYXN0Tm9kZSA9IGluZGV4IDwgMCAmJiBpID09IG5vZGVzLmxlbmd0aCAtIDE7CiAgICAgICAgICBkYXRhLmluaXROb2RlKHNldHRpbmcsIGxldmVsLCBub2RlLCBwYXJlbnROb2RlLCBpc0ZpcnN0Tm9kZSwgaXNMYXN0Tm9kZSwgb3BlbkZsYWcpOwogICAgICAgICAgZGF0YS5hZGROb2RlQ2FjaGUoc2V0dGluZywgbm9kZSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgaXNQYXJlbnQgPSBkYXRhLm5vZGVJc1BhcmVudChzZXR0aW5nLCBub2RlKTsKICAgICAgICB2YXIgY2hpbGRIdG1sID0gW107CiAgICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgbm9kZSk7CgogICAgICAgIGlmIChjaGlsZHJlbiAmJiBjaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAvL21ha2UgY2hpbGQgaHRtbCBmaXJzdCwgYmVjYXVzZSBjaGVja1R5cGUKICAgICAgICAgIGNoaWxkSHRtbCA9IHZpZXcuYXBwZW5kTm9kZXMoc2V0dGluZywgbGV2ZWwgKyAxLCBjaGlsZHJlbiwgbm9kZSwgLTEsIGluaXRGbGFnLCBvcGVuRmxhZyAmJiBub2RlLm9wZW4pOwogICAgICAgIH0KCiAgICAgICAgaWYgKG9wZW5GbGFnKSB7CiAgICAgICAgICB2aWV3Lm1ha2VET01Ob2RlTWFpbkJlZm9yZShodG1sLCBzZXR0aW5nLCBub2RlKTsKICAgICAgICAgIHZpZXcubWFrZURPTU5vZGVMaW5lKGh0bWwsIHNldHRpbmcsIG5vZGUpOwogICAgICAgICAgZGF0YS5nZXRCZWZvcmVBKHNldHRpbmcsIG5vZGUsIGh0bWwpOwogICAgICAgICAgdmlldy5tYWtlRE9NTm9kZU5hbWVCZWZvcmUoaHRtbCwgc2V0dGluZywgbm9kZSk7CiAgICAgICAgICBkYXRhLmdldElubmVyQmVmb3JlQShzZXR0aW5nLCBub2RlLCBodG1sKTsKICAgICAgICAgIHZpZXcubWFrZURPTU5vZGVJY29uKGh0bWwsIHNldHRpbmcsIG5vZGUpOwogICAgICAgICAgZGF0YS5nZXRJbm5lckFmdGVyQShzZXR0aW5nLCBub2RlLCBodG1sKTsKICAgICAgICAgIHZpZXcubWFrZURPTU5vZGVOYW1lQWZ0ZXIoaHRtbCwgc2V0dGluZywgbm9kZSk7CiAgICAgICAgICBkYXRhLmdldEFmdGVyQShzZXR0aW5nLCBub2RlLCBodG1sKTsKCiAgICAgICAgICBpZiAoaXNQYXJlbnQgJiYgbm9kZS5vcGVuKSB7CiAgICAgICAgICAgIHZpZXcubWFrZVVsSHRtbChzZXR0aW5nLCBub2RlLCBodG1sLCBjaGlsZEh0bWwuam9pbignJykpOwogICAgICAgICAgfQoKICAgICAgICAgIHZpZXcubWFrZURPTU5vZGVNYWluQWZ0ZXIoaHRtbCwgc2V0dGluZywgbm9kZSk7CiAgICAgICAgICBkYXRhLmFkZENyZWF0ZWROb2RlKHNldHRpbmcsIG5vZGUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGh0bWw7CiAgICB9LAogICAgYXBwZW5kUGFyZW50VUxEb206IGZ1bmN0aW9uIGFwcGVuZFBhcmVudFVMRG9tKHNldHRpbmcsIG5vZGUpIHsKICAgICAgdmFyIGh0bWwgPSBbXSwKICAgICAgICAgIG5PYmogPSAkJChub2RlLCBzZXR0aW5nKTsKCiAgICAgIGlmICghbk9iai5nZXQoMCkgJiYgISFub2RlLnBhcmVudFRJZCkgewogICAgICAgIHZpZXcuYXBwZW5kUGFyZW50VUxEb20oc2V0dGluZywgbm9kZS5nZXRQYXJlbnROb2RlKCkpOwogICAgICAgIG5PYmogPSAkJChub2RlLCBzZXR0aW5nKTsKICAgICAgfQoKICAgICAgdmFyIHVsT2JqID0gJCQobm9kZSwgY29uc3RzLmlkLlVMLCBzZXR0aW5nKTsKCiAgICAgIGlmICh1bE9iai5nZXQoMCkpIHsKICAgICAgICB1bE9iai5yZW1vdmUoKTsKICAgICAgfQoKICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgbm9kZSksCiAgICAgICAgICBjaGlsZEh0bWwgPSB2aWV3LmFwcGVuZE5vZGVzKHNldHRpbmcsIG5vZGUubGV2ZWwgKyAxLCBjaGlsZHJlbiwgbm9kZSwgLTEsIGZhbHNlLCB0cnVlKTsKICAgICAgdmlldy5tYWtlVWxIdG1sKHNldHRpbmcsIG5vZGUsIGh0bWwsIGNoaWxkSHRtbC5qb2luKCcnKSk7CiAgICAgIG5PYmouYXBwZW5kKGh0bWwuam9pbignJykpOwogICAgfSwKICAgIGFzeW5jTm9kZTogZnVuY3Rpb24gYXN5bmNOb2RlKHNldHRpbmcsIG5vZGUsIGlzU2lsZW50LCBjYWxsYmFjaykgewogICAgICB2YXIgaSwgbDsKICAgICAgdmFyIGlzUGFyZW50ID0gZGF0YS5ub2RlSXNQYXJlbnQoc2V0dGluZywgbm9kZSk7CgogICAgICBpZiAobm9kZSAmJiAhaXNQYXJlbnQpIHsKICAgICAgICB0b29scy5hcHBseShjYWxsYmFjayk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IGVsc2UgaWYgKG5vZGUgJiYgbm9kZS5pc0FqYXhpbmcpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAodG9vbHMuYXBwbHkoc2V0dGluZy5jYWxsYmFjay5iZWZvcmVBc3luYywgW3NldHRpbmcudHJlZUlkLCBub2RlXSwgdHJ1ZSkgPT0gZmFsc2UpIHsKICAgICAgICB0b29scy5hcHBseShjYWxsYmFjayk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAobm9kZSkgewogICAgICAgIG5vZGUuaXNBamF4aW5nID0gdHJ1ZTsKICAgICAgICB2YXIgaWNvT2JqID0gJCQobm9kZSwgY29uc3RzLmlkLklDT04sIHNldHRpbmcpOwogICAgICAgIGljb09iai5hdHRyKHsKICAgICAgICAgICJzdHlsZSI6ICIiLAogICAgICAgICAgImNsYXNzIjogY29uc3RzLmNsYXNzTmFtZS5CVVRUT04gKyAiICIgKyBjb25zdHMuY2xhc3NOYW1lLklDT19MT0FESU5HCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHZhciB0bXBQYXJhbSA9IHt9OwogICAgICB2YXIgYXV0b1BhcmFtID0gdG9vbHMuYXBwbHkoc2V0dGluZy5hc3luYy5hdXRvUGFyYW0sIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0sIHNldHRpbmcuYXN5bmMuYXV0b1BhcmFtKTsKCiAgICAgIGZvciAoaSA9IDAsIGwgPSBhdXRvUGFyYW0ubGVuZ3RoOyBub2RlICYmIGkgPCBsOyBpKyspIHsKICAgICAgICB2YXIgcEtleSA9IGF1dG9QYXJhbVtpXS5zcGxpdCgiPSIpLAogICAgICAgICAgICBzcEtleSA9IHBLZXk7CgogICAgICAgIGlmIChwS2V5Lmxlbmd0aCA+IDEpIHsKICAgICAgICAgIHNwS2V5ID0gcEtleVsxXTsKICAgICAgICAgIHBLZXkgPSBwS2V5WzBdOwogICAgICAgIH0KCiAgICAgICAgdG1wUGFyYW1bc3BLZXldID0gbm9kZVtwS2V5XTsKICAgICAgfQoKICAgICAgdmFyIG90aGVyUGFyYW0gPSB0b29scy5hcHBseShzZXR0aW5nLmFzeW5jLm90aGVyUGFyYW0sIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0sIHNldHRpbmcuYXN5bmMub3RoZXJQYXJhbSk7CgogICAgICBpZiAodG9vbHMuaXNBcnJheShvdGhlclBhcmFtKSkgewogICAgICAgIGZvciAoaSA9IDAsIGwgPSBvdGhlclBhcmFtLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgdG1wUGFyYW1bb3RoZXJQYXJhbVtpXV0gPSBvdGhlclBhcmFtW2kgKyAxXTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yICh2YXIgcCBpbiBvdGhlclBhcmFtKSB7CiAgICAgICAgICB0bXBQYXJhbVtwXSA9IG90aGVyUGFyYW1bcF07CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgX3RtcFYgPSBkYXRhLmdldFJvb3Qoc2V0dGluZykuX3ZlcjsKCiAgICAgIF8kLmFqYXgoewogICAgICAgIGNvbnRlbnRUeXBlOiBzZXR0aW5nLmFzeW5jLmNvbnRlbnRUeXBlLAogICAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgICB0eXBlOiBzZXR0aW5nLmFzeW5jLnR5cGUsCiAgICAgICAgdXJsOiB0b29scy5hcHBseShzZXR0aW5nLmFzeW5jLnVybCwgW3NldHRpbmcudHJlZUlkLCBub2RlXSwgc2V0dGluZy5hc3luYy51cmwpLAogICAgICAgIGRhdGE6IHNldHRpbmcuYXN5bmMuY29udGVudFR5cGUuaW5kZXhPZignYXBwbGljYXRpb24vanNvbicpID4gLTEgPyBKU09OLnN0cmluZ2lmeSh0bXBQYXJhbSkgOiB0bXBQYXJhbSwKICAgICAgICBkYXRhVHlwZTogc2V0dGluZy5hc3luYy5kYXRhVHlwZSwKICAgICAgICBoZWFkZXJzOiBzZXR0aW5nLmFzeW5jLmhlYWRlcnMsCiAgICAgICAgeGhyRmllbGRzOiBzZXR0aW5nLmFzeW5jLnhockZpZWxkcywKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKG1zZykgewogICAgICAgICAgaWYgKF90bXBWICE9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKS5fdmVyKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbmV3Tm9kZXMgPSBbXTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoIW1zZyB8fCBtc2cubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICBuZXdOb2RlcyA9IFtdOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtc2cgPT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICBuZXdOb2RlcyA9IGV2YWwoIigiICsgbXNnICsgIikiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXdOb2RlcyA9IG1zZzsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIG5ld05vZGVzID0gbXNnOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuaXNBamF4aW5nID0gbnVsbDsKICAgICAgICAgICAgbm9kZS56QXN5bmMgPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHZpZXcuc2V0Tm9kZUxpbmVJY29zKHNldHRpbmcsIG5vZGUpOwoKICAgICAgICAgIGlmIChuZXdOb2RlcyAmJiBuZXdOb2RlcyAhPT0gIiIpIHsKICAgICAgICAgICAgbmV3Tm9kZXMgPSB0b29scy5hcHBseShzZXR0aW5nLmFzeW5jLmRhdGFGaWx0ZXIsIFtzZXR0aW5nLnRyZWVJZCwgbm9kZSwgbmV3Tm9kZXNdLCBuZXdOb2Rlcyk7CiAgICAgICAgICAgIHZpZXcuYWRkTm9kZXMoc2V0dGluZywgbm9kZSwgLTEsICEhbmV3Tm9kZXMgPyB0b29scy5jbG9uZShuZXdOb2RlcykgOiBbXSwgISFpc1NpbGVudCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2aWV3LmFkZE5vZGVzKHNldHRpbmcsIG5vZGUsIC0xLCBbXSwgISFpc1NpbGVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgc2V0dGluZy50cmVlT2JqLnRyaWdnZXIoY29uc3RzLmV2ZW50LkFTWU5DX1NVQ0NFU1MsIFtzZXR0aW5nLnRyZWVJZCwgbm9kZSwgbXNnXSk7CiAgICAgICAgICB0b29scy5hcHBseShjYWxsYmFjayk7CiAgICAgICAgfSwKICAgICAgICBlcnJvcjogZnVuY3Rpb24gZXJyb3IoWE1MSHR0cFJlcXVlc3QsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CiAgICAgICAgICBpZiAoX3RtcFYgIT0gZGF0YS5nZXRSb290KHNldHRpbmcpLl92ZXIpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChub2RlKSBub2RlLmlzQWpheGluZyA9IG51bGw7CiAgICAgICAgICB2aWV3LnNldE5vZGVMaW5lSWNvcyhzZXR0aW5nLCBub2RlKTsKICAgICAgICAgIHNldHRpbmcudHJlZU9iai50cmlnZ2VyKGNvbnN0cy5ldmVudC5BU1lOQ19FUlJPUiwgW3NldHRpbmcudHJlZUlkLCBub2RlLCBYTUxIdHRwUmVxdWVzdCwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd25dKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgY2FuY2VsUHJlU2VsZWN0ZWROb2RlOiBmdW5jdGlvbiBjYW5jZWxQcmVTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSwgZXhjbHVkZU5vZGUpIHsKICAgICAgdmFyIGxpc3QgPSBkYXRhLmdldFJvb3Qoc2V0dGluZykuY3VyU2VsZWN0ZWRMaXN0LAogICAgICAgICAgaSwKICAgICAgICAgIG47CgogICAgICBmb3IgKGkgPSBsaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgbiA9IGxpc3RbaV07CgogICAgICAgIGlmIChub2RlID09PSBuIHx8ICFub2RlICYmICghZXhjbHVkZU5vZGUgfHwgZXhjbHVkZU5vZGUgIT09IG4pKSB7CiAgICAgICAgICAkJChuLCBjb25zdHMuaWQuQSwgc2V0dGluZykucmVtb3ZlQ2xhc3MoY29uc3RzLm5vZGUuQ1VSU0VMRUNURUQpOwoKICAgICAgICAgIGlmIChub2RlKSB7CiAgICAgICAgICAgIGRhdGEucmVtb3ZlU2VsZWN0ZWROb2RlKHNldHRpbmcsIG5vZGUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxpc3Quc3BsaWNlKGksIDEpOwogICAgICAgICAgICBzZXR0aW5nLnRyZWVPYmoudHJpZ2dlcihjb25zdHMuZXZlbnQuVU5TRUxFQ1RFRCwgW3NldHRpbmcudHJlZUlkLCBuXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY3JlYXRlTm9kZUNhbGxiYWNrOiBmdW5jdGlvbiBjcmVhdGVOb2RlQ2FsbGJhY2soc2V0dGluZykgewogICAgICBpZiAoISFzZXR0aW5nLmNhbGxiYWNrLm9uTm9kZUNyZWF0ZWQgfHwgISFzZXR0aW5nLnZpZXcuYWRkRGl5RG9tKSB7CiAgICAgICAgdmFyIHJvb3QgPSBkYXRhLmdldFJvb3Qoc2V0dGluZyk7CgogICAgICAgIHdoaWxlIChyb290LmNyZWF0ZWROb2Rlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICB2YXIgbm9kZSA9IHJvb3QuY3JlYXRlZE5vZGVzLnNoaWZ0KCk7CiAgICAgICAgICB0b29scy5hcHBseShzZXR0aW5nLnZpZXcuYWRkRGl5RG9tLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdKTsKCiAgICAgICAgICBpZiAoISFzZXR0aW5nLmNhbGxiYWNrLm9uTm9kZUNyZWF0ZWQpIHsKICAgICAgICAgICAgc2V0dGluZy50cmVlT2JqLnRyaWdnZXIoY29uc3RzLmV2ZW50Lk5PREVDUkVBVEVELCBbc2V0dGluZy50cmVlSWQsIG5vZGVdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVOb2RlczogZnVuY3Rpb24gY3JlYXRlTm9kZXMoc2V0dGluZywgbGV2ZWwsIG5vZGVzLCBwYXJlbnROb2RlLCBpbmRleCkgewogICAgICBpZiAoIW5vZGVzIHx8IG5vZGVzLmxlbmd0aCA9PSAwKSByZXR1cm47CiAgICAgIHZhciByb290ID0gZGF0YS5nZXRSb290KHNldHRpbmcpLAogICAgICAgICAgb3BlbkZsYWcgPSAhcGFyZW50Tm9kZSB8fCBwYXJlbnROb2RlLm9wZW4gfHwgISEkJChkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKVswXSwgc2V0dGluZykuZ2V0KDApOwogICAgICByb290LmNyZWF0ZWROb2RlcyA9IFtdOwogICAgICB2YXIgelRyZWVIdG1sID0gdmlldy5hcHBlbmROb2RlcyhzZXR0aW5nLCBsZXZlbCwgbm9kZXMsIHBhcmVudE5vZGUsIGluZGV4LCB0cnVlLCBvcGVuRmxhZyksCiAgICAgICAgICBwYXJlbnRPYmosCiAgICAgICAgICBuZXh0T2JqOwoKICAgICAgaWYgKCFwYXJlbnROb2RlKSB7CiAgICAgICAgcGFyZW50T2JqID0gc2V0dGluZy50cmVlT2JqOyAvL3NldHRpbmcudHJlZU9iai5hcHBlbmQoelRyZWVIdG1sLmpvaW4oJycpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgdWxPYmogPSAkJChwYXJlbnROb2RlLCBjb25zdHMuaWQuVUwsIHNldHRpbmcpOwoKICAgICAgICBpZiAodWxPYmouZ2V0KDApKSB7CiAgICAgICAgICBwYXJlbnRPYmogPSB1bE9iajsgLy91bE9iai5hcHBlbmQoelRyZWVIdG1sLmpvaW4oJycpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwYXJlbnRPYmopIHsKICAgICAgICBpZiAoaW5kZXggPj0gMCkgewogICAgICAgICAgbmV4dE9iaiA9IHBhcmVudE9iai5jaGlsZHJlbigpW2luZGV4XTsKICAgICAgICB9CgogICAgICAgIGlmIChpbmRleCA+PSAwICYmIG5leHRPYmopIHsKICAgICAgICAgIF8kKG5leHRPYmopLmJlZm9yZSh6VHJlZUh0bWwuam9pbignJykpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwYXJlbnRPYmouYXBwZW5kKHpUcmVlSHRtbC5qb2luKCcnKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2aWV3LmNyZWF0ZU5vZGVDYWxsYmFjayhzZXR0aW5nKTsKICAgIH0sCiAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KHNldHRpbmcpIHsKICAgICAgaWYgKCFzZXR0aW5nKSByZXR1cm47CiAgICAgIGRhdGEuaW5pdENhY2hlKHNldHRpbmcpOwogICAgICBkYXRhLmluaXRSb290KHNldHRpbmcpOwogICAgICBldmVudC51bmJpbmRUcmVlKHNldHRpbmcpOwogICAgICBldmVudC51bmJpbmRFdmVudChzZXR0aW5nKTsKICAgICAgc2V0dGluZy50cmVlT2JqLmVtcHR5KCk7CiAgICAgIGRlbGV0ZSBzZXR0aW5nc1tzZXR0aW5nLnRyZWVJZF07CiAgICB9LAogICAgZXhwYW5kQ29sbGFwc2VOb2RlOiBmdW5jdGlvbiBleHBhbmRDb2xsYXBzZU5vZGUoc2V0dGluZywgbm9kZSwgZXhwYW5kRmxhZywgYW5pbWF0ZUZsYWcsIGNhbGxiYWNrKSB7CiAgICAgIHZhciByb290ID0gZGF0YS5nZXRSb290KHNldHRpbmcpOwoKICAgICAgdmFyIHRtcENiLCBfY2FsbGJhY2s7CgogICAgICBpZiAoIW5vZGUpIHsKICAgICAgICB0b29scy5hcHBseShjYWxsYmFjaywgW10pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgbm9kZSk7CiAgICAgIHZhciBpc1BhcmVudCA9IGRhdGEubm9kZUlzUGFyZW50KHNldHRpbmcsIG5vZGUpOwoKICAgICAgaWYgKHJvb3QuZXhwYW5kVHJpZ2dlckZsYWcpIHsKICAgICAgICBfY2FsbGJhY2sgPSBjYWxsYmFjazsKCiAgICAgICAgdG1wQ2IgPSBmdW5jdGlvbiB0bXBDYigpIHsKICAgICAgICAgIGlmIChfY2FsbGJhY2spIF9jYWxsYmFjaygpOwoKICAgICAgICAgIGlmIChub2RlLm9wZW4pIHsKICAgICAgICAgICAgc2V0dGluZy50cmVlT2JqLnRyaWdnZXIoY29uc3RzLmV2ZW50LkVYUEFORCwgW3NldHRpbmcudHJlZUlkLCBub2RlXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXR0aW5nLnRyZWVPYmoudHJpZ2dlcihjb25zdHMuZXZlbnQuQ09MTEFQU0UsIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0pOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGNhbGxiYWNrID0gdG1wQ2I7CiAgICAgICAgcm9vdC5leHBhbmRUcmlnZ2VyRmxhZyA9IGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIW5vZGUub3BlbiAmJiBpc1BhcmVudCAmJiAoISQkKG5vZGUsIGNvbnN0cy5pZC5VTCwgc2V0dGluZykuZ2V0KDApIHx8IGNoaWxkcmVuICYmIGNoaWxkcmVuLmxlbmd0aCA+IDAgJiYgISQkKGNoaWxkcmVuWzBdLCBzZXR0aW5nKS5nZXQoMCkpKSB7CiAgICAgICAgdmlldy5hcHBlbmRQYXJlbnRVTERvbShzZXR0aW5nLCBub2RlKTsKICAgICAgICB2aWV3LmNyZWF0ZU5vZGVDYWxsYmFjayhzZXR0aW5nKTsKICAgICAgfQoKICAgICAgaWYgKG5vZGUub3BlbiA9PSBleHBhbmRGbGFnKSB7CiAgICAgICAgdG9vbHMuYXBwbHkoY2FsbGJhY2ssIFtdKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciB1bE9iaiA9ICQkKG5vZGUsIGNvbnN0cy5pZC5VTCwgc2V0dGluZyksCiAgICAgICAgICBzd2l0Y2hPYmogPSAkJChub2RlLCBjb25zdHMuaWQuU1dJVENILCBzZXR0aW5nKSwKICAgICAgICAgIGljb09iaiA9ICQkKG5vZGUsIGNvbnN0cy5pZC5JQ09OLCBzZXR0aW5nKTsKCiAgICAgIGlmIChpc1BhcmVudCkgewogICAgICAgIG5vZGUub3BlbiA9ICFub2RlLm9wZW47CgogICAgICAgIGlmIChub2RlLmljb25PcGVuICYmIG5vZGUuaWNvbkNsb3NlKSB7CiAgICAgICAgICBpY29PYmouYXR0cigic3R5bGUiLCB2aWV3Lm1ha2VOb2RlSWNvU3R5bGUoc2V0dGluZywgbm9kZSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vZGUub3BlbikgewogICAgICAgICAgdmlldy5yZXBsYWNlU3dpdGNoQ2xhc3Mobm9kZSwgc3dpdGNoT2JqLCBjb25zdHMuZm9sZGVyLk9QRU4pOwogICAgICAgICAgdmlldy5yZXBsYWNlSWNvQ2xhc3Mobm9kZSwgaWNvT2JqLCBjb25zdHMuZm9sZGVyLk9QRU4pOwoKICAgICAgICAgIGlmIChhbmltYXRlRmxhZyA9PSBmYWxzZSB8fCBzZXR0aW5nLnZpZXcuZXhwYW5kU3BlZWQgPT0gIiIpIHsKICAgICAgICAgICAgdWxPYmouc2hvdygpOwogICAgICAgICAgICB0b29scy5hcHBseShjYWxsYmFjaywgW10pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKGNoaWxkcmVuICYmIGNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICB1bE9iai5zbGlkZURvd24oc2V0dGluZy52aWV3LmV4cGFuZFNwZWVkLCBjYWxsYmFjayk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdWxPYmouc2hvdygpOwogICAgICAgICAgICAgIHRvb2xzLmFwcGx5KGNhbGxiYWNrLCBbXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmlldy5yZXBsYWNlU3dpdGNoQ2xhc3Mobm9kZSwgc3dpdGNoT2JqLCBjb25zdHMuZm9sZGVyLkNMT1NFKTsKICAgICAgICAgIHZpZXcucmVwbGFjZUljb0NsYXNzKG5vZGUsIGljb09iaiwgY29uc3RzLmZvbGRlci5DTE9TRSk7CgogICAgICAgICAgaWYgKGFuaW1hdGVGbGFnID09IGZhbHNlIHx8IHNldHRpbmcudmlldy5leHBhbmRTcGVlZCA9PSAiIiB8fCAhKGNoaWxkcmVuICYmIGNoaWxkcmVuLmxlbmd0aCA+IDApKSB7CiAgICAgICAgICAgIHVsT2JqLmhpZGUoKTsKICAgICAgICAgICAgdG9vbHMuYXBwbHkoY2FsbGJhY2ssIFtdKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVsT2JqLnNsaWRlVXAoc2V0dGluZy52aWV3LmV4cGFuZFNwZWVkLCBjYWxsYmFjayk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRvb2xzLmFwcGx5KGNhbGxiYWNrLCBbXSk7CiAgICAgIH0KICAgIH0sCiAgICBleHBhbmRDb2xsYXBzZVBhcmVudE5vZGU6IGZ1bmN0aW9uIGV4cGFuZENvbGxhcHNlUGFyZW50Tm9kZShzZXR0aW5nLCBub2RlLCBleHBhbmRGbGFnLCBhbmltYXRlRmxhZywgY2FsbGJhY2spIHsKICAgICAgaWYgKCFub2RlKSByZXR1cm47CgogICAgICBpZiAoIW5vZGUucGFyZW50VElkKSB7CiAgICAgICAgdmlldy5leHBhbmRDb2xsYXBzZU5vZGUoc2V0dGluZywgbm9kZSwgZXhwYW5kRmxhZywgYW5pbWF0ZUZsYWcsIGNhbGxiYWNrKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmlldy5leHBhbmRDb2xsYXBzZU5vZGUoc2V0dGluZywgbm9kZSwgZXhwYW5kRmxhZywgYW5pbWF0ZUZsYWcpOwogICAgICB9CgogICAgICBpZiAobm9kZS5wYXJlbnRUSWQpIHsKICAgICAgICB2aWV3LmV4cGFuZENvbGxhcHNlUGFyZW50Tm9kZShzZXR0aW5nLCBub2RlLmdldFBhcmVudE5vZGUoKSwgZXhwYW5kRmxhZywgYW5pbWF0ZUZsYWcsIGNhbGxiYWNrKTsKICAgICAgfQogICAgfSwKICAgIGV4cGFuZENvbGxhcHNlU29uTm9kZTogZnVuY3Rpb24gZXhwYW5kQ29sbGFwc2VTb25Ob2RlKHNldHRpbmcsIG5vZGUsIGV4cGFuZEZsYWcsIGFuaW1hdGVGbGFnLCBjYWxsYmFjaykgewogICAgICB2YXIgcm9vdCA9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKSwKICAgICAgICAgIHRyZWVOb2RlcyA9IG5vZGUgPyBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBub2RlKSA6IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIHJvb3QpLAogICAgICAgICAgc2VsZkFuaW1hdGVTaWduID0gbm9kZSA/IGZhbHNlIDogYW5pbWF0ZUZsYWcsCiAgICAgICAgICBleHBhbmRUcmlnZ2VyRmxhZyA9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKS5leHBhbmRUcmlnZ2VyRmxhZzsKICAgICAgZGF0YS5nZXRSb290KHNldHRpbmcpLmV4cGFuZFRyaWdnZXJGbGFnID0gZmFsc2U7CgogICAgICBpZiAodHJlZU5vZGVzKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0cmVlTm9kZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBpZiAodHJlZU5vZGVzW2ldKSB2aWV3LmV4cGFuZENvbGxhcHNlU29uTm9kZShzZXR0aW5nLCB0cmVlTm9kZXNbaV0sIGV4cGFuZEZsYWcsIHNlbGZBbmltYXRlU2lnbik7CiAgICAgICAgfQogICAgICB9CgogICAgICBkYXRhLmdldFJvb3Qoc2V0dGluZykuZXhwYW5kVHJpZ2dlckZsYWcgPSBleHBhbmRUcmlnZ2VyRmxhZzsKICAgICAgdmlldy5leHBhbmRDb2xsYXBzZU5vZGUoc2V0dGluZywgbm9kZSwgZXhwYW5kRmxhZywgYW5pbWF0ZUZsYWcsIGNhbGxiYWNrKTsKICAgIH0sCiAgICBpc1NlbGVjdGVkTm9kZTogZnVuY3Rpb24gaXNTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSkgewogICAgICBpZiAoIW5vZGUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBsaXN0ID0gZGF0YS5nZXRSb290KHNldHRpbmcpLmN1clNlbGVjdGVkTGlzdCwKICAgICAgICAgIGk7CgogICAgICBmb3IgKGkgPSBsaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgaWYgKG5vZGUgPT09IGxpc3RbaV0pIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIG1ha2VET01Ob2RlSWNvbjogZnVuY3Rpb24gbWFrZURPTU5vZGVJY29uKGh0bWwsIHNldHRpbmcsIG5vZGUpIHsKICAgICAgdmFyIG5hbWVTdHIgPSBkYXRhLm5vZGVOYW1lKHNldHRpbmcsIG5vZGUpLAogICAgICAgICAgbmFtZSA9IHNldHRpbmcudmlldy5uYW1lSXNIVE1MID8gbmFtZVN0ciA6IG5hbWVTdHIucmVwbGFjZSgvJi9nLCAnJmFtcDsnKS5yZXBsYWNlKC88L2csICcmbHQ7JykucmVwbGFjZSgvPi9nLCAnJmd0OycpOwogICAgICBodG1sLnB1c2goIjxzcGFuIGlkPSciLCBub2RlLnRJZCwgY29uc3RzLmlkLklDT04sICInIHRpdGxlPScnIHRyZWVOb2RlIiwgY29uc3RzLmlkLklDT04sICIgY2xhc3M9JyIsIHZpZXcubWFrZU5vZGVJY29DbGFzcyhzZXR0aW5nLCBub2RlKSwgIicgc3R5bGU9JyIsIHZpZXcubWFrZU5vZGVJY29TdHlsZShzZXR0aW5nLCBub2RlKSwgIic+PC9zcGFuPjxzcGFuIGlkPSciLCBub2RlLnRJZCwgY29uc3RzLmlkLlNQQU4sICInIGNsYXNzPSciLCBjb25zdHMuY2xhc3NOYW1lLk5BTUUsICInPiIsIG5hbWUsICI8L3NwYW4+Iik7CiAgICB9LAogICAgbWFrZURPTU5vZGVMaW5lOiBmdW5jdGlvbiBtYWtlRE9NTm9kZUxpbmUoaHRtbCwgc2V0dGluZywgbm9kZSkgewogICAgICBodG1sLnB1c2goIjxzcGFuIGlkPSciLCBub2RlLnRJZCwgY29uc3RzLmlkLlNXSVRDSCwgIicgdGl0bGU9JycgY2xhc3M9JyIsIHZpZXcubWFrZU5vZGVMaW5lQ2xhc3Moc2V0dGluZywgbm9kZSksICInIHRyZWVOb2RlIiwgY29uc3RzLmlkLlNXSVRDSCwgIj48L3NwYW4+Iik7CiAgICB9LAogICAgbWFrZURPTU5vZGVNYWluQWZ0ZXI6IGZ1bmN0aW9uIG1ha2VET01Ob2RlTWFpbkFmdGVyKGh0bWwsIHNldHRpbmcsIG5vZGUpIHsKICAgICAgaHRtbC5wdXNoKCI8L2xpPiIpOwogICAgfSwKICAgIG1ha2VET01Ob2RlTWFpbkJlZm9yZTogZnVuY3Rpb24gbWFrZURPTU5vZGVNYWluQmVmb3JlKGh0bWwsIHNldHRpbmcsIG5vZGUpIHsKICAgICAgaHRtbC5wdXNoKCI8bGkgaWQ9JyIsIG5vZGUudElkLCAiJyBjbGFzcz0nIiwgY29uc3RzLmNsYXNzTmFtZS5MRVZFTCwgbm9kZS5sZXZlbCwgIicgdGFiaW5kZXg9JzAnIGhpZGVmb2N1cz0ndHJ1ZScgdHJlZW5vZGU+Iik7CiAgICB9LAogICAgbWFrZURPTU5vZGVOYW1lQWZ0ZXI6IGZ1bmN0aW9uIG1ha2VET01Ob2RlTmFtZUFmdGVyKGh0bWwsIHNldHRpbmcsIG5vZGUpIHsKICAgICAgaHRtbC5wdXNoKCI8L2E+Iik7CiAgICB9LAogICAgbWFrZURPTU5vZGVOYW1lQmVmb3JlOiBmdW5jdGlvbiBtYWtlRE9NTm9kZU5hbWVCZWZvcmUoaHRtbCwgc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgdGl0bGUgPSBkYXRhLm5vZGVUaXRsZShzZXR0aW5nLCBub2RlKSwKICAgICAgICAgIHVybCA9IHZpZXcubWFrZU5vZGVVcmwoc2V0dGluZywgbm9kZSksCiAgICAgICAgICBmb250Y3NzID0gdmlldy5tYWtlTm9kZUZvbnRDc3Moc2V0dGluZywgbm9kZSksCiAgICAgICAgICBub2RlQ2xhc3NlcyA9IHZpZXcubWFrZU5vZGVDbGFzc2VzKHNldHRpbmcsIG5vZGUpLAogICAgICAgICAgZm9udFN0eWxlID0gW107CgogICAgICBmb3IgKHZhciBmIGluIGZvbnRjc3MpIHsKICAgICAgICBmb250U3R5bGUucHVzaChmLCAiOiIsIGZvbnRjc3NbZl0sICI7Iik7CiAgICAgIH0KCiAgICAgIGh0bWwucHVzaCgiPGEgaWQ9JyIsIG5vZGUudElkLCBjb25zdHMuaWQuQSwgIicgY2xhc3M9JyIsIGNvbnN0cy5jbGFzc05hbWUuTEVWRUwsIG5vZGUubGV2ZWwsIG5vZGVDbGFzc2VzLmFkZCA/ICcgJyArIG5vZGVDbGFzc2VzLmFkZC5qb2luKCcgJykgOiAnJywgIicgdHJlZU5vZGUiLCBjb25zdHMuaWQuQSwgbm9kZS5jbGljayA/ICIgb25jbGljaz1cIiIgKyBub2RlLmNsaWNrICsgIlwiIiA6ICIiLCB1cmwgIT0gbnVsbCAmJiB1cmwubGVuZ3RoID4gMCA/ICIgaHJlZj0nIiArIHVybCArICInIiA6ICIiLCAiIHRhcmdldD0nIiwgdmlldy5tYWtlTm9kZVRhcmdldChub2RlKSwgIicgc3R5bGU9JyIsIGZvbnRTdHlsZS5qb2luKCcnKSwgIiciKTsKCiAgICAgIGlmICh0b29scy5hcHBseShzZXR0aW5nLnZpZXcuc2hvd1RpdGxlLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdLCBzZXR0aW5nLnZpZXcuc2hvd1RpdGxlKSAmJiB0aXRsZSkgewogICAgICAgIGh0bWwucHVzaCgidGl0bGU9JyIsIHRpdGxlLnJlcGxhY2UoLycvZywgIiYjMzk7IikucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoLz4vZywgJyZndDsnKSwgIiciKTsKICAgICAgfQoKICAgICAgaHRtbC5wdXNoKCI+Iik7CiAgICB9LAogICAgbWFrZU5vZGVGb250Q3NzOiBmdW5jdGlvbiBtYWtlTm9kZUZvbnRDc3Moc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgZm9udENzcyA9IHRvb2xzLmFwcGx5KHNldHRpbmcudmlldy5mb250Q3NzLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdLCBzZXR0aW5nLnZpZXcuZm9udENzcyk7CiAgICAgIHJldHVybiBmb250Q3NzICYmIHR5cGVvZiBmb250Q3NzICE9ICJmdW5jdGlvbiIgPyBmb250Q3NzIDoge307CiAgICB9LAogICAgbWFrZU5vZGVDbGFzc2VzOiBmdW5jdGlvbiBtYWtlTm9kZUNsYXNzZXMoc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgY2xhc3NlcyA9IHRvb2xzLmFwcGx5KHNldHRpbmcudmlldy5ub2RlQ2xhc3NlcywgW3NldHRpbmcudHJlZUlkLCBub2RlXSwgc2V0dGluZy52aWV3Lm5vZGVDbGFzc2VzKTsKICAgICAgcmV0dXJuIGNsYXNzZXMgJiYgdHlwZW9mIGNsYXNzZXMgIT09ICJmdW5jdGlvbiIgPyBjbGFzc2VzIDogewogICAgICAgIGFkZDogW10sCiAgICAgICAgcmVtb3ZlOiBbXQogICAgICB9OwogICAgfSwKICAgIG1ha2VOb2RlSWNvQ2xhc3M6IGZ1bmN0aW9uIG1ha2VOb2RlSWNvQ2xhc3Moc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgaWNvQ3NzID0gWyJpY28iXTsKCiAgICAgIGlmICghbm9kZS5pc0FqYXhpbmcpIHsKICAgICAgICB2YXIgaXNQYXJlbnQgPSBkYXRhLm5vZGVJc1BhcmVudChzZXR0aW5nLCBub2RlKTsKICAgICAgICBpY29Dc3NbMF0gPSAobm9kZS5pY29uU2tpbiA/IG5vZGUuaWNvblNraW4gKyAiXyIgOiAiIikgKyBpY29Dc3NbMF07CgogICAgICAgIGlmIChpc1BhcmVudCkgewogICAgICAgICAgaWNvQ3NzLnB1c2gobm9kZS5vcGVuID8gY29uc3RzLmZvbGRlci5PUEVOIDogY29uc3RzLmZvbGRlci5DTE9TRSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGljb0Nzcy5wdXNoKGNvbnN0cy5mb2xkZXIuRE9DVSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gY29uc3RzLmNsYXNzTmFtZS5CVVRUT04gKyAiICIgKyBpY29Dc3Muam9pbignXycpOwogICAgfSwKICAgIG1ha2VOb2RlSWNvU3R5bGU6IGZ1bmN0aW9uIG1ha2VOb2RlSWNvU3R5bGUoc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgaWNvU3R5bGUgPSBbXTsKCiAgICAgIGlmICghbm9kZS5pc0FqYXhpbmcpIHsKICAgICAgICB2YXIgaXNQYXJlbnQgPSBkYXRhLm5vZGVJc1BhcmVudChzZXR0aW5nLCBub2RlKTsKICAgICAgICB2YXIgaWNvbiA9IGlzUGFyZW50ICYmIG5vZGUuaWNvbk9wZW4gJiYgbm9kZS5pY29uQ2xvc2UgPyBub2RlLm9wZW4gPyBub2RlLmljb25PcGVuIDogbm9kZS5pY29uQ2xvc2UgOiBub2RlW3NldHRpbmcuZGF0YS5rZXkuaWNvbl07CiAgICAgICAgaWYgKGljb24pIGljb1N0eWxlLnB1c2goImJhY2tncm91bmQ6dXJsKCIsIGljb24sICIpIDAgMCBuby1yZXBlYXQ7Iik7CgogICAgICAgIGlmIChzZXR0aW5nLnZpZXcuc2hvd0ljb24gPT0gZmFsc2UgfHwgIXRvb2xzLmFwcGx5KHNldHRpbmcudmlldy5zaG93SWNvbiwgW3NldHRpbmcudHJlZUlkLCBub2RlXSwgdHJ1ZSkpIHsKICAgICAgICAgIGljb1N0eWxlLnB1c2goImRpc3BsYXk6bm9uZTsiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBpY29TdHlsZS5qb2luKCcnKTsKICAgIH0sCiAgICBtYWtlTm9kZUxpbmVDbGFzczogZnVuY3Rpb24gbWFrZU5vZGVMaW5lQ2xhc3Moc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgbGluZUNsYXNzID0gW107CgogICAgICBpZiAoc2V0dGluZy52aWV3LnNob3dMaW5lKSB7CiAgICAgICAgaWYgKG5vZGUubGV2ZWwgPT0gMCAmJiBub2RlLmlzRmlyc3ROb2RlICYmIG5vZGUuaXNMYXN0Tm9kZSkgewogICAgICAgICAgbGluZUNsYXNzLnB1c2goY29uc3RzLmxpbmUuUk9PVCk7CiAgICAgICAgfSBlbHNlIGlmIChub2RlLmxldmVsID09IDAgJiYgbm9kZS5pc0ZpcnN0Tm9kZSkgewogICAgICAgICAgbGluZUNsYXNzLnB1c2goY29uc3RzLmxpbmUuUk9PVFMpOwogICAgICAgIH0gZWxzZSBpZiAobm9kZS5pc0xhc3ROb2RlKSB7CiAgICAgICAgICBsaW5lQ2xhc3MucHVzaChjb25zdHMubGluZS5CT1RUT00pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsaW5lQ2xhc3MucHVzaChjb25zdHMubGluZS5DRU5URVIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBsaW5lQ2xhc3MucHVzaChjb25zdHMubGluZS5OT0xJTkUpOwogICAgICB9CgogICAgICBpZiAoZGF0YS5ub2RlSXNQYXJlbnQoc2V0dGluZywgbm9kZSkpIHsKICAgICAgICBsaW5lQ2xhc3MucHVzaChub2RlLm9wZW4gPyBjb25zdHMuZm9sZGVyLk9QRU4gOiBjb25zdHMuZm9sZGVyLkNMT1NFKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsaW5lQ2xhc3MucHVzaChjb25zdHMuZm9sZGVyLkRPQ1UpOwogICAgICB9CgogICAgICByZXR1cm4gdmlldy5tYWtlTm9kZUxpbmVDbGFzc0V4KG5vZGUpICsgbGluZUNsYXNzLmpvaW4oJ18nKTsKICAgIH0sCiAgICBtYWtlTm9kZUxpbmVDbGFzc0V4OiBmdW5jdGlvbiBtYWtlTm9kZUxpbmVDbGFzc0V4KG5vZGUpIHsKICAgICAgcmV0dXJuIGNvbnN0cy5jbGFzc05hbWUuQlVUVE9OICsgIiAiICsgY29uc3RzLmNsYXNzTmFtZS5MRVZFTCArIG5vZGUubGV2ZWwgKyAiICIgKyBjb25zdHMuY2xhc3NOYW1lLlNXSVRDSCArICIgIjsKICAgIH0sCiAgICBtYWtlTm9kZVRhcmdldDogZnVuY3Rpb24gbWFrZU5vZGVUYXJnZXQobm9kZSkgewogICAgICByZXR1cm4gbm9kZS50YXJnZXQgfHwgIl9ibGFuayI7CiAgICB9LAogICAgbWFrZU5vZGVVcmw6IGZ1bmN0aW9uIG1ha2VOb2RlVXJsKHNldHRpbmcsIG5vZGUpIHsKICAgICAgdmFyIHVybEtleSA9IHNldHRpbmcuZGF0YS5rZXkudXJsOwogICAgICByZXR1cm4gbm9kZVt1cmxLZXldID8gbm9kZVt1cmxLZXldIDogbnVsbDsKICAgIH0sCiAgICBtYWtlVWxIdG1sOiBmdW5jdGlvbiBtYWtlVWxIdG1sKHNldHRpbmcsIG5vZGUsIGh0bWwsIGNvbnRlbnQpIHsKICAgICAgaHRtbC5wdXNoKCI8dWwgaWQ9JyIsIG5vZGUudElkLCBjb25zdHMuaWQuVUwsICInIGNsYXNzPSciLCBjb25zdHMuY2xhc3NOYW1lLkxFVkVMLCBub2RlLmxldmVsLCAiICIsIHZpZXcubWFrZVVsTGluZUNsYXNzKHNldHRpbmcsIG5vZGUpLCAiJyBzdHlsZT0nZGlzcGxheToiLCBub2RlLm9wZW4gPyAiYmxvY2siIDogIm5vbmUiLCAiJz4iKTsKICAgICAgaHRtbC5wdXNoKGNvbnRlbnQpOwogICAgICBodG1sLnB1c2goIjwvdWw+Iik7CiAgICB9LAogICAgbWFrZVVsTGluZUNsYXNzOiBmdW5jdGlvbiBtYWtlVWxMaW5lQ2xhc3Moc2V0dGluZywgbm9kZSkgewogICAgICByZXR1cm4gc2V0dGluZy52aWV3LnNob3dMaW5lICYmICFub2RlLmlzTGFzdE5vZGUgPyBjb25zdHMubGluZS5MSU5FIDogIiI7CiAgICB9LAogICAgcmVtb3ZlQ2hpbGROb2RlczogZnVuY3Rpb24gcmVtb3ZlQ2hpbGROb2RlcyhzZXR0aW5nLCBub2RlKSB7CiAgICAgIGlmICghbm9kZSkgcmV0dXJuOwogICAgICB2YXIgbm9kZXMgPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBub2RlKTsKICAgICAgaWYgKCFub2RlcykgcmV0dXJuOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBub2Rlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBkYXRhLnJlbW92ZU5vZGVDYWNoZShzZXR0aW5nLCBub2Rlc1tpXSk7CiAgICAgIH0KCiAgICAgIGRhdGEucmVtb3ZlU2VsZWN0ZWROb2RlKHNldHRpbmcpOwogICAgICBkZWxldGUgbm9kZVtzZXR0aW5nLmRhdGEua2V5LmNoaWxkcmVuXTsKCiAgICAgIGlmICghc2V0dGluZy5kYXRhLmtlZXAucGFyZW50KSB7CiAgICAgICAgZGF0YS5ub2RlSXNQYXJlbnQoc2V0dGluZywgbm9kZSwgZmFsc2UpOwogICAgICAgIG5vZGUub3BlbiA9IGZhbHNlOwogICAgICAgIHZhciB0bXBfc3dpdGNoT2JqID0gJCQobm9kZSwgY29uc3RzLmlkLlNXSVRDSCwgc2V0dGluZyksCiAgICAgICAgICAgIHRtcF9pY29PYmogPSAkJChub2RlLCBjb25zdHMuaWQuSUNPTiwgc2V0dGluZyk7CiAgICAgICAgdmlldy5yZXBsYWNlU3dpdGNoQ2xhc3Mobm9kZSwgdG1wX3N3aXRjaE9iaiwgY29uc3RzLmZvbGRlci5ET0NVKTsKICAgICAgICB2aWV3LnJlcGxhY2VJY29DbGFzcyhub2RlLCB0bXBfaWNvT2JqLCBjb25zdHMuZm9sZGVyLkRPQ1UpOwogICAgICAgICQkKG5vZGUsIGNvbnN0cy5pZC5VTCwgc2V0dGluZykucmVtb3ZlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJCQobm9kZSwgY29uc3RzLmlkLlVMLCBzZXR0aW5nKS5lbXB0eSgpOwogICAgICB9CiAgICB9LAogICAgc2Nyb2xsSW50b1ZpZXc6IGZ1bmN0aW9uIHNjcm9sbEludG9WaWV3KHNldHRpbmcsIGRvbSkgewogICAgICBpZiAoIWRvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBzdXBwb3J0IElFIDcgLyA4CgoKICAgICAgaWYgKHR5cGVvZiBFbGVtZW50ID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgdmFyIGNvbnRSZWN0ID0gc2V0dGluZy50cmVlT2JqLmdldCgwKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwKICAgICAgICAgICAgZmluZE1lUmVjdCA9IGRvbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCiAgICAgICAgaWYgKGZpbmRNZVJlY3QudG9wIDwgY29udFJlY3QudG9wIHx8IGZpbmRNZVJlY3QuYm90dG9tID4gY29udFJlY3QuYm90dG9tIHx8IGZpbmRNZVJlY3QucmlnaHQgPiBjb250UmVjdC5yaWdodCB8fCBmaW5kTWVSZWN0LmxlZnQgPCBjb250UmVjdC5sZWZ0KSB7CiAgICAgICAgICBkb20uc2Nyb2xsSW50b1ZpZXcoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDQy1CWSBqb2NraTg0QGdvb2dsZW1haWwuY29tLCBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9qb2NraTg0LzZmZmFmZDAwMzM4NzE3OWE5ODhlCgoKICAgICAgaWYgKCFFbGVtZW50LnByb3RvdHlwZS5zY3JvbGxJbnRvVmlld0lmTmVlZGVkKSB7CiAgICAgICAgRWxlbWVudC5wcm90b3R5cGUuc2Nyb2xsSW50b1ZpZXdJZk5lZWRlZCA9IGZ1bmN0aW9uIChjZW50ZXJJZk5lZWRlZCkgewogICAgICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgICAgIGZ1bmN0aW9uIG1ha2VSYW5nZShzdGFydCwgbGVuZ3RoKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgInN0YXJ0Ijogc3RhcnQsCiAgICAgICAgICAgICAgImxlbmd0aCI6IGxlbmd0aCwKICAgICAgICAgICAgICAiZW5kIjogc3RhcnQgKyBsZW5ndGgKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KCiAgICAgICAgICBmdW5jdGlvbiBjb3ZlclJhbmdlKGlubmVyLCBvdXRlcikgewogICAgICAgICAgICBpZiAoZmFsc2UgPT09IGNlbnRlcklmTmVlZGVkIHx8IG91dGVyLnN0YXJ0IDwgaW5uZXIuZW5kICYmIGlubmVyLnN0YXJ0IDwgb3V0ZXIuZW5kKSB7CiAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KGlubmVyLmVuZCAtIG91dGVyLmxlbmd0aCwgTWF0aC5taW4ob3V0ZXIuc3RhcnQsIGlubmVyLnN0YXJ0KSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiAoaW5uZXIuc3RhcnQgKyBpbm5lci5lbmQgLSBvdXRlci5sZW5ndGgpIC8gMjsKICAgICAgICAgIH0KCiAgICAgICAgICBmdW5jdGlvbiBtYWtlUG9pbnQoeCwgeSkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICJ4IjogeCwKICAgICAgICAgICAgICAieSI6IHksCiAgICAgICAgICAgICAgInRyYW5zbGF0ZSI6IGZ1bmN0aW9uIHRyYW5zbGF0ZShkWCwgZFkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtYWtlUG9pbnQoeCArIGRYLCB5ICsgZFkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgIH0KCiAgICAgICAgICBmdW5jdGlvbiBhYnNvbHV0ZShlbGVtLCBwdCkgewogICAgICAgICAgICB3aGlsZSAoZWxlbSkgewogICAgICAgICAgICAgIHB0ID0gcHQudHJhbnNsYXRlKGVsZW0ub2Zmc2V0TGVmdCwgZWxlbS5vZmZzZXRUb3ApOwogICAgICAgICAgICAgIGVsZW0gPSBlbGVtLm9mZnNldFBhcmVudDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHB0OwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB0YXJnZXQgPSBhYnNvbHV0ZSh0aGlzLCBtYWtlUG9pbnQoMCwgMCkpLAogICAgICAgICAgICAgIGV4dGVudCA9IG1ha2VQb2ludCh0aGlzLm9mZnNldFdpZHRoLCB0aGlzLm9mZnNldEhlaWdodCksCiAgICAgICAgICAgICAgZWxlbSA9IHRoaXMucGFyZW50Tm9kZSwKICAgICAgICAgICAgICBvcmlnaW47CgogICAgICAgICAgd2hpbGUgKGVsZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgewogICAgICAgICAgICAvLyBBcHBseSBkZXNpcmVkIHNjcm9sbCBhbW91bnQuCiAgICAgICAgICAgIG9yaWdpbiA9IGFic29sdXRlKGVsZW0sIG1ha2VQb2ludChlbGVtLmNsaWVudExlZnQsIGVsZW0uY2xpZW50VG9wKSk7CiAgICAgICAgICAgIGVsZW0uc2Nyb2xsTGVmdCA9IGNvdmVyUmFuZ2UobWFrZVJhbmdlKHRhcmdldC54IC0gb3JpZ2luLngsIGV4dGVudC54KSwgbWFrZVJhbmdlKGVsZW0uc2Nyb2xsTGVmdCwgZWxlbS5jbGllbnRXaWR0aCkpOwogICAgICAgICAgICBlbGVtLnNjcm9sbFRvcCA9IGNvdmVyUmFuZ2UobWFrZVJhbmdlKHRhcmdldC55IC0gb3JpZ2luLnksIGV4dGVudC55KSwgbWFrZVJhbmdlKGVsZW0uc2Nyb2xsVG9wLCBlbGVtLmNsaWVudEhlaWdodCkpOyAvLyBEZXRlcm1pbmUgYWN0dWFsIHNjcm9sbCBhbW91bnQgYnkgcmVhZGluZyBiYWNrIHNjcm9sbCBwcm9wZXJ0aWVzLgoKICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnRyYW5zbGF0ZSgtZWxlbS5zY3JvbGxMZWZ0LCAtZWxlbS5zY3JvbGxUb3ApOwogICAgICAgICAgICBlbGVtID0gZWxlbS5wYXJlbnROb2RlOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGRvbS5zY3JvbGxJbnRvVmlld0lmTmVlZGVkKCk7CiAgICB9LAogICAgc2V0Rmlyc3ROb2RlOiBmdW5jdGlvbiBzZXRGaXJzdE5vZGUoc2V0dGluZywgcGFyZW50Tm9kZSkgewogICAgICB2YXIgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKTsKCiAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgY2hpbGRyZW5bMF0uaXNGaXJzdE5vZGUgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgc2V0TGFzdE5vZGU6IGZ1bmN0aW9uIHNldExhc3ROb2RlKHNldHRpbmcsIHBhcmVudE5vZGUpIHsKICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcGFyZW50Tm9kZSk7CgogICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgIGNoaWxkcmVuW2NoaWxkcmVuLmxlbmd0aCAtIDFdLmlzTGFzdE5vZGUgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgcmVtb3ZlTm9kZTogZnVuY3Rpb24gcmVtb3ZlTm9kZShzZXR0aW5nLCBub2RlKSB7CiAgICAgIHZhciByb290ID0gZGF0YS5nZXRSb290KHNldHRpbmcpLAogICAgICAgICAgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50VElkID8gbm9kZS5nZXRQYXJlbnROb2RlKCkgOiByb290OwogICAgICBub2RlLmlzRmlyc3ROb2RlID0gZmFsc2U7CiAgICAgIG5vZGUuaXNMYXN0Tm9kZSA9IGZhbHNlOwoKICAgICAgbm9kZS5nZXRQcmVOb2RlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9OwoKICAgICAgbm9kZS5nZXROZXh0Tm9kZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfTsKCiAgICAgIGlmICghZGF0YS5nZXROb2RlQ2FjaGUoc2V0dGluZywgbm9kZS50SWQpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAkJChub2RlLCBzZXR0aW5nKS5yZW1vdmUoKTsKICAgICAgZGF0YS5yZW1vdmVOb2RlQ2FjaGUoc2V0dGluZywgbm9kZSk7CiAgICAgIGRhdGEucmVtb3ZlU2VsZWN0ZWROb2RlKHNldHRpbmcsIG5vZGUpOwogICAgICB2YXIgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgaWYgKGNoaWxkcmVuW2ldLnRJZCA9PSBub2RlLnRJZCkgewogICAgICAgICAgY2hpbGRyZW4uc3BsaWNlKGksIDEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICB2aWV3LnNldEZpcnN0Tm9kZShzZXR0aW5nLCBwYXJlbnROb2RlKTsKICAgICAgdmlldy5zZXRMYXN0Tm9kZShzZXR0aW5nLCBwYXJlbnROb2RlKTsKICAgICAgdmFyIHRtcF91bE9iaiwKICAgICAgICAgIHRtcF9zd2l0Y2hPYmosCiAgICAgICAgICB0bXBfaWNvT2JqLAogICAgICAgICAgY2hpbGRMZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7IC8vcmVwYWlyIG5vZGVzIG9sZCBwYXJlbnQKCiAgICAgIGlmICghc2V0dGluZy5kYXRhLmtlZXAucGFyZW50ICYmIGNoaWxkTGVuZ3RoID09IDApIHsKICAgICAgICAvL29sZCBwYXJlbnROb2RlIGhhcyBubyBjaGlsZCBub2RlcwogICAgICAgIGRhdGEubm9kZUlzUGFyZW50KHNldHRpbmcsIHBhcmVudE5vZGUsIGZhbHNlKTsKICAgICAgICBwYXJlbnROb2RlLm9wZW4gPSBmYWxzZTsKICAgICAgICBkZWxldGUgcGFyZW50Tm9kZVtzZXR0aW5nLmRhdGEua2V5LmNoaWxkcmVuXTsKICAgICAgICB0bXBfdWxPYmogPSAkJChwYXJlbnROb2RlLCBjb25zdHMuaWQuVUwsIHNldHRpbmcpOwogICAgICAgIHRtcF9zd2l0Y2hPYmogPSAkJChwYXJlbnROb2RlLCBjb25zdHMuaWQuU1dJVENILCBzZXR0aW5nKTsKICAgICAgICB0bXBfaWNvT2JqID0gJCQocGFyZW50Tm9kZSwgY29uc3RzLmlkLklDT04sIHNldHRpbmcpOwogICAgICAgIHZpZXcucmVwbGFjZVN3aXRjaENsYXNzKHBhcmVudE5vZGUsIHRtcF9zd2l0Y2hPYmosIGNvbnN0cy5mb2xkZXIuRE9DVSk7CiAgICAgICAgdmlldy5yZXBsYWNlSWNvQ2xhc3MocGFyZW50Tm9kZSwgdG1wX2ljb09iaiwgY29uc3RzLmZvbGRlci5ET0NVKTsKICAgICAgICB0bXBfdWxPYmouY3NzKCJkaXNwbGF5IiwgIm5vbmUiKTsKICAgICAgfSBlbHNlIGlmIChzZXR0aW5nLnZpZXcuc2hvd0xpbmUgJiYgY2hpbGRMZW5ndGggPiAwKSB7CiAgICAgICAgLy9vbGQgcGFyZW50Tm9kZSBoYXMgY2hpbGQgbm9kZXMKICAgICAgICB2YXIgbmV3TGFzdCA9IGNoaWxkcmVuW2NoaWxkTGVuZ3RoIC0gMV07CiAgICAgICAgdG1wX3VsT2JqID0gJCQobmV3TGFzdCwgY29uc3RzLmlkLlVMLCBzZXR0aW5nKTsKICAgICAgICB0bXBfc3dpdGNoT2JqID0gJCQobmV3TGFzdCwgY29uc3RzLmlkLlNXSVRDSCwgc2V0dGluZyk7CiAgICAgICAgdG1wX2ljb09iaiA9ICQkKG5ld0xhc3QsIGNvbnN0cy5pZC5JQ09OLCBzZXR0aW5nKTsKCiAgICAgICAgaWYgKHBhcmVudE5vZGUgPT0gcm9vdCkgewogICAgICAgICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgIC8vbm9kZSB3YXMgcm9vdCwgYW5kIHp0cmVlIGhhcyBvbmx5IG9uZSByb290IGFmdGVyIG1vdmUgbm9kZQogICAgICAgICAgICB2aWV3LnJlcGxhY2VTd2l0Y2hDbGFzcyhuZXdMYXN0LCB0bXBfc3dpdGNoT2JqLCBjb25zdHMubGluZS5ST09UKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciB0bXBfZmlyc3Rfc3dpdGNoT2JqID0gJCQoY2hpbGRyZW5bMF0sIGNvbnN0cy5pZC5TV0lUQ0gsIHNldHRpbmcpOwogICAgICAgICAgICB2aWV3LnJlcGxhY2VTd2l0Y2hDbGFzcyhjaGlsZHJlblswXSwgdG1wX2ZpcnN0X3N3aXRjaE9iaiwgY29uc3RzLmxpbmUuUk9PVFMpOwogICAgICAgICAgICB2aWV3LnJlcGxhY2VTd2l0Y2hDbGFzcyhuZXdMYXN0LCB0bXBfc3dpdGNoT2JqLCBjb25zdHMubGluZS5CT1RUT00pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2aWV3LnJlcGxhY2VTd2l0Y2hDbGFzcyhuZXdMYXN0LCB0bXBfc3dpdGNoT2JqLCBjb25zdHMubGluZS5CT1RUT00pOwogICAgICAgIH0KCiAgICAgICAgdG1wX3VsT2JqLnJlbW92ZUNsYXNzKGNvbnN0cy5saW5lLkxJTkUpOwogICAgICB9CiAgICB9LAogICAgcmVwbGFjZUljb0NsYXNzOiBmdW5jdGlvbiByZXBsYWNlSWNvQ2xhc3Mobm9kZSwgb2JqLCBuZXdOYW1lKSB7CiAgICAgIGlmICghb2JqIHx8IG5vZGUuaXNBamF4aW5nKSByZXR1cm47CiAgICAgIHZhciB0bXBOYW1lID0gb2JqLmF0dHIoImNsYXNzIik7CiAgICAgIGlmICh0bXBOYW1lID09IHVuZGVmaW5lZCkgcmV0dXJuOwogICAgICB2YXIgdG1wTGlzdCA9IHRtcE5hbWUuc3BsaXQoIl8iKTsKCiAgICAgIHN3aXRjaCAobmV3TmFtZSkgewogICAgICAgIGNhc2UgY29uc3RzLmZvbGRlci5PUEVOOgogICAgICAgIGNhc2UgY29uc3RzLmZvbGRlci5DTE9TRToKICAgICAgICBjYXNlIGNvbnN0cy5mb2xkZXIuRE9DVToKICAgICAgICAgIHRtcExpc3RbdG1wTGlzdC5sZW5ndGggLSAxXSA9IG5ld05hbWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgb2JqLmF0dHIoImNsYXNzIiwgdG1wTGlzdC5qb2luKCJfIikpOwogICAgfSwKICAgIHJlcGxhY2VTd2l0Y2hDbGFzczogZnVuY3Rpb24gcmVwbGFjZVN3aXRjaENsYXNzKG5vZGUsIG9iaiwgbmV3TmFtZSkgewogICAgICBpZiAoIW9iaikgcmV0dXJuOwogICAgICB2YXIgdG1wTmFtZSA9IG9iai5hdHRyKCJjbGFzcyIpOwogICAgICBpZiAodG1wTmFtZSA9PSB1bmRlZmluZWQpIHJldHVybjsKICAgICAgdmFyIHRtcExpc3QgPSB0bXBOYW1lLnNwbGl0KCJfIik7CgogICAgICBzd2l0Y2ggKG5ld05hbWUpIHsKICAgICAgICBjYXNlIGNvbnN0cy5saW5lLlJPT1Q6CiAgICAgICAgY2FzZSBjb25zdHMubGluZS5ST09UUzoKICAgICAgICBjYXNlIGNvbnN0cy5saW5lLkNFTlRFUjoKICAgICAgICBjYXNlIGNvbnN0cy5saW5lLkJPVFRPTToKICAgICAgICBjYXNlIGNvbnN0cy5saW5lLk5PTElORToKICAgICAgICAgIHRtcExpc3RbMF0gPSB2aWV3Lm1ha2VOb2RlTGluZUNsYXNzRXgobm9kZSkgKyBuZXdOYW1lOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgY29uc3RzLmZvbGRlci5PUEVOOgogICAgICAgIGNhc2UgY29uc3RzLmZvbGRlci5DTE9TRToKICAgICAgICBjYXNlIGNvbnN0cy5mb2xkZXIuRE9DVToKICAgICAgICAgIHRtcExpc3RbMV0gPSBuZXdOYW1lOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIG9iai5hdHRyKCJjbGFzcyIsIHRtcExpc3Quam9pbigiXyIpKTsKCiAgICAgIGlmIChuZXdOYW1lICE9PSBjb25zdHMuZm9sZGVyLkRPQ1UpIHsKICAgICAgICBvYmoucmVtb3ZlQXR0cigiZGlzYWJsZWQiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvYmouYXR0cigiZGlzYWJsZWQiLCAiZGlzYWJsZWQiKTsKICAgICAgfQogICAgfSwKICAgIHNlbGVjdE5vZGU6IGZ1bmN0aW9uIHNlbGVjdE5vZGUoc2V0dGluZywgbm9kZSwgYWRkRmxhZykgewogICAgICBpZiAoIWFkZEZsYWcpIHsKICAgICAgICB2aWV3LmNhbmNlbFByZVNlbGVjdGVkTm9kZShzZXR0aW5nLCBudWxsLCBub2RlKTsKICAgICAgfQoKICAgICAgJCQobm9kZSwgY29uc3RzLmlkLkEsIHNldHRpbmcpLmFkZENsYXNzKGNvbnN0cy5ub2RlLkNVUlNFTEVDVEVEKTsKICAgICAgZGF0YS5hZGRTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSk7CiAgICAgIHNldHRpbmcudHJlZU9iai50cmlnZ2VyKGNvbnN0cy5ldmVudC5TRUxFQ1RFRCwgW3NldHRpbmcudHJlZUlkLCBub2RlXSk7CiAgICB9LAogICAgc2V0Tm9kZUZvbnRDc3M6IGZ1bmN0aW9uIHNldE5vZGVGb250Q3NzKHNldHRpbmcsIHRyZWVOb2RlKSB7CiAgICAgIHZhciBhT2JqID0gJCQodHJlZU5vZGUsIGNvbnN0cy5pZC5BLCBzZXR0aW5nKSwKICAgICAgICAgIGZvbnRDc3MgPSB2aWV3Lm1ha2VOb2RlRm9udENzcyhzZXR0aW5nLCB0cmVlTm9kZSk7CgogICAgICBpZiAoZm9udENzcykgewogICAgICAgIGFPYmouY3NzKGZvbnRDc3MpOwogICAgICB9CiAgICB9LAogICAgc2V0Tm9kZUNsYXNzZXM6IGZ1bmN0aW9uIHNldE5vZGVDbGFzc2VzKHNldHRpbmcsIHRyZWVOb2RlKSB7CiAgICAgIHZhciBhT2JqID0gJCQodHJlZU5vZGUsIGNvbnN0cy5pZC5BLCBzZXR0aW5nKSwKICAgICAgICAgIGNsYXNzZXMgPSB2aWV3Lm1ha2VOb2RlQ2xhc3NlcyhzZXR0aW5nLCB0cmVlTm9kZSk7CgogICAgICBpZiAoJ2FkZCcgaW4gY2xhc3NlcyAmJiBjbGFzc2VzLmFkZC5sZW5ndGgpIHsKICAgICAgICBhT2JqLmFkZENsYXNzKGNsYXNzZXMuYWRkLmpvaW4oJyAnKSk7CiAgICAgIH0KCiAgICAgIGlmICgncmVtb3ZlJyBpbiBjbGFzc2VzICYmIGNsYXNzZXMucmVtb3ZlLmxlbmd0aCkgewogICAgICAgIGFPYmoucmVtb3ZlQ2xhc3MoY2xhc3Nlcy5yZW1vdmUuam9pbignICcpKTsKICAgICAgfQogICAgfSwKICAgIHNldE5vZGVMaW5lSWNvczogZnVuY3Rpb24gc2V0Tm9kZUxpbmVJY29zKHNldHRpbmcsIG5vZGUpIHsKICAgICAgaWYgKCFub2RlKSByZXR1cm47CiAgICAgIHZhciBzd2l0Y2hPYmogPSAkJChub2RlLCBjb25zdHMuaWQuU1dJVENILCBzZXR0aW5nKSwKICAgICAgICAgIHVsT2JqID0gJCQobm9kZSwgY29uc3RzLmlkLlVMLCBzZXR0aW5nKSwKICAgICAgICAgIGljb09iaiA9ICQkKG5vZGUsIGNvbnN0cy5pZC5JQ09OLCBzZXR0aW5nKSwKICAgICAgICAgIHVsTGluZSA9IHZpZXcubWFrZVVsTGluZUNsYXNzKHNldHRpbmcsIG5vZGUpOwoKICAgICAgaWYgKHVsTGluZS5sZW5ndGggPT0gMCkgewogICAgICAgIHVsT2JqLnJlbW92ZUNsYXNzKGNvbnN0cy5saW5lLkxJTkUpOwogICAgICB9IGVsc2UgewogICAgICAgIHVsT2JqLmFkZENsYXNzKHVsTGluZSk7CiAgICAgIH0KCiAgICAgIHN3aXRjaE9iai5hdHRyKCJjbGFzcyIsIHZpZXcubWFrZU5vZGVMaW5lQ2xhc3Moc2V0dGluZywgbm9kZSkpOwoKICAgICAgaWYgKGRhdGEubm9kZUlzUGFyZW50KHNldHRpbmcsIG5vZGUpKSB7CiAgICAgICAgc3dpdGNoT2JqLnJlbW92ZUF0dHIoImRpc2FibGVkIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dpdGNoT2JqLmF0dHIoImRpc2FibGVkIiwgImRpc2FibGVkIik7CiAgICAgIH0KCiAgICAgIGljb09iai5yZW1vdmVBdHRyKCJzdHlsZSIpOwogICAgICBpY29PYmouYXR0cigic3R5bGUiLCB2aWV3Lm1ha2VOb2RlSWNvU3R5bGUoc2V0dGluZywgbm9kZSkpOwogICAgICBpY29PYmouYXR0cigiY2xhc3MiLCB2aWV3Lm1ha2VOb2RlSWNvQ2xhc3Moc2V0dGluZywgbm9kZSkpOwogICAgfSwKICAgIHNldE5vZGVOYW1lOiBmdW5jdGlvbiBzZXROb2RlTmFtZShzZXR0aW5nLCBub2RlKSB7CiAgICAgIHZhciB0aXRsZSA9IGRhdGEubm9kZVRpdGxlKHNldHRpbmcsIG5vZGUpLAogICAgICAgICAgbk9iaiA9ICQkKG5vZGUsIGNvbnN0cy5pZC5TUEFOLCBzZXR0aW5nKTsKICAgICAgbk9iai5lbXB0eSgpOwoKICAgICAgaWYgKHNldHRpbmcudmlldy5uYW1lSXNIVE1MKSB7CiAgICAgICAgbk9iai5odG1sKGRhdGEubm9kZU5hbWUoc2V0dGluZywgbm9kZSkpOwogICAgICB9IGVsc2UgewogICAgICAgIG5PYmoudGV4dChkYXRhLm5vZGVOYW1lKHNldHRpbmcsIG5vZGUpKTsKICAgICAgfQoKICAgICAgaWYgKHRvb2xzLmFwcGx5KHNldHRpbmcudmlldy5zaG93VGl0bGUsIFtzZXR0aW5nLnRyZWVJZCwgbm9kZV0sIHNldHRpbmcudmlldy5zaG93VGl0bGUpKSB7CiAgICAgICAgdmFyIGFPYmogPSAkJChub2RlLCBjb25zdHMuaWQuQSwgc2V0dGluZyk7CiAgICAgICAgYU9iai5hdHRyKCJ0aXRsZSIsICF0aXRsZSA/ICIiIDogdGl0bGUpOwogICAgICB9CiAgICB9LAogICAgc2V0Tm9kZVRhcmdldDogZnVuY3Rpb24gc2V0Tm9kZVRhcmdldChzZXR0aW5nLCBub2RlKSB7CiAgICAgIHZhciBhT2JqID0gJCQobm9kZSwgY29uc3RzLmlkLkEsIHNldHRpbmcpOwogICAgICBhT2JqLmF0dHIoInRhcmdldCIsIHZpZXcubWFrZU5vZGVUYXJnZXQobm9kZSkpOwogICAgfSwKICAgIHNldE5vZGVVcmw6IGZ1bmN0aW9uIHNldE5vZGVVcmwoc2V0dGluZywgbm9kZSkgewogICAgICB2YXIgYU9iaiA9ICQkKG5vZGUsIGNvbnN0cy5pZC5BLCBzZXR0aW5nKSwKICAgICAgICAgIHVybCA9IHZpZXcubWFrZU5vZGVVcmwoc2V0dGluZywgbm9kZSk7CgogICAgICBpZiAodXJsID09IG51bGwgfHwgdXJsLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgYU9iai5yZW1vdmVBdHRyKCJocmVmIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYU9iai5hdHRyKCJocmVmIiwgdXJsKTsKICAgICAgfQogICAgfSwKICAgIHN3aXRjaE5vZGU6IGZ1bmN0aW9uIHN3aXRjaE5vZGUoc2V0dGluZywgbm9kZSkgewogICAgICBpZiAobm9kZS5vcGVuIHx8ICF0b29scy5jYW5Bc3luYyhzZXR0aW5nLCBub2RlKSkgewogICAgICAgIHZpZXcuZXhwYW5kQ29sbGFwc2VOb2RlKHNldHRpbmcsIG5vZGUsICFub2RlLm9wZW4pOwogICAgICB9IGVsc2UgaWYgKHNldHRpbmcuYXN5bmMuZW5hYmxlKSB7CiAgICAgICAgaWYgKCF2aWV3LmFzeW5jTm9kZShzZXR0aW5nLCBub2RlKSkgewogICAgICAgICAgdmlldy5leHBhbmRDb2xsYXBzZU5vZGUoc2V0dGluZywgbm9kZSwgIW5vZGUub3Blbik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG5vZGUpIHsKICAgICAgICB2aWV3LmV4cGFuZENvbGxhcHNlTm9kZShzZXR0aW5nLCBub2RlLCAhbm9kZS5vcGVuKTsKICAgICAgfQogICAgfQogIH07IC8vIHpUcmVlIGRlZmluZAoKCiAgXyQuZm4uelRyZWUgPSB7CiAgICBjb25zdHM6IF9jb25zdHMsCiAgICBfejogewogICAgICB0b29sczogdG9vbHMsCiAgICAgIHZpZXc6IHZpZXcsCiAgICAgIGV2ZW50OiBldmVudCwKICAgICAgZGF0YTogZGF0YQogICAgfSwKICAgIGdldFpUcmVlT2JqOiBmdW5jdGlvbiBnZXRaVHJlZU9iaih0cmVlSWQpIHsKICAgICAgdmFyIG8gPSBkYXRhLmdldFpUcmVlVG9vbHModHJlZUlkKTsKICAgICAgcmV0dXJuIG8gPyBvIDogbnVsbDsKICAgIH0sCiAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KHRyZWVJZCkgewogICAgICBpZiAoISF0cmVlSWQgJiYgdHJlZUlkLmxlbmd0aCA+IDApIHsKICAgICAgICB2aWV3LmRlc3Ryb3koZGF0YS5nZXRTZXR0aW5nKHRyZWVJZCkpOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAodmFyIHMgaW4gc2V0dGluZ3MpIHsKICAgICAgICAgIHZpZXcuZGVzdHJveShzZXR0aW5nc1tzXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaW5pdDogZnVuY3Rpb24gaW5pdChvYmosIHpTZXR0aW5nLCB6Tm9kZXMpIHsKICAgICAgdmFyIHNldHRpbmcgPSB0b29scy5jbG9uZShfc2V0dGluZyk7CgogICAgICBfJC5leHRlbmQodHJ1ZSwgc2V0dGluZywgelNldHRpbmcpOwoKICAgICAgc2V0dGluZy50cmVlSWQgPSBvYmouYXR0cigiaWQiKTsKICAgICAgc2V0dGluZy50cmVlT2JqID0gb2JqOwogICAgICBzZXR0aW5nLnRyZWVPYmouZW1wdHkoKTsKICAgICAgc2V0dGluZ3Nbc2V0dGluZy50cmVlSWRdID0gc2V0dGluZzsgLy9Gb3Igc29tZSBvbGRlciBicm93c2VyLChlLmcuLCBpZTYpCgogICAgICBpZiAodHlwZW9mIGRvY3VtZW50LmJvZHkuc3R5bGUubWF4SGVpZ2h0ID09PSAidW5kZWZpbmVkIikgewogICAgICAgIHNldHRpbmcudmlldy5leHBhbmRTcGVlZCA9ICIiOwogICAgICB9CgogICAgICBkYXRhLmluaXRSb290KHNldHRpbmcpOwogICAgICB2YXIgcm9vdCA9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKTsKICAgICAgek5vZGVzID0gek5vZGVzID8gdG9vbHMuY2xvbmUodG9vbHMuaXNBcnJheSh6Tm9kZXMpID8gek5vZGVzIDogW3pOb2Rlc10pIDogW107CgogICAgICBpZiAoc2V0dGluZy5kYXRhLnNpbXBsZURhdGEuZW5hYmxlKSB7CiAgICAgICAgZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcm9vdCwgZGF0YS50cmFuc2Zvcm1Ub3pUcmVlRm9ybWF0KHNldHRpbmcsIHpOb2RlcykpOwogICAgICB9IGVsc2UgewogICAgICAgIGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIHJvb3QsIHpOb2Rlcyk7CiAgICAgIH0KCiAgICAgIGRhdGEuaW5pdENhY2hlKHNldHRpbmcpOwogICAgICBldmVudC51bmJpbmRUcmVlKHNldHRpbmcpOwogICAgICBldmVudC5iaW5kVHJlZShzZXR0aW5nKTsKICAgICAgZXZlbnQudW5iaW5kRXZlbnQoc2V0dGluZyk7CiAgICAgIGV2ZW50LmJpbmRFdmVudChzZXR0aW5nKTsKICAgICAgdmFyIHpUcmVlVG9vbHMgPSB7CiAgICAgICAgc2V0dGluZzogc2V0dGluZywKICAgICAgICBhZGROb2RlczogZnVuY3Rpb24gYWRkTm9kZXMocGFyZW50Tm9kZSwgaW5kZXgsIG5ld05vZGVzLCBpc1NpbGVudCkgewogICAgICAgICAgaWYgKCFwYXJlbnROb2RlKSBwYXJlbnROb2RlID0gbnVsbDsKICAgICAgICAgIHZhciBpc1BhcmVudCA9IGRhdGEubm9kZUlzUGFyZW50KHNldHRpbmcsIHBhcmVudE5vZGUpOwogICAgICAgICAgaWYgKHBhcmVudE5vZGUgJiYgIWlzUGFyZW50ICYmIHNldHRpbmcuZGF0YS5rZWVwLmxlYWYpIHJldHVybiBudWxsOwogICAgICAgICAgdmFyIGkgPSBwYXJzZUludChpbmRleCwgMTApOwoKICAgICAgICAgIGlmIChpc05hTihpKSkgewogICAgICAgICAgICBpc1NpbGVudCA9ICEhbmV3Tm9kZXM7CiAgICAgICAgICAgIG5ld05vZGVzID0gaW5kZXg7CiAgICAgICAgICAgIGluZGV4ID0gLTE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpbmRleCA9IGk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFuZXdOb2RlcykgcmV0dXJuIG51bGw7CiAgICAgICAgICB2YXIgeE5ld05vZGVzID0gdG9vbHMuY2xvbmUodG9vbHMuaXNBcnJheShuZXdOb2RlcykgPyBuZXdOb2RlcyA6IFtuZXdOb2Rlc10pOwoKICAgICAgICAgIGZ1bmN0aW9uIGFkZENhbGxiYWNrKCkgewogICAgICAgICAgICB2aWV3LmFkZE5vZGVzKHNldHRpbmcsIHBhcmVudE5vZGUsIGluZGV4LCB4TmV3Tm9kZXMsIGlzU2lsZW50ID09IHRydWUpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0b29scy5jYW5Bc3luYyhzZXR0aW5nLCBwYXJlbnROb2RlKSkgewogICAgICAgICAgICB2aWV3LmFzeW5jTm9kZShzZXR0aW5nLCBwYXJlbnROb2RlLCBpc1NpbGVudCwgYWRkQ2FsbGJhY2spOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWRkQ2FsbGJhY2soKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4geE5ld05vZGVzOwogICAgICAgIH0sCiAgICAgICAgY2FuY2VsU2VsZWN0ZWROb2RlOiBmdW5jdGlvbiBjYW5jZWxTZWxlY3RlZE5vZGUobm9kZSkgewogICAgICAgICAgdmlldy5jYW5jZWxQcmVTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSk7CiAgICAgICAgfSwKICAgICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICAgICAgdmlldy5kZXN0cm95KHNldHRpbmcpOwogICAgICAgIH0sCiAgICAgICAgZXhwYW5kQWxsOiBmdW5jdGlvbiBleHBhbmRBbGwoZXhwYW5kRmxhZykgewogICAgICAgICAgZXhwYW5kRmxhZyA9ICEhZXhwYW5kRmxhZzsKICAgICAgICAgIHZpZXcuZXhwYW5kQ29sbGFwc2VTb25Ob2RlKHNldHRpbmcsIG51bGwsIGV4cGFuZEZsYWcsIHRydWUpOwogICAgICAgICAgcmV0dXJuIGV4cGFuZEZsYWc7CiAgICAgICAgfSwKICAgICAgICBleHBhbmROb2RlOiBmdW5jdGlvbiBleHBhbmROb2RlKG5vZGUsIGV4cGFuZEZsYWcsIHNvblNpZ24sIGZvY3VzLCBjYWxsYmFja0ZsYWcpIHsKICAgICAgICAgIGlmICghbm9kZSB8fCAhZGF0YS5ub2RlSXNQYXJlbnQoc2V0dGluZywgbm9kZSkpIHJldHVybiBudWxsOwoKICAgICAgICAgIGlmIChleHBhbmRGbGFnICE9PSB0cnVlICYmIGV4cGFuZEZsYWcgIT09IGZhbHNlKSB7CiAgICAgICAgICAgIGV4cGFuZEZsYWcgPSAhbm9kZS5vcGVuOwogICAgICAgICAgfQoKICAgICAgICAgIGNhbGxiYWNrRmxhZyA9ICEhY2FsbGJhY2tGbGFnOwoKICAgICAgICAgIGlmIChjYWxsYmFja0ZsYWcgJiYgZXhwYW5kRmxhZyAmJiB0b29scy5hcHBseShzZXR0aW5nLmNhbGxiYWNrLmJlZm9yZUV4cGFuZCwgW3NldHRpbmcudHJlZUlkLCBub2RlXSwgdHJ1ZSkgPT0gZmFsc2UpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9IGVsc2UgaWYgKGNhbGxiYWNrRmxhZyAmJiAhZXhwYW5kRmxhZyAmJiB0b29scy5hcHBseShzZXR0aW5nLmNhbGxiYWNrLmJlZm9yZUNvbGxhcHNlLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdLCB0cnVlKSA9PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZXhwYW5kRmxhZyAmJiBub2RlLnBhcmVudFRJZCkgewogICAgICAgICAgICB2aWV3LmV4cGFuZENvbGxhcHNlUGFyZW50Tm9kZShzZXR0aW5nLCBub2RlLmdldFBhcmVudE5vZGUoKSwgZXhwYW5kRmxhZywgZmFsc2UpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChleHBhbmRGbGFnID09PSBub2RlLm9wZW4gJiYgIXNvblNpZ24pIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgZGF0YS5nZXRSb290KHNldHRpbmcpLmV4cGFuZFRyaWdnZXJGbGFnID0gY2FsbGJhY2tGbGFnOwoKICAgICAgICAgIGlmICghdG9vbHMuY2FuQXN5bmMoc2V0dGluZywgbm9kZSkgJiYgc29uU2lnbikgewogICAgICAgICAgICB2aWV3LmV4cGFuZENvbGxhcHNlU29uTm9kZShzZXR0aW5nLCBub2RlLCBleHBhbmRGbGFnLCB0cnVlLCBzaG93Tm9kZUZvY3VzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5vZGUub3BlbiA9ICFleHBhbmRGbGFnOwogICAgICAgICAgICB2aWV3LnN3aXRjaE5vZGUodGhpcy5zZXR0aW5nLCBub2RlKTsKICAgICAgICAgICAgc2hvd05vZGVGb2N1cygpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBleHBhbmRGbGFnOwoKICAgICAgICAgIGZ1bmN0aW9uIHNob3dOb2RlRm9jdXMoKSB7CiAgICAgICAgICAgIHZhciBhID0gJCQobm9kZSwgc2V0dGluZykuZ2V0KDApOwoKICAgICAgICAgICAgaWYgKGEgJiYgZm9jdXMgIT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgdmlldy5zY3JvbGxJbnRvVmlldyhzZXR0aW5nLCBhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZ2V0Tm9kZXM6IGZ1bmN0aW9uIGdldE5vZGVzKCkgewogICAgICAgICAgcmV0dXJuIGRhdGEuZ2V0Tm9kZXMoc2V0dGluZyk7CiAgICAgICAgfSwKICAgICAgICBnZXROb2RlQnlQYXJhbTogZnVuY3Rpb24gZ2V0Tm9kZUJ5UGFyYW0oa2V5LCB2YWx1ZSwgcGFyZW50Tm9kZSkgewogICAgICAgICAgaWYgKCFrZXkpIHJldHVybiBudWxsOwogICAgICAgICAgcmV0dXJuIGRhdGEuZ2V0Tm9kZUJ5UGFyYW0oc2V0dGluZywgcGFyZW50Tm9kZSA/IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIHBhcmVudE5vZGUpIDogZGF0YS5nZXROb2RlcyhzZXR0aW5nKSwga2V5LCB2YWx1ZSk7CiAgICAgICAgfSwKICAgICAgICBnZXROb2RlQnlUSWQ6IGZ1bmN0aW9uIGdldE5vZGVCeVRJZCh0SWQpIHsKICAgICAgICAgIHJldHVybiBkYXRhLmdldE5vZGVDYWNoZShzZXR0aW5nLCB0SWQpOwogICAgICAgIH0sCiAgICAgICAgZ2V0Tm9kZXNCeVBhcmFtOiBmdW5jdGlvbiBnZXROb2Rlc0J5UGFyYW0oa2V5LCB2YWx1ZSwgcGFyZW50Tm9kZSkgewogICAgICAgICAgaWYgKCFrZXkpIHJldHVybiBudWxsOwogICAgICAgICAgcmV0dXJuIGRhdGEuZ2V0Tm9kZXNCeVBhcmFtKHNldHRpbmcsIHBhcmVudE5vZGUgPyBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKSA6IGRhdGEuZ2V0Tm9kZXMoc2V0dGluZyksIGtleSwgdmFsdWUpOwogICAgICAgIH0sCiAgICAgICAgZ2V0Tm9kZXNCeVBhcmFtRnV6enk6IGZ1bmN0aW9uIGdldE5vZGVzQnlQYXJhbUZ1enp5KGtleSwgdmFsdWUsIHBhcmVudE5vZGUpIHsKICAgICAgICAgIGlmICgha2V5KSByZXR1cm4gbnVsbDsKICAgICAgICAgIHJldHVybiBkYXRhLmdldE5vZGVzQnlQYXJhbUZ1enp5KHNldHRpbmcsIHBhcmVudE5vZGUgPyBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKSA6IGRhdGEuZ2V0Tm9kZXMoc2V0dGluZyksIGtleSwgdmFsdWUpOwogICAgICAgIH0sCiAgICAgICAgZ2V0Tm9kZXNCeUZpbHRlcjogZnVuY3Rpb24gZ2V0Tm9kZXNCeUZpbHRlcihmaWx0ZXIsIGlzU2luZ2xlLCBwYXJlbnROb2RlLCBpbnZva2VQYXJhbSkgewogICAgICAgICAgaXNTaW5nbGUgPSAhIWlzU2luZ2xlOwogICAgICAgICAgaWYgKCFmaWx0ZXIgfHwgdHlwZW9mIGZpbHRlciAhPSAiZnVuY3Rpb24iKSByZXR1cm4gaXNTaW5nbGUgPyBudWxsIDogW107CiAgICAgICAgICByZXR1cm4gZGF0YS5nZXROb2Rlc0J5RmlsdGVyKHNldHRpbmcsIHBhcmVudE5vZGUgPyBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKSA6IGRhdGEuZ2V0Tm9kZXMoc2V0dGluZyksIGZpbHRlciwgaXNTaW5nbGUsIGludm9rZVBhcmFtKTsKICAgICAgICB9LAogICAgICAgIGdldE5vZGVJbmRleDogZnVuY3Rpb24gZ2V0Tm9kZUluZGV4KG5vZGUpIHsKICAgICAgICAgIGlmICghbm9kZSkgcmV0dXJuIG51bGw7CiAgICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50VElkID8gbm9kZS5nZXRQYXJlbnROb2RlKCkgOiBkYXRhLmdldFJvb3Qoc2V0dGluZyk7CiAgICAgICAgICB2YXIgY2hpbGRyZW4gPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCBwYXJlbnROb2RlKTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICBpZiAoY2hpbGRyZW5baV0gPT0gbm9kZSkgcmV0dXJuIGk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0sCiAgICAgICAgZ2V0U2VsZWN0ZWROb2RlczogZnVuY3Rpb24gZ2V0U2VsZWN0ZWROb2RlcygpIHsKICAgICAgICAgIHZhciByID0gW10sCiAgICAgICAgICAgICAgbGlzdCA9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKS5jdXJTZWxlY3RlZExpc3Q7CgogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBsaXN0Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICByLnB1c2gobGlzdFtpXSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgfSwKICAgICAgICBpc1NlbGVjdGVkTm9kZTogZnVuY3Rpb24gaXNTZWxlY3RlZE5vZGUobm9kZSkgewogICAgICAgICAgcmV0dXJuIGRhdGEuaXNTZWxlY3RlZE5vZGUoc2V0dGluZywgbm9kZSk7CiAgICAgICAgfSwKICAgICAgICByZUFzeW5jQ2hpbGROb2Rlc1Byb21pc2U6IGZ1bmN0aW9uIHJlQXN5bmNDaGlsZE5vZGVzUHJvbWlzZShwYXJlbnROb2RlLCByZWxvYWRUeXBlLCBpc1NpbGVudCkgewogICAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgelRyZWVUb29scy5yZUFzeW5jQ2hpbGROb2RlcyhwYXJlbnROb2RlLCByZWxvYWRUeXBlLCBpc1NpbGVudCwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmVzb2x2ZShwYXJlbnROb2RlKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICB9LAogICAgICAgIHJlQXN5bmNDaGlsZE5vZGVzOiBmdW5jdGlvbiByZUFzeW5jQ2hpbGROb2RlcyhwYXJlbnROb2RlLCByZWxvYWRUeXBlLCBpc1NpbGVudCwgY2FsbGJhY2spIHsKICAgICAgICAgIGlmICghdGhpcy5zZXR0aW5nLmFzeW5jLmVuYWJsZSkgcmV0dXJuOwogICAgICAgICAgdmFyIGlzUm9vdCA9ICFwYXJlbnROb2RlOwoKICAgICAgICAgIGlmIChpc1Jvb3QpIHsKICAgICAgICAgICAgcGFyZW50Tm9kZSA9IGRhdGEuZ2V0Um9vdChzZXR0aW5nKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocmVsb2FkVHlwZSA9PSAicmVmcmVzaCIpIHsKICAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcGFyZW50Tm9kZSk7CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoaWxkcmVuID8gY2hpbGRyZW4ubGVuZ3RoIDogMDsgaSA8IGw7IGkrKykgewogICAgICAgICAgICAgIGRhdGEucmVtb3ZlTm9kZUNhY2hlKHNldHRpbmcsIGNoaWxkcmVuW2ldKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGF0YS5yZW1vdmVTZWxlY3RlZE5vZGUoc2V0dGluZyk7CiAgICAgICAgICAgIGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIHBhcmVudE5vZGUsIFtdKTsKCiAgICAgICAgICAgIGlmIChpc1Jvb3QpIHsKICAgICAgICAgICAgICB0aGlzLnNldHRpbmcudHJlZU9iai5lbXB0eSgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciB1bE9iaiA9ICQkKHBhcmVudE5vZGUsIGNvbnN0cy5pZC5VTCwgc2V0dGluZyk7CiAgICAgICAgICAgICAgdWxPYmouZW1wdHkoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZpZXcuYXN5bmNOb2RlKHRoaXMuc2V0dGluZywgaXNSb290ID8gbnVsbCA6IHBhcmVudE5vZGUsICEhaXNTaWxlbnQsIGNhbGxiYWNrKTsKICAgICAgICB9LAogICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uIHJlZnJlc2goKSB7CiAgICAgICAgICB0aGlzLnNldHRpbmcudHJlZU9iai5lbXB0eSgpOwogICAgICAgICAgdmFyIHJvb3QgPSBkYXRhLmdldFJvb3Qoc2V0dGluZyksCiAgICAgICAgICAgICAgbm9kZXMgPSBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCByb290KTsKICAgICAgICAgIGRhdGEuaW5pdFJvb3Qoc2V0dGluZyk7CiAgICAgICAgICBkYXRhLm5vZGVDaGlsZHJlbihzZXR0aW5nLCByb290LCBub2Rlcyk7CiAgICAgICAgICBkYXRhLmluaXRDYWNoZShzZXR0aW5nKTsKICAgICAgICAgIHZpZXcuY3JlYXRlTm9kZXMoc2V0dGluZywgMCwgZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcm9vdCksIG51bGwsIC0xKTsKICAgICAgICB9LAogICAgICAgIHJlbW92ZUNoaWxkTm9kZXM6IGZ1bmN0aW9uIHJlbW92ZUNoaWxkTm9kZXMobm9kZSkgewogICAgICAgICAgaWYgKCFub2RlKSByZXR1cm4gbnVsbDsKICAgICAgICAgIHZhciBub2RlcyA9IGRhdGEubm9kZUNoaWxkcmVuKHNldHRpbmcsIG5vZGUpOwogICAgICAgICAgdmlldy5yZW1vdmVDaGlsZE5vZGVzKHNldHRpbmcsIG5vZGUpOwogICAgICAgICAgcmV0dXJuIG5vZGVzID8gbm9kZXMgOiBudWxsOwogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlTm9kZTogZnVuY3Rpb24gcmVtb3ZlTm9kZShub2RlLCBjYWxsYmFja0ZsYWcpIHsKICAgICAgICAgIGlmICghbm9kZSkgcmV0dXJuOwogICAgICAgICAgY2FsbGJhY2tGbGFnID0gISFjYWxsYmFja0ZsYWc7CiAgICAgICAgICBpZiAoY2FsbGJhY2tGbGFnICYmIHRvb2xzLmFwcGx5KHNldHRpbmcuY2FsbGJhY2suYmVmb3JlUmVtb3ZlLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdLCB0cnVlKSA9PSBmYWxzZSkgcmV0dXJuOwogICAgICAgICAgdmlldy5yZW1vdmVOb2RlKHNldHRpbmcsIG5vZGUpOwoKICAgICAgICAgIGlmIChjYWxsYmFja0ZsYWcpIHsKICAgICAgICAgICAgdGhpcy5zZXR0aW5nLnRyZWVPYmoudHJpZ2dlcihjb25zdHMuZXZlbnQuUkVNT1ZFLCBbc2V0dGluZy50cmVlSWQsIG5vZGVdKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNlbGVjdE5vZGU6IGZ1bmN0aW9uIHNlbGVjdE5vZGUobm9kZSwgYWRkRmxhZywgaXNTaWxlbnQpIHsKICAgICAgICAgIGlmICghbm9kZSkgcmV0dXJuOwoKICAgICAgICAgIGlmICh0b29scy51Q2FuRG8oc2V0dGluZykpIHsKICAgICAgICAgICAgYWRkRmxhZyA9IHNldHRpbmcudmlldy5zZWxlY3RlZE11bHRpICYmIGFkZEZsYWc7CgogICAgICAgICAgICBpZiAobm9kZS5wYXJlbnRUSWQpIHsKICAgICAgICAgICAgICB2aWV3LmV4cGFuZENvbGxhcHNlUGFyZW50Tm9kZShzZXR0aW5nLCBub2RlLmdldFBhcmVudE5vZGUoKSwgdHJ1ZSwgZmFsc2UsIHNob3dOb2RlRm9jdXMpOwogICAgICAgICAgICB9IGVsc2UgaWYgKCFpc1NpbGVudCkgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAkJChub2RlLCBzZXR0aW5nKS5mb2N1cygpLmJsdXIoKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgICAgICB9CgogICAgICAgICAgICB2aWV3LnNlbGVjdE5vZGUoc2V0dGluZywgbm9kZSwgYWRkRmxhZyk7CiAgICAgICAgICB9CgogICAgICAgICAgZnVuY3Rpb24gc2hvd05vZGVGb2N1cygpIHsKICAgICAgICAgICAgaWYgKGlzU2lsZW50KSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgYSA9ICQkKG5vZGUsIHNldHRpbmcpLmdldCgwKTsKICAgICAgICAgICAgdmlldy5zY3JvbGxJbnRvVmlldyhzZXR0aW5nLCBhKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRyYW5zZm9ybVRvelRyZWVOb2RlczogZnVuY3Rpb24gdHJhbnNmb3JtVG96VHJlZU5vZGVzKHNpbXBsZU5vZGVzKSB7CiAgICAgICAgICByZXR1cm4gZGF0YS50cmFuc2Zvcm1Ub3pUcmVlRm9ybWF0KHNldHRpbmcsIHNpbXBsZU5vZGVzKTsKICAgICAgICB9LAogICAgICAgIHRyYW5zZm9ybVRvQXJyYXk6IGZ1bmN0aW9uIHRyYW5zZm9ybVRvQXJyYXkobm9kZXMpIHsKICAgICAgICAgIHJldHVybiBkYXRhLnRyYW5zZm9ybVRvQXJyYXlGb3JtYXQoc2V0dGluZywgbm9kZXMpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlTm9kZTogZnVuY3Rpb24gdXBkYXRlTm9kZShub2RlLCBjaGVja1R5cGVGbGFnKSB7CiAgICAgICAgICBpZiAoIW5vZGUpIHJldHVybjsKICAgICAgICAgIHZhciBuT2JqID0gJCQobm9kZSwgc2V0dGluZyk7CgogICAgICAgICAgaWYgKG5PYmouZ2V0KDApICYmIHRvb2xzLnVDYW5EbyhzZXR0aW5nKSkgewogICAgICAgICAgICB2aWV3LnNldE5vZGVOYW1lKHNldHRpbmcsIG5vZGUpOwogICAgICAgICAgICB2aWV3LnNldE5vZGVUYXJnZXQoc2V0dGluZywgbm9kZSk7CiAgICAgICAgICAgIHZpZXcuc2V0Tm9kZVVybChzZXR0aW5nLCBub2RlKTsKICAgICAgICAgICAgdmlldy5zZXROb2RlTGluZUljb3Moc2V0dGluZywgbm9kZSk7CiAgICAgICAgICAgIHZpZXcuc2V0Tm9kZUZvbnRDc3Moc2V0dGluZywgbm9kZSk7CiAgICAgICAgICAgIHZpZXcuc2V0Tm9kZUNsYXNzZXMoc2V0dGluZywgbm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgICByb290LnRyZWVUb29scyA9IHpUcmVlVG9vbHM7CiAgICAgIGRhdGEuc2V0WlRyZWVUb29scyhzZXR0aW5nLCB6VHJlZVRvb2xzKTsKICAgICAgdmFyIGNoaWxkcmVuID0gZGF0YS5ub2RlQ2hpbGRyZW4oc2V0dGluZywgcm9vdCk7CgogICAgICBpZiAoY2hpbGRyZW4gJiYgY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgIHZpZXcuY3JlYXRlTm9kZXMoc2V0dGluZywgMCwgY2hpbGRyZW4sIG51bGwsIC0xKTsKICAgICAgfSBlbHNlIGlmIChzZXR0aW5nLmFzeW5jLmVuYWJsZSAmJiBzZXR0aW5nLmFzeW5jLnVybCAmJiBzZXR0aW5nLmFzeW5jLnVybCAhPT0gJycpIHsKICAgICAgICB2aWV3LmFzeW5jTm9kZShzZXR0aW5nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHpUcmVlVG9vbHM7CiAgICB9CiAgfTsKICB2YXIgenQgPSBfJC5mbi56VHJlZSwKICAgICAgJCQgPSB0b29scy4kLAogICAgICBjb25zdHMgPSB6dC5jb25zdHM7Cn0pKGpRdWVyeSk7"},{"version":3,"sources":["/home/hx_ygg/job/hx_logana3.0/web/src/lib/plugin/zTree_v3/js/jquery.ztree.core.js"],"names":["$","settings","roots","caches","_consts","className","BUTTON","LEVEL","ICO_LOADING","SWITCH","NAME","event","NODECREATED","CLICK","EXPAND","COLLAPSE","ASYNC_SUCCESS","ASYNC_ERROR","REMOVE","SELECTED","UNSELECTED","id","A","ICON","SPAN","UL","line","ROOT","ROOTS","CENTER","BOTTOM","NOLINE","LINE","folder","OPEN","CLOSE","DOCU","node","CURSELECTED","_setting","treeId","treeObj","view","addDiyDom","autoCancelSelected","dblClickExpand","expandSpeed","fontCss","nodeClasses","nameIsHTML","selectedMulti","showIcon","showLine","showTitle","txtSelectedEnable","data","key","isParent","children","name","title","url","icon","render","simpleData","enable","idKey","pIdKey","rootPId","keep","parent","leaf","async","contentType","type","dataType","headers","xhrFields","autoParam","otherParam","dataFilter","callback","beforeAsync","beforeClick","beforeDblClick","beforeRightClick","beforeMouseDown","beforeMouseUp","beforeExpand","beforeCollapse","beforeRemove","onAsyncError","onAsyncSuccess","onNodeCreated","onClick","onDblClick","onRightClick","onMouseDown","onMouseUp","onExpand","onCollapse","onRemove","_initRoot","setting","r","getRoot","setRoot","nodeChildren","expandTriggerFlag","curSelectedList","noSelection","createdNodes","zId","_ver","Date","getTime","_initCache","c","getCache","setCache","nodes","doms","_bindEvent","o","consts","bind","tools","apply","srcEvent","clickFlag","msg","XMLHttpRequest","textStatus","errorThrown","treeNode","onSelected","onUnSelected","_unbindEvent","unbind","_eventProxy","target","getSetting","tId","nodeEventType","treeEventType","nodeEventCallback","treeEventCallback","tmp","eqs","tagName","getAttribute","getNodeMainDom","getMDom","attrName","length","getNodeCache","nodeIsParent","handler","onSwitchNode","onClickNode","onZTreeMousedown","onZTreeMouseup","onZTreeDblclick","onZTreeContextmenu","proxyResult","stop","_initNode","level","n","parentNode","isFirstNode","isLastNode","openFlag","parentTId","open","isArray","zAsync","getParentNode","getPreNode","getNextNode","getIndex","getNodeIndex","getPath","getNodePath","isAjaxing","fixPIdKeyValue","_init","proxys","beforeA","afterA","innerBeforeA","innerAfterA","zTreeTools","addNodeCache","getNodeCacheId","substring","lastIndexOf","addAfterA","push","addBeforeA","addInnerAfterA","addInnerBeforeA","addInitBind","bindEvent","addInitUnBind","unbindEvent","addInitCache","initCache","addInitNode","initNode","addInitProxy","initProxy","isFirst","splice","addInitRoot","initRoot","addNodesData","index","params","setNodeLineIcos","concat","addSelectedNode","root","isSelectedNode","addCreatedNode","addZTreeTools","exSetting","s","extend","getAfterA","array","i","j","arguments","getBeforeA","getInnerAfterA","getInnerBeforeA","p","l","getNodeByParam","value","path","getNodes","getNodesByParam","result","getNodesByParamFuzzy","toLowerCase","indexOf","getNodesByFilter","filter","isSingle","invokeParam","tmpResult","getRoots","getSettings","getZTreeTools","treeTools","preNode","nextNode","newChildren","newIsParent","nodeName","newName","rawName","call","nodeTitle","t","rawTitle","removeNodeCache","removeSelectedNode","trigger","cache","setZTreeTools","transformToArrayFormat","_do","_node","transformTozTreeFormat","sNodes","parentKey","tmpMap","bindTree","eventParam","onSelectStart","css","proxy","unbindTree","doProxy","e","results","uCanDo","x","switchNode","ctrlKey","metaKey","cancelPreSelectedNode","selectNode","originalEvent","srcElement","fun","param","defaultValue","zt","canAsync","clone","obj","str1","str2","arr","Object","prototype","toString","isElement","HTMLElement","nodeType","exp","get","ownerDocument","curDom","targetExpr","parentsUntil","isChildOrSelf","dom","parentId","closest","addNodes","newNodes","isSilent","target_switchObj","$$","target_icoObj","target_ulObj","replaceSwitchClass","replaceIcoClass","createNodes","expandCollapseParentNode","appendNodes","initFlag","html","tmpPNode","tmpPChild","childHtml","makeDOMNodeMainBefore","makeDOMNodeLine","makeDOMNodeNameBefore","makeDOMNodeIcon","makeDOMNodeNameAfter","makeUlHtml","join","makeDOMNodeMainAfter","appendParentULDom","nObj","ulObj","remove","append","asyncNode","icoObj","attr","tmpParam","pKey","split","spKey","_tmpV","ajax","JSON","stringify","success","eval","err","error","excludeNode","list","removeClass","createNodeCallback","shift","zTreeHtml","parentObj","nextObj","before","destroy","empty","expandCollapseNode","expandFlag","animateFlag","tmpCb","_callback","switchObj","iconOpen","iconClose","makeNodeIcoStyle","show","slideDown","hide","slideUp","expandCollapseSonNode","treeNodes","selfAnimateSign","nameStr","replace","makeNodeIcoClass","makeNodeLineClass","makeNodeUrl","fontcss","makeNodeFontCss","makeNodeClasses","fontStyle","f","add","click","makeNodeTarget","classes","icoCss","iconSkin","icoStyle","lineClass","makeNodeLineClassEx","urlKey","content","makeUlLineClass","removeChildNodes","tmp_switchObj","tmp_icoObj","scrollIntoView","Element","contRect","getBoundingClientRect","findMeRect","top","bottom","right","left","scrollIntoViewIfNeeded","centerIfNeeded","makeRange","start","coverRange","inner","outer","end","Math","max","min","makePoint","y","translate","dX","dY","absolute","elem","pt","offsetLeft","offsetTop","offsetParent","extent","offsetWidth","offsetHeight","origin","clientLeft","clientTop","scrollLeft","clientWidth","scrollTop","clientHeight","setFirstNode","setLastNode","removeNode","tmp_ulObj","childLength","newLast","tmp_first_switchObj","tmpName","undefined","tmpList","removeAttr","addFlag","addClass","setNodeFontCss","aObj","setNodeClasses","ulLine","setNodeName","text","setNodeTarget","setNodeUrl","fn","zTree","_z","getZTreeObj","init","zSetting","zNodes","document","body","style","maxHeight","parseInt","isNaN","xNewNodes","addCallback","cancelSelectedNode","expandAll","expandNode","sonSign","focus","callbackFlag","showNodeFocus","a","getNodeByTId","getSelectedNodes","reAsyncChildNodesPromise","reloadType","promise","Promise","resolve","reject","reAsyncChildNodes","isRoot","refresh","blur","transformTozTreeNodes","simpleNodes","transformToArray","updateNode","checkTypeFlag","jQuery"],"mappings":"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","sourcesContent":["/*\n * JQuery zTree core\n * v3.5.46\n * http://treejs.cn/\n *\n * Copyright (c) 2010 Hunter.z\n *\n * Licensed same as jquery - MIT License\n * http://www.opensource.org/licenses/mit-license.php\n *\n * Date: 2020-11-21\n */\n\n(function ($) {\n  var settings = {}, roots = {}, caches = {},\n    //default consts of core\n    _consts = {\n      className: {\n        BUTTON: \"button\",\n        LEVEL: \"level\",\n        ICO_LOADING: \"ico_loading\",\n        SWITCH: \"switch\",\n        NAME: 'node_name'\n      },\n      event: {\n        NODECREATED: \"ztree_nodeCreated\",\n        CLICK: \"ztree_click\",\n        EXPAND: \"ztree_expand\",\n        COLLAPSE: \"ztree_collapse\",\n        ASYNC_SUCCESS: \"ztree_async_success\",\n        ASYNC_ERROR: \"ztree_async_error\",\n        REMOVE: \"ztree_remove\",\n        SELECTED: \"ztree_selected\",\n        UNSELECTED: \"ztree_unselected\"\n      },\n      id: {\n        A: \"_a\",\n        ICON: \"_ico\",\n        SPAN: \"_span\",\n        SWITCH: \"_switch\",\n        UL: \"_ul\"\n      },\n      line: {\n        ROOT: \"root\",\n        ROOTS: \"roots\",\n        CENTER: \"center\",\n        BOTTOM: \"bottom\",\n        NOLINE: \"noline\",\n        LINE: \"line\"\n      },\n      folder: {\n        OPEN: \"open\",\n        CLOSE: \"close\",\n        DOCU: \"docu\"\n      },\n      node: {\n        CURSELECTED: \"curSelectedNode\"\n      }\n    },\n    //default setting of core\n    _setting = {\n      treeId: \"\",\n      treeObj: null,\n      view: {\n        addDiyDom: null,\n        autoCancelSelected: true,\n        dblClickExpand: true,\n        expandSpeed: \"fast\",\n        fontCss: {},\n        nodeClasses: {},\n        nameIsHTML: false,\n        selectedMulti: true,\n        showIcon: true,\n        showLine: true,\n        showTitle: true,\n        txtSelectedEnable: false\n      },\n      data: {\n        key: {\n          isParent: \"isParent\",\n          children: \"children\",\n          name: \"name\",\n          title: \"\",\n          url: \"url\",\n          icon: \"icon\"\n        },\n        render: {\n          name: null,\n          title: null,\n        },\n        simpleData: {\n          enable: false,\n          idKey: \"id\",\n          pIdKey: \"pId\",\n          rootPId: null\n        },\n        keep: {\n          parent: false,\n          leaf: false\n        }\n      },\n      async: {\n        enable: false,\n        contentType: \"application/x-www-form-urlencoded\",\n        type: \"post\",\n        dataType: \"text\",\n        headers: {},\n        xhrFields: {},\n        url: \"\",\n        autoParam: [],\n        otherParam: [],\n        dataFilter: null\n      },\n      callback: {\n        beforeAsync: null,\n        beforeClick: null,\n        beforeDblClick: null,\n        beforeRightClick: null,\n        beforeMouseDown: null,\n        beforeMouseUp: null,\n        beforeExpand: null,\n        beforeCollapse: null,\n        beforeRemove: null,\n\n        onAsyncError: null,\n        onAsyncSuccess: null,\n        onNodeCreated: null,\n        onClick: null,\n        onDblClick: null,\n        onRightClick: null,\n        onMouseDown: null,\n        onMouseUp: null,\n        onExpand: null,\n        onCollapse: null,\n        onRemove: null\n      }\n    },\n    //default root of core\n    //zTree use root to save full data\n    _initRoot = function (setting) {\n      var r = data.getRoot(setting);\n      if (!r) {\n        r = {};\n        data.setRoot(setting, r);\n      }\n      data.nodeChildren(setting, r, []);\n      r.expandTriggerFlag = false;\n      r.curSelectedList = [];\n      r.noSelection = true;\n      r.createdNodes = [];\n      r.zId = 0;\n      r._ver = (new Date()).getTime();\n    },\n    //default cache of core\n    _initCache = function (setting) {\n      var c = data.getCache(setting);\n      if (!c) {\n        c = {};\n        data.setCache(setting, c);\n      }\n      c.nodes = [];\n      c.doms = [];\n    },\n    //default bindEvent of core\n    _bindEvent = function (setting) {\n      var o = setting.treeObj,\n        c = consts.event;\n      o.bind(c.NODECREATED, function (event, treeId, node) {\n        tools.apply(setting.callback.onNodeCreated, [event, treeId, node]);\n      });\n\n      o.bind(c.CLICK, function (event, srcEvent, treeId, node, clickFlag) {\n        tools.apply(setting.callback.onClick, [srcEvent, treeId, node, clickFlag]);\n      });\n\n      o.bind(c.EXPAND, function (event, treeId, node) {\n        tools.apply(setting.callback.onExpand, [event, treeId, node]);\n      });\n\n      o.bind(c.COLLAPSE, function (event, treeId, node) {\n        tools.apply(setting.callback.onCollapse, [event, treeId, node]);\n      });\n\n      o.bind(c.ASYNC_SUCCESS, function (event, treeId, node, msg) {\n        tools.apply(setting.callback.onAsyncSuccess, [event, treeId, node, msg]);\n      });\n\n      o.bind(c.ASYNC_ERROR, function (event, treeId, node, XMLHttpRequest, textStatus, errorThrown) {\n        tools.apply(setting.callback.onAsyncError, [event, treeId, node, XMLHttpRequest, textStatus, errorThrown]);\n      });\n\n      o.bind(c.REMOVE, function (event, treeId, treeNode) {\n        tools.apply(setting.callback.onRemove, [event, treeId, treeNode]);\n      });\n\n      o.bind(c.SELECTED, function (event, treeId, node) {\n        tools.apply(setting.callback.onSelected, [treeId, node]);\n      });\n      o.bind(c.UNSELECTED, function (event, treeId, node) {\n        tools.apply(setting.callback.onUnSelected, [treeId, node]);\n      });\n    },\n    _unbindEvent = function (setting) {\n      var o = setting.treeObj,\n        c = consts.event;\n      o.unbind(c.NODECREATED)\n        .unbind(c.CLICK)\n        .unbind(c.EXPAND)\n        .unbind(c.COLLAPSE)\n        .unbind(c.ASYNC_SUCCESS)\n        .unbind(c.ASYNC_ERROR)\n        .unbind(c.REMOVE)\n        .unbind(c.SELECTED)\n        .unbind(c.UNSELECTED);\n    },\n    //default event proxy of core\n    _eventProxy = function (event) {\n      var target = event.target,\n        setting = data.getSetting(event.data.treeId),\n        tId = \"\", node = null,\n        nodeEventType = \"\", treeEventType = \"\",\n        nodeEventCallback = null, treeEventCallback = null,\n        tmp = null;\n\n      if (tools.eqs(event.type, \"mousedown\")) {\n        treeEventType = \"mousedown\";\n      } else if (tools.eqs(event.type, \"mouseup\")) {\n        treeEventType = \"mouseup\";\n      } else if (tools.eqs(event.type, \"contextmenu\")) {\n        treeEventType = \"contextmenu\";\n      } else if (tools.eqs(event.type, \"click\")) {\n        if (tools.eqs(target.tagName, \"span\") && target.getAttribute(\"treeNode\" + consts.id.SWITCH) !== null) {\n          tId = tools.getNodeMainDom(target).id;\n          nodeEventType = \"switchNode\";\n        } else {\n          tmp = tools.getMDom(setting, target, [{tagName: \"a\", attrName: \"treeNode\" + consts.id.A}]);\n          if (tmp) {\n            tId = tools.getNodeMainDom(tmp).id;\n            nodeEventType = \"clickNode\";\n          }\n        }\n      } else if (tools.eqs(event.type, \"dblclick\")) {\n        treeEventType = \"dblclick\";\n        tmp = tools.getMDom(setting, target, [{tagName: \"a\", attrName: \"treeNode\" + consts.id.A}]);\n        if (tmp) {\n          tId = tools.getNodeMainDom(tmp).id;\n          nodeEventType = \"switchNode\";\n        }\n      }\n      if (treeEventType.length > 0 && tId.length == 0) {\n        tmp = tools.getMDom(setting, target, [{tagName: \"a\", attrName: \"treeNode\" + consts.id.A}]);\n        if (tmp) {\n          tId = tools.getNodeMainDom(tmp).id;\n        }\n      }\n      // event to node\n      if (tId.length > 0) {\n        node = data.getNodeCache(setting, tId);\n        switch (nodeEventType) {\n          case \"switchNode\" :\n            var isParent = data.nodeIsParent(setting, node);\n            if (!isParent) {\n              nodeEventType = \"\";\n            } else if (tools.eqs(event.type, \"click\")\n              || (tools.eqs(event.type, \"dblclick\") && tools.apply(setting.view.dblClickExpand, [setting.treeId, node], setting.view.dblClickExpand))) {\n              nodeEventCallback = handler.onSwitchNode;\n            } else {\n              nodeEventType = \"\";\n            }\n            break;\n          case \"clickNode\" :\n            nodeEventCallback = handler.onClickNode;\n            break;\n        }\n      }\n      // event to zTree\n      switch (treeEventType) {\n        case \"mousedown\" :\n          treeEventCallback = handler.onZTreeMousedown;\n          break;\n        case \"mouseup\" :\n          treeEventCallback = handler.onZTreeMouseup;\n          break;\n        case \"dblclick\" :\n          treeEventCallback = handler.onZTreeDblclick;\n          break;\n        case \"contextmenu\" :\n          treeEventCallback = handler.onZTreeContextmenu;\n          break;\n      }\n      var proxyResult = {\n        stop: false,\n        node: node,\n        nodeEventType: nodeEventType,\n        nodeEventCallback: nodeEventCallback,\n        treeEventType: treeEventType,\n        treeEventCallback: treeEventCallback\n      };\n      return proxyResult\n    },\n    //default init node of core\n    _initNode = function (setting, level, n, parentNode, isFirstNode, isLastNode, openFlag) {\n      if (!n) return;\n      var r = data.getRoot(setting),\n        children = data.nodeChildren(setting, n);\n      n.level = level;\n      n.tId = setting.treeId + \"_\" + (++r.zId);\n      n.parentTId = parentNode ? parentNode.tId : null;\n      n.open = (typeof n.open == \"string\") ? tools.eqs(n.open, \"true\") : !!n.open;\n      var isParent = data.nodeIsParent(setting, n);\n      if (tools.isArray(children)) {\n        data.nodeIsParent(setting, n, true);\n        n.zAsync = true;\n      } else {\n        isParent = data.nodeIsParent(setting, n, isParent);\n        n.open = (isParent && !setting.async.enable) ? n.open : false;\n        n.zAsync = !isParent;\n      }\n      n.isFirstNode = isFirstNode;\n      n.isLastNode = isLastNode;\n      n.getParentNode = function () {\n        return data.getNodeCache(setting, n.parentTId);\n      };\n      n.getPreNode = function () {\n        return data.getPreNode(setting, n);\n      };\n      n.getNextNode = function () {\n        return data.getNextNode(setting, n);\n      };\n      n.getIndex = function () {\n        return data.getNodeIndex(setting, n);\n      };\n      n.getPath = function () {\n        return data.getNodePath(setting, n);\n      };\n      n.isAjaxing = false;\n      data.fixPIdKeyValue(setting, n);\n    },\n    _init = {\n      bind: [_bindEvent],\n      unbind: [_unbindEvent],\n      caches: [_initCache],\n      nodes: [_initNode],\n      proxys: [_eventProxy],\n      roots: [_initRoot],\n      beforeA: [],\n      afterA: [],\n      innerBeforeA: [],\n      innerAfterA: [],\n      zTreeTools: []\n    },\n    //method of operate data\n    data = {\n      addNodeCache: function (setting, node) {\n        data.getCache(setting).nodes[data.getNodeCacheId(node.tId)] = node;\n      },\n      getNodeCacheId: function (tId) {\n        return tId.substring(tId.lastIndexOf(\"_\") + 1);\n      },\n      addAfterA: function (afterA) {\n        _init.afterA.push(afterA);\n      },\n      addBeforeA: function (beforeA) {\n        _init.beforeA.push(beforeA);\n      },\n      addInnerAfterA: function (innerAfterA) {\n        _init.innerAfterA.push(innerAfterA);\n      },\n      addInnerBeforeA: function (innerBeforeA) {\n        _init.innerBeforeA.push(innerBeforeA);\n      },\n      addInitBind: function (bindEvent) {\n        _init.bind.push(bindEvent);\n      },\n      addInitUnBind: function (unbindEvent) {\n        _init.unbind.push(unbindEvent);\n      },\n      addInitCache: function (initCache) {\n        _init.caches.push(initCache);\n      },\n      addInitNode: function (initNode) {\n        _init.nodes.push(initNode);\n      },\n      addInitProxy: function (initProxy, isFirst) {\n        if (!!isFirst) {\n          _init.proxys.splice(0, 0, initProxy);\n        } else {\n          _init.proxys.push(initProxy);\n        }\n      },\n      addInitRoot: function (initRoot) {\n        _init.roots.push(initRoot);\n      },\n      addNodesData: function (setting, parentNode, index, nodes) {\n        var children = data.nodeChildren(setting, parentNode), params;\n        if (!children) {\n          children = data.nodeChildren(setting, parentNode, []);\n          index = -1;\n        } else if (index >= children.length) {\n          index = -1;\n        }\n\n        if (children.length > 0 && index === 0) {\n          children[0].isFirstNode = false;\n          view.setNodeLineIcos(setting, children[0]);\n        } else if (children.length > 0 && index < 0) {\n          children[children.length - 1].isLastNode = false;\n          view.setNodeLineIcos(setting, children[children.length - 1]);\n        }\n        data.nodeIsParent(setting, parentNode, true);\n\n        if (index < 0) {\n          data.nodeChildren(setting, parentNode, children.concat(nodes));\n        } else {\n          params = [index, 0].concat(nodes);\n          children.splice.apply(children, params);\n        }\n      },\n      addSelectedNode: function (setting, node) {\n        var root = data.getRoot(setting);\n        if (!data.isSelectedNode(setting, node)) {\n          root.curSelectedList.push(node);\n        }\n      },\n      addCreatedNode: function (setting, node) {\n        if (!!setting.callback.onNodeCreated || !!setting.view.addDiyDom) {\n          var root = data.getRoot(setting);\n          root.createdNodes.push(node);\n        }\n      },\n      addZTreeTools: function (zTreeTools) {\n        _init.zTreeTools.push(zTreeTools);\n      },\n      exSetting: function (s) {\n        $.extend(true, _setting, s);\n      },\n      fixPIdKeyValue: function (setting, node) {\n        if (setting.data.simpleData.enable) {\n          node[setting.data.simpleData.pIdKey] = node.parentTId ? node.getParentNode()[setting.data.simpleData.idKey] : setting.data.simpleData.rootPId;\n        }\n      },\n      getAfterA: function (setting, node, array) {\n        for (var i = 0, j = _init.afterA.length; i < j; i++) {\n          _init.afterA[i].apply(this, arguments);\n        }\n      },\n      getBeforeA: function (setting, node, array) {\n        for (var i = 0, j = _init.beforeA.length; i < j; i++) {\n          _init.beforeA[i].apply(this, arguments);\n        }\n      },\n      getInnerAfterA: function (setting, node, array) {\n        for (var i = 0, j = _init.innerAfterA.length; i < j; i++) {\n          _init.innerAfterA[i].apply(this, arguments);\n        }\n      },\n      getInnerBeforeA: function (setting, node, array) {\n        for (var i = 0, j = _init.innerBeforeA.length; i < j; i++) {\n          _init.innerBeforeA[i].apply(this, arguments);\n        }\n      },\n      getCache: function (setting) {\n        return caches[setting.treeId];\n      },\n      getNodeIndex: function (setting, node) {\n        if (!node) return null;\n        var p = node.parentTId ? node.getParentNode() : data.getRoot(setting),\n          children = data.nodeChildren(setting, p);\n        for (var i = 0, l = children.length - 1; i <= l; i++) {\n          if (children[i] === node) {\n            return i;\n          }\n        }\n        return -1;\n      },\n      getNextNode: function (setting, node) {\n        if (!node) return null;\n        var p = node.parentTId ? node.getParentNode() : data.getRoot(setting),\n          children = data.nodeChildren(setting, p);\n        for (var i = 0, l = children.length - 1; i <= l; i++) {\n          if (children[i] === node) {\n            return (i == l ? null : children[i + 1]);\n          }\n        }\n        return null;\n      },\n      getNodeByParam: function (setting, nodes, key, value) {\n        if (!nodes || !key) return null;\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          var node = nodes[i];\n          if (node[key] == value) {\n            return nodes[i];\n          }\n          var children = data.nodeChildren(setting, node);\n          var tmp = data.getNodeByParam(setting, children, key, value);\n          if (tmp) return tmp;\n        }\n        return null;\n      },\n      getNodeCache: function (setting, tId) {\n        if (!tId) return null;\n        var n = caches[setting.treeId].nodes[data.getNodeCacheId(tId)];\n        return n ? n : null;\n      },\n      getNodePath: function (setting, node) {\n        if (!node) return null;\n\n        var path;\n        if (node.parentTId) {\n          path = node.getParentNode().getPath();\n        } else {\n          path = [];\n        }\n\n        if (path) {\n          path.push(node);\n        }\n\n        return path;\n      },\n      getNodes: function (setting) {\n        return data.nodeChildren(setting, data.getRoot(setting));\n      },\n      getNodesByParam: function (setting, nodes, key, value) {\n        if (!nodes || !key) return [];\n        var result = [];\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          var node = nodes[i];\n          if (node[key] == value) {\n            result.push(node);\n          }\n          var children = data.nodeChildren(setting, node);\n          result = result.concat(data.getNodesByParam(setting, children, key, value));\n        }\n        return result;\n      },\n      getNodesByParamFuzzy: function (setting, nodes, key, value) {\n        if (!nodes || !key) return [];\n        var result = [];\n        value = value.toLowerCase();\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          var node = nodes[i];\n          if (typeof node[key] == \"string\" && nodes[i][key].toLowerCase().indexOf(value) > -1) {\n            result.push(node);\n          }\n          var children = data.nodeChildren(setting, node);\n          result = result.concat(data.getNodesByParamFuzzy(setting, children, key, value));\n        }\n        return result;\n      },\n      getNodesByFilter: function (setting, nodes, filter, isSingle, invokeParam) {\n        if (!nodes) return (isSingle ? null : []);\n        var result = isSingle ? null : [];\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          var node = nodes[i];\n          if (tools.apply(filter, [node, invokeParam], false)) {\n            if (isSingle) {\n              return node;\n            }\n            result.push(node);\n          }\n          var children = data.nodeChildren(setting, node);\n          var tmpResult = data.getNodesByFilter(setting, children, filter, isSingle, invokeParam);\n          if (isSingle && !!tmpResult) {\n            return tmpResult;\n          }\n          result = isSingle ? tmpResult : result.concat(tmpResult);\n        }\n        return result;\n      },\n      getPreNode: function (setting, node) {\n        if (!node) return null;\n        var p = node.parentTId ? node.getParentNode() : data.getRoot(setting),\n          children = data.nodeChildren(setting, p);\n        for (var i = 0, l = children.length; i < l; i++) {\n          if (children[i] === node) {\n            return (i == 0 ? null : children[i - 1]);\n          }\n        }\n        return null;\n      },\n      getRoot: function (setting) {\n        return setting ? roots[setting.treeId] : null;\n      },\n      getRoots: function () {\n        return roots;\n      },\n      getSetting: function (treeId) {\n        return settings[treeId];\n      },\n      getSettings: function () {\n        return settings;\n      },\n      getZTreeTools: function (treeId) {\n        var r = this.getRoot(this.getSetting(treeId));\n        return r ? r.treeTools : null;\n      },\n      initCache: function (setting) {\n        for (var i = 0, j = _init.caches.length; i < j; i++) {\n          _init.caches[i].apply(this, arguments);\n        }\n      },\n      initNode: function (setting, level, node, parentNode, preNode, nextNode) {\n        for (var i = 0, j = _init.nodes.length; i < j; i++) {\n          _init.nodes[i].apply(this, arguments);\n        }\n      },\n      initRoot: function (setting) {\n        for (var i = 0, j = _init.roots.length; i < j; i++) {\n          _init.roots[i].apply(this, arguments);\n        }\n      },\n      isSelectedNode: function (setting, node) {\n        var root = data.getRoot(setting);\n        for (var i = 0, j = root.curSelectedList.length; i < j; i++) {\n          if (node === root.curSelectedList[i]) return true;\n        }\n        return false;\n      },\n      nodeChildren: function (setting, node, newChildren) {\n        if (!node) {\n          return null;\n        }\n        var key = setting.data.key.children;\n        if (typeof newChildren !== 'undefined') {\n          node[key] = newChildren;\n        }\n        return node[key];\n      },\n      nodeIsParent: function (setting, node, newIsParent) {\n        if (!node) {\n          return false;\n        }\n        var key = setting.data.key.isParent;\n        if (typeof newIsParent !== 'undefined') {\n          if (typeof newIsParent === \"string\") {\n            newIsParent = tools.eqs(newIsParent, \"true\");\n          }\n          newIsParent = !!newIsParent;\n          node[key] = newIsParent;\n        } else if (typeof node[key] == \"string\"){\n          node[key] = tools.eqs(node[key], \"true\");\n        } else {\n          node[key] = !!node[key];\n        }\n        return node[key];\n      },\n      nodeName: function (setting, node, newName) {\n        var key = setting.data.key.name;\n        if (typeof newName !== 'undefined') {\n          node[key] = newName;\n        }\n        var rawName = \"\" + node[key];\n        if(typeof setting.data.render.name === 'function') {\n          return setting.data.render.name.call(this,rawName,node);\n        }\n        return rawName;\n      },\n      nodeTitle: function (setting, node) {\n        var t = setting.data.key.title === \"\" ? setting.data.key.name : setting.data.key.title;\n        var rawTitle = \"\" + node[t];\n        if(typeof setting.data.render.title === 'function') {\n          return setting.data.render.title.call(this,rawTitle,node);\n        }\n        return rawTitle;\n      },\n      removeNodeCache: function (setting, node) {\n        var children = data.nodeChildren(setting, node);\n        if (children) {\n          for (var i = 0, l = children.length; i < l; i++) {\n            data.removeNodeCache(setting, children[i]);\n          }\n        }\n        data.getCache(setting).nodes[data.getNodeCacheId(node.tId)] = null;\n      },\n      removeSelectedNode: function (setting, node) {\n        var root = data.getRoot(setting);\n        for (var i = 0, j = root.curSelectedList.length; i < j; i++) {\n          if (node === root.curSelectedList[i] || !data.getNodeCache(setting, root.curSelectedList[i].tId)) {\n            root.curSelectedList.splice(i, 1);\n            setting.treeObj.trigger(consts.event.UNSELECTED, [setting.treeId, node]);\n            i--;\n            j--;\n          }\n        }\n      },\n      setCache: function (setting, cache) {\n        caches[setting.treeId] = cache;\n      },\n      setRoot: function (setting, root) {\n        roots[setting.treeId] = root;\n      },\n      setZTreeTools: function (setting, zTreeTools) {\n        for (var i = 0, j = _init.zTreeTools.length; i < j; i++) {\n          _init.zTreeTools[i].apply(this, arguments);\n        }\n      },\n      transformToArrayFormat: function (setting, nodes) {\n        if (!nodes) return [];\n        var r = [];\n        if (tools.isArray(nodes)) {\n          for (var i = 0, l = nodes.length; i < l; i++) {\n            var node = nodes[i];\n            _do(node);\n          }\n        } else {\n          _do(nodes);\n        }\n        return r;\n\n        function _do(_node) {\n          r.push(_node);\n          var children = data.nodeChildren(setting, _node);\n          if (children) {\n            r = r.concat(data.transformToArrayFormat(setting, children));\n          }\n        }\n      },\n      transformTozTreeFormat: function (setting, sNodes) {\n        var i, l,\n          key = setting.data.simpleData.idKey,\n          parentKey = setting.data.simpleData.pIdKey;\n        if (!key || key == \"\" || !sNodes) return [];\n\n        if (tools.isArray(sNodes)) {\n          var r = [];\n          var tmpMap = {};\n          for (i = 0, l = sNodes.length; i < l; i++) {\n            tmpMap[sNodes[i][key]] = sNodes[i];\n          }\n          for (i = 0, l = sNodes.length; i < l; i++) {\n            var p = tmpMap[sNodes[i][parentKey]];\n            if (p && sNodes[i][key] != sNodes[i][parentKey]) {\n              var children = data.nodeChildren(setting, p);\n              if (!children) {\n                children = data.nodeChildren(setting, p, []);\n              }\n              children.push(sNodes[i]);\n            } else {\n              r.push(sNodes[i]);\n            }\n          }\n          return r;\n        } else {\n          return [sNodes];\n        }\n      }\n    },\n    //method of event proxy\n    event = {\n      bindEvent: function (setting) {\n        for (var i = 0, j = _init.bind.length; i < j; i++) {\n          _init.bind[i].apply(this, arguments);\n        }\n      },\n      unbindEvent: function (setting) {\n        for (var i = 0, j = _init.unbind.length; i < j; i++) {\n          _init.unbind[i].apply(this, arguments);\n        }\n      },\n      bindTree: function (setting) {\n        var eventParam = {\n            treeId: setting.treeId\n          },\n          o = setting.treeObj;\n        if (!setting.view.txtSelectedEnable) {\n          // for can't select text\n          o.bind('selectstart', handler.onSelectStart).css({\n            \"-moz-user-select\": \"-moz-none\"\n          });\n        }\n        o.bind('click', eventParam, event.proxy);\n        o.bind('dblclick', eventParam, event.proxy);\n        o.bind('mouseover', eventParam, event.proxy);\n        o.bind('mouseout', eventParam, event.proxy);\n        o.bind('mousedown', eventParam, event.proxy);\n        o.bind('mouseup', eventParam, event.proxy);\n        o.bind('contextmenu', eventParam, event.proxy);\n      },\n      unbindTree: function (setting) {\n        var o = setting.treeObj;\n        o.unbind('selectstart', handler.onSelectStart)\n          .unbind('click', event.proxy)\n          .unbind('dblclick', event.proxy)\n          .unbind('mouseover', event.proxy)\n          .unbind('mouseout', event.proxy)\n          .unbind('mousedown', event.proxy)\n          .unbind('mouseup', event.proxy)\n          .unbind('contextmenu', event.proxy);\n      },\n      doProxy: function (e) {\n        var results = [];\n        for (var i = 0, j = _init.proxys.length; i < j; i++) {\n          var proxyResult = _init.proxys[i].apply(this, arguments);\n          results.push(proxyResult);\n          if (proxyResult.stop) {\n            break;\n          }\n        }\n        return results;\n      },\n      proxy: function (e) {\n        var setting = data.getSetting(e.data.treeId);\n        if (!tools.uCanDo(setting, e)) return true;\n        var results = event.doProxy(e),\n          r = true, x = false;\n        for (var i = 0, l = results.length; i < l; i++) {\n          var proxyResult = results[i];\n          if (proxyResult.nodeEventCallback) {\n            x = true;\n            r = proxyResult.nodeEventCallback.apply(proxyResult, [e, proxyResult.node]) && r;\n          }\n          if (proxyResult.treeEventCallback) {\n            x = true;\n            r = proxyResult.treeEventCallback.apply(proxyResult, [e, proxyResult.node]) && r;\n          }\n        }\n        return r;\n      }\n    },\n    //method of event handler\n    handler = {\n      onSwitchNode: function (event, node) {\n        var setting = data.getSetting(event.data.treeId);\n        if (node.open) {\n          if (tools.apply(setting.callback.beforeCollapse, [setting.treeId, node], true) == false) return true;\n          data.getRoot(setting).expandTriggerFlag = true;\n          view.switchNode(setting, node);\n        } else {\n          if (tools.apply(setting.callback.beforeExpand, [setting.treeId, node], true) == false) return true;\n          data.getRoot(setting).expandTriggerFlag = true;\n          view.switchNode(setting, node);\n        }\n        return true;\n      },\n      onClickNode: function (event, node) {\n        var setting = data.getSetting(event.data.treeId),\n          clickFlag = ((setting.view.autoCancelSelected && (event.ctrlKey || event.metaKey)) && data.isSelectedNode(setting, node)) ? 0 : (setting.view.autoCancelSelected && (event.ctrlKey || event.metaKey) && setting.view.selectedMulti) ? 2 : 1;\n        if (tools.apply(setting.callback.beforeClick, [setting.treeId, node, clickFlag], true) == false) return true;\n        if (clickFlag === 0) {\n          view.cancelPreSelectedNode(setting, node);\n        } else {\n          view.selectNode(setting, node, clickFlag === 2);\n        }\n        setting.treeObj.trigger(consts.event.CLICK, [event, setting.treeId, node, clickFlag]);\n        return true;\n      },\n      onZTreeMousedown: function (event, node) {\n        var setting = data.getSetting(event.data.treeId);\n        if (tools.apply(setting.callback.beforeMouseDown, [setting.treeId, node], true)) {\n          tools.apply(setting.callback.onMouseDown, [event, setting.treeId, node]);\n        }\n        return true;\n      },\n      onZTreeMouseup: function (event, node) {\n        var setting = data.getSetting(event.data.treeId);\n        if (tools.apply(setting.callback.beforeMouseUp, [setting.treeId, node], true)) {\n          tools.apply(setting.callback.onMouseUp, [event, setting.treeId, node]);\n        }\n        return true;\n      },\n      onZTreeDblclick: function (event, node) {\n        var setting = data.getSetting(event.data.treeId);\n        if (tools.apply(setting.callback.beforeDblClick, [setting.treeId, node], true)) {\n          tools.apply(setting.callback.onDblClick, [event, setting.treeId, node]);\n        }\n        return true;\n      },\n      onZTreeContextmenu: function (event, node) {\n        var setting = data.getSetting(event.data.treeId);\n        if (tools.apply(setting.callback.beforeRightClick, [setting.treeId, node], true)) {\n          tools.apply(setting.callback.onRightClick, [event, setting.treeId, node]);\n        }\n        return (typeof setting.callback.onRightClick) != \"function\";\n      },\n      onSelectStart: function (e) {\n        var n = e.originalEvent.srcElement.nodeName.toLowerCase();\n        return (n === \"input\" || n === \"textarea\");\n      }\n    },\n    //method of tools for zTree\n    tools = {\n      apply: function (fun, param, defaultValue) {\n        if ((typeof fun) == \"function\") {\n          return fun.apply(zt, param ? param : []);\n        }\n        return defaultValue;\n      },\n      canAsync: function (setting, node) {\n        var children = data.nodeChildren(setting, node);\n        var isParent = data.nodeIsParent(setting, node);\n        return (setting.async.enable && node && isParent && !(node.zAsync || (children && children.length > 0)));\n      },\n      clone: function (obj) {\n        if (obj === null) return null;\n        var o = tools.isArray(obj) ? [] : {};\n        for (var i in obj) {\n          o[i] = (obj[i] instanceof Date) ? new Date(obj[i].getTime()) : (typeof obj[i] === \"object\" ? tools.clone(obj[i]) : obj[i]);\n        }\n        return o;\n      },\n      eqs: function (str1, str2) {\n        return str1.toLowerCase() === str2.toLowerCase();\n      },\n      isArray: function (arr) {\n        return Object.prototype.toString.apply(arr) === \"[object Array]\";\n      },\n      isElement: function (o) {\n        return (\n          typeof HTMLElement === \"object\" ? o instanceof HTMLElement : //DOM2\n            o && typeof o === \"object\" && o !== null && o.nodeType === 1 && typeof o.nodeName === \"string\"\n        );\n      },\n      $: function (node, exp, setting) {\n        if (!!exp && typeof exp != \"string\") {\n          setting = exp;\n          exp = \"\";\n        }\n        if (typeof node == \"string\") {\n          return $(node, setting ? setting.treeObj.get(0).ownerDocument : null);\n        } else {\n          return $(\"#\" + node.tId + exp, setting ? setting.treeObj : null);\n        }\n      },\n      getMDom: function (setting, curDom, targetExpr) {\n        if (!curDom) return null;\n        while (curDom && curDom.id !== setting.treeId) {\n          for (var i = 0, l = targetExpr.length; curDom.tagName && i < l; i++) {\n            if (tools.eqs(curDom.tagName, targetExpr[i].tagName) && curDom.getAttribute(targetExpr[i].attrName) !== null) {\n              return curDom;\n            }\n          }\n          curDom = curDom.parentNode;\n        }\n        return null;\n      },\n      getNodeMainDom: function (target) {\n        return ($(target).parent(\"li\").get(0) || $(target).parentsUntil(\"li\").parent().get(0));\n      },\n      isChildOrSelf: function (dom, parentId) {\n        return ($(dom).closest(\"#\" + parentId).length > 0);\n      },\n      uCanDo: function (setting, e) {\n        return true;\n      }\n    },\n    //method of operate ztree dom\n    view = {\n      addNodes: function (setting, parentNode, index, newNodes, isSilent) {\n        var isParent = data.nodeIsParent(setting, parentNode);\n        if (setting.data.keep.leaf && parentNode && !isParent) {\n          return;\n        }\n        if (!tools.isArray(newNodes)) {\n          newNodes = [newNodes];\n        }\n        if (setting.data.simpleData.enable) {\n          newNodes = data.transformTozTreeFormat(setting, newNodes);\n        }\n        if (parentNode) {\n          var target_switchObj = $$(parentNode, consts.id.SWITCH, setting),\n            target_icoObj = $$(parentNode, consts.id.ICON, setting),\n            target_ulObj = $$(parentNode, consts.id.UL, setting);\n\n          if (!parentNode.open) {\n            view.replaceSwitchClass(parentNode, target_switchObj, consts.folder.CLOSE);\n            view.replaceIcoClass(parentNode, target_icoObj, consts.folder.CLOSE);\n            parentNode.open = false;\n            target_ulObj.css({\n              \"display\": \"none\"\n            });\n          }\n\n          data.addNodesData(setting, parentNode, index, newNodes);\n          view.createNodes(setting, parentNode.level + 1, newNodes, parentNode, index);\n          if (!isSilent) {\n            view.expandCollapseParentNode(setting, parentNode, true);\n          }\n        } else {\n          data.addNodesData(setting, data.getRoot(setting), index, newNodes);\n          view.createNodes(setting, 0, newNodes, null, index);\n        }\n      },\n      appendNodes: function (setting, level, nodes, parentNode, index, initFlag, openFlag) {\n        if (!nodes) return [];\n        var html = [];\n\n        var tmpPNode = (parentNode) ? parentNode : data.getRoot(setting),\n          tmpPChild = data.nodeChildren(setting, tmpPNode),\n          isFirstNode, isLastNode;\n\n        if (!tmpPChild || index >= tmpPChild.length - nodes.length) {\n          index = -1;\n        }\n\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          var node = nodes[i];\n          if (initFlag) {\n            isFirstNode = ((index === 0 || tmpPChild.length == nodes.length) && (i == 0));\n            isLastNode = (index < 0 && i == (nodes.length - 1));\n            data.initNode(setting, level, node, parentNode, isFirstNode, isLastNode, openFlag);\n            data.addNodeCache(setting, node);\n          }\n          var isParent = data.nodeIsParent(setting, node);\n\n          var childHtml = [];\n          var children = data.nodeChildren(setting, node);\n          if (children && children.length > 0) {\n            //make child html first, because checkType\n            childHtml = view.appendNodes(setting, level + 1, children, node, -1, initFlag, openFlag && node.open);\n          }\n          if (openFlag) {\n            view.makeDOMNodeMainBefore(html, setting, node);\n            view.makeDOMNodeLine(html, setting, node);\n            data.getBeforeA(setting, node, html);\n            view.makeDOMNodeNameBefore(html, setting, node);\n            data.getInnerBeforeA(setting, node, html);\n            view.makeDOMNodeIcon(html, setting, node);\n            data.getInnerAfterA(setting, node, html);\n            view.makeDOMNodeNameAfter(html, setting, node);\n            data.getAfterA(setting, node, html);\n            if (isParent && node.open) {\n              view.makeUlHtml(setting, node, html, childHtml.join(''));\n            }\n            view.makeDOMNodeMainAfter(html, setting, node);\n            data.addCreatedNode(setting, node);\n          }\n        }\n        return html;\n      },\n      appendParentULDom: function (setting, node) {\n        var html = [],\n          nObj = $$(node, setting);\n        if (!nObj.get(0) && !!node.parentTId) {\n          view.appendParentULDom(setting, node.getParentNode());\n          nObj = $$(node, setting);\n        }\n        var ulObj = $$(node, consts.id.UL, setting);\n        if (ulObj.get(0)) {\n          ulObj.remove();\n        }\n        var children = data.nodeChildren(setting, node),\n          childHtml = view.appendNodes(setting, node.level + 1, children, node, -1, false, true);\n        view.makeUlHtml(setting, node, html, childHtml.join(''));\n        nObj.append(html.join(''));\n      },\n      asyncNode: function (setting, node, isSilent, callback) {\n        var i, l;\n        var isParent = data.nodeIsParent(setting, node);\n        if (node && !isParent) {\n          tools.apply(callback);\n          return false;\n        } else if (node && node.isAjaxing) {\n          return false;\n        } else if (tools.apply(setting.callback.beforeAsync, [setting.treeId, node], true) == false) {\n          tools.apply(callback);\n          return false;\n        }\n        if (node) {\n          node.isAjaxing = true;\n          var icoObj = $$(node, consts.id.ICON, setting);\n          icoObj.attr({\"style\": \"\", \"class\": consts.className.BUTTON + \" \" + consts.className.ICO_LOADING});\n        }\n\n        var tmpParam = {};\n        var autoParam = tools.apply(setting.async.autoParam, [setting.treeId, node], setting.async.autoParam);\n        for (i = 0, l = autoParam.length; node && i < l; i++) {\n          var pKey = autoParam[i].split(\"=\"), spKey = pKey;\n          if (pKey.length > 1) {\n            spKey = pKey[1];\n            pKey = pKey[0];\n          }\n          tmpParam[spKey] = node[pKey];\n        }\n        var otherParam = tools.apply(setting.async.otherParam, [setting.treeId, node], setting.async.otherParam);\n        if (tools.isArray(otherParam)) {\n          for (i = 0, l = otherParam.length; i < l; i += 2) {\n            tmpParam[otherParam[i]] = otherParam[i + 1];\n          }\n        } else {\n          for (var p in otherParam) {\n            tmpParam[p] = otherParam[p];\n          }\n        }\n\n        var _tmpV = data.getRoot(setting)._ver;\n        $.ajax({\n          contentType: setting.async.contentType,\n          cache: false,\n          type: setting.async.type,\n          url: tools.apply(setting.async.url, [setting.treeId, node], setting.async.url),\n          data: setting.async.contentType.indexOf('application/json') > -1 ? JSON.stringify(tmpParam) : tmpParam,\n          dataType: setting.async.dataType,\n          headers: setting.async.headers,\n          xhrFields: setting.async.xhrFields,\n          success: function (msg) {\n            if (_tmpV != data.getRoot(setting)._ver) {\n              return;\n            }\n            var newNodes = [];\n            try {\n              if (!msg || msg.length == 0) {\n                newNodes = [];\n              } else if (typeof msg == \"string\") {\n                newNodes = eval(\"(\" + msg + \")\");\n              } else {\n                newNodes = msg;\n              }\n            } catch (err) {\n              newNodes = msg;\n            }\n\n            if (node) {\n              node.isAjaxing = null;\n              node.zAsync = true;\n            }\n            view.setNodeLineIcos(setting, node);\n            if (newNodes && newNodes !== \"\") {\n              newNodes = tools.apply(setting.async.dataFilter, [setting.treeId, node, newNodes], newNodes);\n              view.addNodes(setting, node, -1, !!newNodes ? tools.clone(newNodes) : [], !!isSilent);\n            } else {\n              view.addNodes(setting, node, -1, [], !!isSilent);\n            }\n            setting.treeObj.trigger(consts.event.ASYNC_SUCCESS, [setting.treeId, node, msg]);\n            tools.apply(callback);\n          },\n          error: function (XMLHttpRequest, textStatus, errorThrown) {\n            if (_tmpV != data.getRoot(setting)._ver) {\n              return;\n            }\n            if (node) node.isAjaxing = null;\n            view.setNodeLineIcos(setting, node);\n            setting.treeObj.trigger(consts.event.ASYNC_ERROR, [setting.treeId, node, XMLHttpRequest, textStatus, errorThrown]);\n          }\n        });\n        return true;\n      },\n      cancelPreSelectedNode: function (setting, node, excludeNode) {\n        var list = data.getRoot(setting).curSelectedList,\n          i, n;\n        for (i = list.length - 1; i >= 0; i--) {\n          n = list[i];\n          if (node === n || (!node && (!excludeNode || excludeNode !== n))) {\n            $$(n, consts.id.A, setting).removeClass(consts.node.CURSELECTED);\n            if (node) {\n              data.removeSelectedNode(setting, node);\n              break;\n            } else {\n              list.splice(i, 1);\n              setting.treeObj.trigger(consts.event.UNSELECTED, [setting.treeId, n]);\n            }\n          }\n        }\n      },\n      createNodeCallback: function (setting) {\n        if (!!setting.callback.onNodeCreated || !!setting.view.addDiyDom) {\n          var root = data.getRoot(setting);\n          while (root.createdNodes.length > 0) {\n            var node = root.createdNodes.shift();\n            tools.apply(setting.view.addDiyDom, [setting.treeId, node]);\n            if (!!setting.callback.onNodeCreated) {\n              setting.treeObj.trigger(consts.event.NODECREATED, [setting.treeId, node]);\n            }\n          }\n        }\n      },\n      createNodes: function (setting, level, nodes, parentNode, index) {\n        if (!nodes || nodes.length == 0) return;\n        var root = data.getRoot(setting),\n          openFlag = !parentNode || parentNode.open || !!$$(data.nodeChildren(setting, parentNode)[0], setting).get(0);\n        root.createdNodes = [];\n        var zTreeHtml = view.appendNodes(setting, level, nodes, parentNode, index, true, openFlag),\n          parentObj, nextObj;\n\n        if (!parentNode) {\n          parentObj = setting.treeObj;\n          //setting.treeObj.append(zTreeHtml.join(''));\n        } else {\n          var ulObj = $$(parentNode, consts.id.UL, setting);\n          if (ulObj.get(0)) {\n            parentObj = ulObj;\n            //ulObj.append(zTreeHtml.join(''));\n          }\n        }\n        if (parentObj) {\n          if (index >= 0) {\n            nextObj = parentObj.children()[index];\n          }\n          if (index >= 0 && nextObj) {\n            $(nextObj).before(zTreeHtml.join(''));\n          } else {\n            parentObj.append(zTreeHtml.join(''));\n          }\n        }\n\n        view.createNodeCallback(setting);\n      },\n      destroy: function (setting) {\n        if (!setting) return;\n        data.initCache(setting);\n        data.initRoot(setting);\n        event.unbindTree(setting);\n        event.unbindEvent(setting);\n        setting.treeObj.empty();\n        delete settings[setting.treeId];\n      },\n      expandCollapseNode: function (setting, node, expandFlag, animateFlag, callback) {\n        var root = data.getRoot(setting);\n        var tmpCb, _callback;\n        if (!node) {\n          tools.apply(callback, []);\n          return;\n        }\n        var children = data.nodeChildren(setting, node);\n        var isParent = data.nodeIsParent(setting, node);\n        if (root.expandTriggerFlag) {\n          _callback = callback;\n          tmpCb = function () {\n            if (_callback) _callback();\n            if (node.open) {\n              setting.treeObj.trigger(consts.event.EXPAND, [setting.treeId, node]);\n            } else {\n              setting.treeObj.trigger(consts.event.COLLAPSE, [setting.treeId, node]);\n            }\n          };\n          callback = tmpCb;\n          root.expandTriggerFlag = false;\n        }\n        if (!node.open && isParent && ((!$$(node, consts.id.UL, setting).get(0)) || (children && children.length > 0 && !$$(children[0], setting).get(0)))) {\n          view.appendParentULDom(setting, node);\n          view.createNodeCallback(setting);\n        }\n        if (node.open == expandFlag) {\n          tools.apply(callback, []);\n          return;\n        }\n        var ulObj = $$(node, consts.id.UL, setting),\n          switchObj = $$(node, consts.id.SWITCH, setting),\n          icoObj = $$(node, consts.id.ICON, setting);\n\n        if (isParent) {\n          node.open = !node.open;\n          if (node.iconOpen && node.iconClose) {\n            icoObj.attr(\"style\", view.makeNodeIcoStyle(setting, node));\n          }\n\n          if (node.open) {\n            view.replaceSwitchClass(node, switchObj, consts.folder.OPEN);\n            view.replaceIcoClass(node, icoObj, consts.folder.OPEN);\n            if (animateFlag == false || setting.view.expandSpeed == \"\") {\n              ulObj.show();\n              tools.apply(callback, []);\n            } else {\n              if (children && children.length > 0) {\n                ulObj.slideDown(setting.view.expandSpeed, callback);\n              } else {\n                ulObj.show();\n                tools.apply(callback, []);\n              }\n            }\n          } else {\n            view.replaceSwitchClass(node, switchObj, consts.folder.CLOSE);\n            view.replaceIcoClass(node, icoObj, consts.folder.CLOSE);\n            if (animateFlag == false || setting.view.expandSpeed == \"\" || !(children && children.length > 0)) {\n              ulObj.hide();\n              tools.apply(callback, []);\n            } else {\n              ulObj.slideUp(setting.view.expandSpeed, callback);\n            }\n          }\n        } else {\n          tools.apply(callback, []);\n        }\n      },\n      expandCollapseParentNode: function (setting, node, expandFlag, animateFlag, callback) {\n        if (!node) return;\n        if (!node.parentTId) {\n          view.expandCollapseNode(setting, node, expandFlag, animateFlag, callback);\n          return;\n        } else {\n          view.expandCollapseNode(setting, node, expandFlag, animateFlag);\n        }\n        if (node.parentTId) {\n          view.expandCollapseParentNode(setting, node.getParentNode(), expandFlag, animateFlag, callback);\n        }\n      },\n      expandCollapseSonNode: function (setting, node, expandFlag, animateFlag, callback) {\n        var root = data.getRoot(setting),\n          treeNodes = (node) ? data.nodeChildren(setting, node) : data.nodeChildren(setting, root),\n          selfAnimateSign = (node) ? false : animateFlag,\n          expandTriggerFlag = data.getRoot(setting).expandTriggerFlag;\n        data.getRoot(setting).expandTriggerFlag = false;\n        if (treeNodes) {\n          for (var i = 0, l = treeNodes.length; i < l; i++) {\n            if (treeNodes[i]) view.expandCollapseSonNode(setting, treeNodes[i], expandFlag, selfAnimateSign);\n          }\n        }\n        data.getRoot(setting).expandTriggerFlag = expandTriggerFlag;\n        view.expandCollapseNode(setting, node, expandFlag, animateFlag, callback);\n      },\n      isSelectedNode: function (setting, node) {\n        if (!node) {\n          return false;\n        }\n        var list = data.getRoot(setting).curSelectedList,\n          i;\n        for (i = list.length - 1; i >= 0; i--) {\n          if (node === list[i]) {\n            return true;\n          }\n        }\n        return false;\n      },\n      makeDOMNodeIcon: function (html, setting, node) {\n        var nameStr = data.nodeName(setting, node),\n          name = setting.view.nameIsHTML ? nameStr : nameStr.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n        html.push(\"<span id='\", node.tId, consts.id.ICON,\n          \"' title='' treeNode\", consts.id.ICON, \" class='\", view.makeNodeIcoClass(setting, node),\n          \"' style='\", view.makeNodeIcoStyle(setting, node), \"'></span><span id='\", node.tId, consts.id.SPAN,\n          \"' class='\", consts.className.NAME,\n          \"'>\", name, \"</span>\");\n      },\n      makeDOMNodeLine: function (html, setting, node) {\n        html.push(\"<span id='\", node.tId, consts.id.SWITCH, \"' title='' class='\", view.makeNodeLineClass(setting, node), \"' treeNode\", consts.id.SWITCH, \"></span>\");\n      },\n      makeDOMNodeMainAfter: function (html, setting, node) {\n        html.push(\"</li>\");\n      },\n      makeDOMNodeMainBefore: function (html, setting, node) {\n        html.push(\"<li id='\", node.tId, \"' class='\", consts.className.LEVEL, node.level, \"' tabindex='0' hidefocus='true' treenode>\");\n      },\n      makeDOMNodeNameAfter: function (html, setting, node) {\n        html.push(\"</a>\");\n      },\n      makeDOMNodeNameBefore: function (html, setting, node) {\n        var title = data.nodeTitle(setting, node),\n          url = view.makeNodeUrl(setting, node),\n          fontcss = view.makeNodeFontCss(setting, node),\n          nodeClasses = view.makeNodeClasses(setting, node),\n          fontStyle = [];\n        for (var f in fontcss) {\n          fontStyle.push(f, \":\", fontcss[f], \";\");\n        }\n        html.push(\"<a id='\", node.tId, consts.id.A, \"' class='\", consts.className.LEVEL, node.level,\n          nodeClasses.add ? ' ' + nodeClasses.add.join(' ') : '', \n          \"' treeNode\", consts.id.A,\n          node.click ? \" onclick=\\\"\" + node.click + \"\\\"\" : \"\",\n          ((url != null && url.length > 0) ? \" href='\" + url + \"'\" : \"\"), \" target='\", view.makeNodeTarget(node), \"' style='\", fontStyle.join(''),\n          \"'\");\n        if (tools.apply(setting.view.showTitle, [setting.treeId, node], setting.view.showTitle) && title) {\n          html.push(\"title='\", title.replace(/'/g, \"&#39;\").replace(/</g, '&lt;').replace(/>/g, '&gt;'), \"'\");\n        }\n        html.push(\">\");\n      },\n      makeNodeFontCss: function (setting, node) {\n        var fontCss = tools.apply(setting.view.fontCss, [setting.treeId, node], setting.view.fontCss);\n        return (fontCss && ((typeof fontCss) != \"function\")) ? fontCss : {};\n      },\n      makeNodeClasses: function (setting, node) {\n        var classes = tools.apply(setting.view.nodeClasses, [setting.treeId, node], setting.view.nodeClasses);\n        return (classes && (typeof classes !== \"function\")) ? classes : {add:[], remove:[]};\n      },\n      makeNodeIcoClass: function (setting, node) {\n        var icoCss = [\"ico\"];\n        if (!node.isAjaxing) {\n          var isParent = data.nodeIsParent(setting, node);\n          icoCss[0] = (node.iconSkin ? node.iconSkin + \"_\" : \"\") + icoCss[0];\n          if (isParent) {\n            icoCss.push(node.open ? consts.folder.OPEN : consts.folder.CLOSE);\n          } else {\n            icoCss.push(consts.folder.DOCU);\n          }\n        }\n        return consts.className.BUTTON + \" \" + icoCss.join('_');\n      },\n      makeNodeIcoStyle: function (setting, node) {\n        var icoStyle = [];\n        if (!node.isAjaxing) {\n          var isParent = data.nodeIsParent(setting, node);\n          var icon = (isParent && node.iconOpen && node.iconClose) ? (node.open ? node.iconOpen : node.iconClose) : node[setting.data.key.icon];\n          if (icon) icoStyle.push(\"background:url(\", icon, \") 0 0 no-repeat;\");\n          if (setting.view.showIcon == false || !tools.apply(setting.view.showIcon, [setting.treeId, node], true)) {\n            icoStyle.push(\"display:none;\");\n          }\n        }\n        return icoStyle.join('');\n      },\n      makeNodeLineClass: function (setting, node) {\n        var lineClass = [];\n        if (setting.view.showLine) {\n          if (node.level == 0 && node.isFirstNode && node.isLastNode) {\n            lineClass.push(consts.line.ROOT);\n          } else if (node.level == 0 && node.isFirstNode) {\n            lineClass.push(consts.line.ROOTS);\n          } else if (node.isLastNode) {\n            lineClass.push(consts.line.BOTTOM);\n          } else {\n            lineClass.push(consts.line.CENTER);\n          }\n        } else {\n          lineClass.push(consts.line.NOLINE);\n        }\n        if (data.nodeIsParent(setting, node)) {\n          lineClass.push(node.open ? consts.folder.OPEN : consts.folder.CLOSE);\n        } else {\n          lineClass.push(consts.folder.DOCU);\n        }\n        return view.makeNodeLineClassEx(node) + lineClass.join('_');\n      },\n      makeNodeLineClassEx: function (node) {\n        return consts.className.BUTTON + \" \" + consts.className.LEVEL + node.level + \" \" + consts.className.SWITCH + \" \";\n      },\n      makeNodeTarget: function (node) {\n        return (node.target || \"_blank\");\n      },\n      makeNodeUrl: function (setting, node) {\n        var urlKey = setting.data.key.url;\n        return node[urlKey] ? node[urlKey] : null;\n      },\n      makeUlHtml: function (setting, node, html, content) {\n        html.push(\"<ul id='\", node.tId, consts.id.UL, \"' class='\", consts.className.LEVEL, node.level, \" \", view.makeUlLineClass(setting, node), \"' style='display:\", (node.open ? \"block\" : \"none\"), \"'>\");\n        html.push(content);\n        html.push(\"</ul>\");\n      },\n      makeUlLineClass: function (setting, node) {\n        return ((setting.view.showLine && !node.isLastNode) ? consts.line.LINE : \"\");\n      },\n      removeChildNodes: function (setting, node) {\n        if (!node) return;\n        var nodes = data.nodeChildren(setting, node);\n        if (!nodes) return;\n\n        for (var i = 0, l = nodes.length; i < l; i++) {\n          data.removeNodeCache(setting, nodes[i]);\n        }\n        data.removeSelectedNode(setting);\n        delete node[setting.data.key.children];\n\n        if (!setting.data.keep.parent) {\n          data.nodeIsParent(setting, node, false);\n          node.open = false;\n          var tmp_switchObj = $$(node, consts.id.SWITCH, setting),\n            tmp_icoObj = $$(node, consts.id.ICON, setting);\n          view.replaceSwitchClass(node, tmp_switchObj, consts.folder.DOCU);\n          view.replaceIcoClass(node, tmp_icoObj, consts.folder.DOCU);\n          $$(node, consts.id.UL, setting).remove();\n        } else {\n          $$(node, consts.id.UL, setting).empty();\n        }\n      },\n      scrollIntoView: function (setting, dom) {\n        if (!dom) {\n          return;\n        }\n        // support IE 7 / 8\n        if (typeof Element === 'undefined' || typeof HTMLElement === 'undefined') {\n          var contRect = setting.treeObj.get(0).getBoundingClientRect(),\n            findMeRect = dom.getBoundingClientRect();\n          if (findMeRect.top < contRect.top || findMeRect.bottom > contRect.bottom\n            || findMeRect.right > contRect.right || findMeRect.left < contRect.left) {\n            dom.scrollIntoView();\n          }\n          return;\n        }\n        // CC-BY jocki84@googlemail.com, https://gist.github.com/jocki84/6ffafd003387179a988e\n        if (!Element.prototype.scrollIntoViewIfNeeded) {\n          Element.prototype.scrollIntoViewIfNeeded = function (centerIfNeeded) {\n            \"use strict\";\n\n            function makeRange(start, length) {\n              return {\"start\": start, \"length\": length, \"end\": start + length};\n            }\n\n            function coverRange(inner, outer) {\n              if (\n                false === centerIfNeeded ||\n                (outer.start < inner.end && inner.start < outer.end)\n              ) {\n                return Math.max(\n                  inner.end - outer.length,\n                  Math.min(outer.start, inner.start)\n                );\n              }\n              return (inner.start + inner.end - outer.length) / 2;\n            }\n\n            function makePoint(x, y) {\n              return {\n                \"x\": x,\n                \"y\": y,\n                \"translate\": function translate(dX, dY) {\n                  return makePoint(x + dX, y + dY);\n                }\n              };\n            }\n\n            function absolute(elem, pt) {\n              while (elem) {\n                pt = pt.translate(elem.offsetLeft, elem.offsetTop);\n                elem = elem.offsetParent;\n              }\n              return pt;\n            }\n\n            var target = absolute(this, makePoint(0, 0)),\n              extent = makePoint(this.offsetWidth, this.offsetHeight),\n              elem = this.parentNode,\n              origin;\n\n            while (elem instanceof HTMLElement) {\n              // Apply desired scroll amount.\n              origin = absolute(elem, makePoint(elem.clientLeft, elem.clientTop));\n              elem.scrollLeft = coverRange(\n                makeRange(target.x - origin.x, extent.x),\n                makeRange(elem.scrollLeft, elem.clientWidth)\n              );\n              elem.scrollTop = coverRange(\n                makeRange(target.y - origin.y, extent.y),\n                makeRange(elem.scrollTop, elem.clientHeight)\n              );\n\n              // Determine actual scroll amount by reading back scroll properties.\n              target = target.translate(-elem.scrollLeft, -elem.scrollTop);\n              elem = elem.parentNode;\n            }\n          };\n        }\n        dom.scrollIntoViewIfNeeded();\n      },\n      setFirstNode: function (setting, parentNode) {\n        var children = data.nodeChildren(setting, parentNode);\n        if (children.length > 0) {\n          children[0].isFirstNode = true;\n        }\n      },\n      setLastNode: function (setting, parentNode) {\n        var children = data.nodeChildren(setting, parentNode);\n        if (children.length > 0) {\n          children[children.length - 1].isLastNode = true;\n        }\n      },\n      removeNode: function (setting, node) {\n        var root = data.getRoot(setting),\n          parentNode = (node.parentTId) ? node.getParentNode() : root;\n\n        node.isFirstNode = false;\n        node.isLastNode = false;\n        node.getPreNode = function () {\n          return null;\n        };\n        node.getNextNode = function () {\n          return null;\n        };\n\n        if (!data.getNodeCache(setting, node.tId)) {\n          return;\n        }\n\n        $$(node, setting).remove();\n        data.removeNodeCache(setting, node);\n        data.removeSelectedNode(setting, node);\n\n        var children = data.nodeChildren(setting, parentNode);\n        for (var i = 0, l = children.length; i < l; i++) {\n          if (children[i].tId == node.tId) {\n            children.splice(i, 1);\n            break;\n          }\n        }\n        view.setFirstNode(setting, parentNode);\n        view.setLastNode(setting, parentNode);\n\n        var tmp_ulObj, tmp_switchObj, tmp_icoObj,\n          childLength = children.length;\n\n        //repair nodes old parent\n        if (!setting.data.keep.parent && childLength == 0) {\n          //old parentNode has no child nodes\n          data.nodeIsParent(setting, parentNode, false);\n          parentNode.open = false;\n          delete parentNode[setting.data.key.children];\n          tmp_ulObj = $$(parentNode, consts.id.UL, setting);\n          tmp_switchObj = $$(parentNode, consts.id.SWITCH, setting);\n          tmp_icoObj = $$(parentNode, consts.id.ICON, setting);\n          view.replaceSwitchClass(parentNode, tmp_switchObj, consts.folder.DOCU);\n          view.replaceIcoClass(parentNode, tmp_icoObj, consts.folder.DOCU);\n          tmp_ulObj.css(\"display\", \"none\");\n\n        } else if (setting.view.showLine && childLength > 0) {\n          //old parentNode has child nodes\n          var newLast = children[childLength - 1];\n          tmp_ulObj = $$(newLast, consts.id.UL, setting);\n          tmp_switchObj = $$(newLast, consts.id.SWITCH, setting);\n          tmp_icoObj = $$(newLast, consts.id.ICON, setting);\n          if (parentNode == root) {\n            if (children.length == 1) {\n              //node was root, and ztree has only one root after move node\n              view.replaceSwitchClass(newLast, tmp_switchObj, consts.line.ROOT);\n            } else {\n              var tmp_first_switchObj = $$(children[0], consts.id.SWITCH, setting);\n              view.replaceSwitchClass(children[0], tmp_first_switchObj, consts.line.ROOTS);\n              view.replaceSwitchClass(newLast, tmp_switchObj, consts.line.BOTTOM);\n            }\n          } else {\n            view.replaceSwitchClass(newLast, tmp_switchObj, consts.line.BOTTOM);\n          }\n          tmp_ulObj.removeClass(consts.line.LINE);\n        }\n      },\n      replaceIcoClass: function (node, obj, newName) {\n        if (!obj || node.isAjaxing) return;\n        var tmpName = obj.attr(\"class\");\n        if (tmpName == undefined) return;\n        var tmpList = tmpName.split(\"_\");\n        switch (newName) {\n          case consts.folder.OPEN:\n          case consts.folder.CLOSE:\n          case consts.folder.DOCU:\n            tmpList[tmpList.length - 1] = newName;\n            break;\n        }\n        obj.attr(\"class\", tmpList.join(\"_\"));\n      },\n      replaceSwitchClass: function (node, obj, newName) {\n        if (!obj) return;\n        var tmpName = obj.attr(\"class\");\n        if (tmpName == undefined) return;\n        var tmpList = tmpName.split(\"_\");\n        switch (newName) {\n          case consts.line.ROOT:\n          case consts.line.ROOTS:\n          case consts.line.CENTER:\n          case consts.line.BOTTOM:\n          case consts.line.NOLINE:\n            tmpList[0] = view.makeNodeLineClassEx(node) + newName;\n            break;\n          case consts.folder.OPEN:\n          case consts.folder.CLOSE:\n          case consts.folder.DOCU:\n            tmpList[1] = newName;\n            break;\n        }\n        obj.attr(\"class\", tmpList.join(\"_\"));\n        if (newName !== consts.folder.DOCU) {\n          obj.removeAttr(\"disabled\");\n        } else {\n          obj.attr(\"disabled\", \"disabled\");\n        }\n      },\n      selectNode: function (setting, node, addFlag) {\n        if (!addFlag) {\n          view.cancelPreSelectedNode(setting, null, node);\n        }\n        $$(node, consts.id.A, setting).addClass(consts.node.CURSELECTED);\n        data.addSelectedNode(setting, node);\n        setting.treeObj.trigger(consts.event.SELECTED, [setting.treeId, node]);\n      },\n      setNodeFontCss: function (setting, treeNode) {\n        var aObj = $$(treeNode, consts.id.A, setting),\n          fontCss = view.makeNodeFontCss(setting, treeNode);\n        if (fontCss) {\n          aObj.css(fontCss);\n        }\n      },\n      setNodeClasses: function (setting, treeNode) {\n        var aObj = $$(treeNode, consts.id.A, setting),\n          classes = view.makeNodeClasses(setting, treeNode);\n        if ('add' in classes && classes.add.length) {\n          aObj.addClass(classes.add.join(' '));\n        }\n        if ('remove' in classes && classes.remove.length) {\n          aObj.removeClass(classes.remove.join(' '));\n        }\n      },\n      setNodeLineIcos: function (setting, node) {\n        if (!node) return;\n        var switchObj = $$(node, consts.id.SWITCH, setting),\n          ulObj = $$(node, consts.id.UL, setting),\n          icoObj = $$(node, consts.id.ICON, setting),\n          ulLine = view.makeUlLineClass(setting, node);\n        if (ulLine.length == 0) {\n          ulObj.removeClass(consts.line.LINE);\n        } else {\n          ulObj.addClass(ulLine);\n        }\n        switchObj.attr(\"class\", view.makeNodeLineClass(setting, node));\n        if (data.nodeIsParent(setting, node)) {\n          switchObj.removeAttr(\"disabled\");\n        } else {\n          switchObj.attr(\"disabled\", \"disabled\");\n        }\n        icoObj.removeAttr(\"style\");\n        icoObj.attr(\"style\", view.makeNodeIcoStyle(setting, node));\n        icoObj.attr(\"class\", view.makeNodeIcoClass(setting, node));\n      },\n      setNodeName: function (setting, node) {\n        var title = data.nodeTitle(setting, node),\n          nObj = $$(node, consts.id.SPAN, setting);\n        nObj.empty();\n        if (setting.view.nameIsHTML) {\n          nObj.html(data.nodeName(setting, node));\n        } else {\n          nObj.text(data.nodeName(setting, node));\n        }\n        if (tools.apply(setting.view.showTitle, [setting.treeId, node], setting.view.showTitle)) {\n          var aObj = $$(node, consts.id.A, setting);\n          aObj.attr(\"title\", !title ? \"\" : title);\n        }\n      },\n      setNodeTarget: function (setting, node) {\n        var aObj = $$(node, consts.id.A, setting);\n        aObj.attr(\"target\", view.makeNodeTarget(node));\n      },\n      setNodeUrl: function (setting, node) {\n        var aObj = $$(node, consts.id.A, setting),\n          url = view.makeNodeUrl(setting, node);\n        if (url == null || url.length == 0) {\n          aObj.removeAttr(\"href\");\n        } else {\n          aObj.attr(\"href\", url);\n        }\n      },\n      switchNode: function (setting, node) {\n        if (node.open || !tools.canAsync(setting, node)) {\n          view.expandCollapseNode(setting, node, !node.open);\n        } else if (setting.async.enable) {\n          if (!view.asyncNode(setting, node)) {\n            view.expandCollapseNode(setting, node, !node.open);\n            return;\n          }\n        } else if (node) {\n          view.expandCollapseNode(setting, node, !node.open);\n        }\n      }\n    };\n  // zTree defind\n  $.fn.zTree = {\n    consts: _consts,\n    _z: {\n      tools: tools,\n      view: view,\n      event: event,\n      data: data\n    },\n    getZTreeObj: function (treeId) {\n      var o = data.getZTreeTools(treeId);\n      return o ? o : null;\n    },\n    destroy: function (treeId) {\n      if (!!treeId && treeId.length > 0) {\n        view.destroy(data.getSetting(treeId));\n      } else {\n        for (var s in settings) {\n          view.destroy(settings[s]);\n        }\n      }\n    },\n    init: function (obj, zSetting, zNodes) {\n      var setting = tools.clone(_setting);\n      $.extend(true, setting, zSetting);\n      setting.treeId = obj.attr(\"id\");\n      setting.treeObj = obj;\n      setting.treeObj.empty();\n      settings[setting.treeId] = setting;\n      //For some older browser,(e.g., ie6)\n      if (typeof document.body.style.maxHeight === \"undefined\") {\n        setting.view.expandSpeed = \"\";\n      }\n      data.initRoot(setting);\n      var root = data.getRoot(setting);\n      zNodes = zNodes ? tools.clone(tools.isArray(zNodes) ? zNodes : [zNodes]) : [];\n      if (setting.data.simpleData.enable) {\n        data.nodeChildren(setting, root, data.transformTozTreeFormat(setting, zNodes));\n      } else {\n        data.nodeChildren(setting, root, zNodes);\n      }\n\n      data.initCache(setting);\n      event.unbindTree(setting);\n      event.bindTree(setting);\n      event.unbindEvent(setting);\n      event.bindEvent(setting);\n\n      var zTreeTools = {\n        setting: setting,\n        addNodes: function (parentNode, index, newNodes, isSilent) {\n          if (!parentNode) parentNode = null;\n          var isParent = data.nodeIsParent(setting, parentNode);\n          if (parentNode && !isParent && setting.data.keep.leaf) return null;\n\n          var i = parseInt(index, 10);\n          if (isNaN(i)) {\n            isSilent = !!newNodes;\n            newNodes = index;\n            index = -1;\n          } else {\n            index = i;\n          }\n          if (!newNodes) return null;\n\n\n          var xNewNodes = tools.clone(tools.isArray(newNodes) ? newNodes : [newNodes]);\n\n          function addCallback() {\n            view.addNodes(setting, parentNode, index, xNewNodes, (isSilent == true));\n          }\n\n          if (tools.canAsync(setting, parentNode)) {\n            view.asyncNode(setting, parentNode, isSilent, addCallback);\n          } else {\n            addCallback();\n          }\n          return xNewNodes;\n        },\n        cancelSelectedNode: function (node) {\n          view.cancelPreSelectedNode(setting, node);\n        },\n        destroy: function () {\n          view.destroy(setting);\n        },\n        expandAll: function (expandFlag) {\n          expandFlag = !!expandFlag;\n          view.expandCollapseSonNode(setting, null, expandFlag, true);\n          return expandFlag;\n        },\n        expandNode: function (node, expandFlag, sonSign, focus, callbackFlag) {\n          if (!node || !data.nodeIsParent(setting, node)) return null;\n          if (expandFlag !== true && expandFlag !== false) {\n            expandFlag = !node.open;\n          }\n          callbackFlag = !!callbackFlag;\n\n          if (callbackFlag && expandFlag && (tools.apply(setting.callback.beforeExpand, [setting.treeId, node], true) == false)) {\n            return null;\n          } else if (callbackFlag && !expandFlag && (tools.apply(setting.callback.beforeCollapse, [setting.treeId, node], true) == false)) {\n            return null;\n          }\n          if (expandFlag && node.parentTId) {\n            view.expandCollapseParentNode(setting, node.getParentNode(), expandFlag, false);\n          }\n          if (expandFlag === node.open && !sonSign) {\n            return null;\n          }\n\n          data.getRoot(setting).expandTriggerFlag = callbackFlag;\n          if (!tools.canAsync(setting, node) && sonSign) {\n            view.expandCollapseSonNode(setting, node, expandFlag, true, showNodeFocus);\n          } else {\n            node.open = !expandFlag;\n            view.switchNode(this.setting, node);\n            showNodeFocus();\n          }\n          return expandFlag;\n\n          function showNodeFocus() {\n            var a = $$(node, setting).get(0);\n            if (a && focus !== false) {\n              view.scrollIntoView(setting, a);\n            }\n          }\n        },\n        getNodes: function () {\n          return data.getNodes(setting);\n        },\n        getNodeByParam: function (key, value, parentNode) {\n          if (!key) return null;\n          return data.getNodeByParam(setting, parentNode ? data.nodeChildren(setting, parentNode) : data.getNodes(setting), key, value);\n        },\n        getNodeByTId: function (tId) {\n          return data.getNodeCache(setting, tId);\n        },\n        getNodesByParam: function (key, value, parentNode) {\n          if (!key) return null;\n          return data.getNodesByParam(setting, parentNode ? data.nodeChildren(setting, parentNode) : data.getNodes(setting), key, value);\n        },\n        getNodesByParamFuzzy: function (key, value, parentNode) {\n          if (!key) return null;\n          return data.getNodesByParamFuzzy(setting, parentNode ? data.nodeChildren(setting, parentNode) : data.getNodes(setting), key, value);\n        },\n        getNodesByFilter: function (filter, isSingle, parentNode, invokeParam) {\n          isSingle = !!isSingle;\n          if (!filter || (typeof filter != \"function\")) return (isSingle ? null : []);\n          return data.getNodesByFilter(setting, parentNode ? data.nodeChildren(setting, parentNode) : data.getNodes(setting), filter, isSingle, invokeParam);\n        },\n        getNodeIndex: function (node) {\n          if (!node) return null;\n          var parentNode = (node.parentTId) ? node.getParentNode() : data.getRoot(setting);\n          var children = data.nodeChildren(setting, parentNode);\n          for (var i = 0, l = children.length; i < l; i++) {\n            if (children[i] == node) return i;\n          }\n          return -1;\n        },\n        getSelectedNodes: function () {\n          var r = [], list = data.getRoot(setting).curSelectedList;\n          for (var i = 0, l = list.length; i < l; i++) {\n            r.push(list[i]);\n          }\n          return r;\n        },\n        isSelectedNode: function (node) {\n          return data.isSelectedNode(setting, node);\n        },\n        reAsyncChildNodesPromise: function (parentNode, reloadType, isSilent) {\n          var promise = new Promise(function (resolve, reject) {\n            try {\n              zTreeTools.reAsyncChildNodes(parentNode, reloadType, isSilent, function () {\n                resolve(parentNode);\n              });\n            } catch (e) {\n              reject(e);\n            }\n          });\n          return promise;\n        },\n        reAsyncChildNodes: function (parentNode, reloadType, isSilent, callback) {\n          if (!this.setting.async.enable) return;\n          var isRoot = !parentNode;\n          if (isRoot) {\n            parentNode = data.getRoot(setting);\n          }\n          if (reloadType == \"refresh\") {\n            var children = data.nodeChildren(setting, parentNode);\n            for (var i = 0, l = children ? children.length : 0; i < l; i++) {\n              data.removeNodeCache(setting, children[i]);\n            }\n            data.removeSelectedNode(setting);\n            data.nodeChildren(setting, parentNode, []);\n            if (isRoot) {\n              this.setting.treeObj.empty();\n            } else {\n              var ulObj = $$(parentNode, consts.id.UL, setting);\n              ulObj.empty();\n            }\n          }\n          view.asyncNode(this.setting, isRoot ? null : parentNode, !!isSilent, callback);\n        },\n        refresh: function () {\n          this.setting.treeObj.empty();\n          var root = data.getRoot(setting),\n            nodes = data.nodeChildren(setting, root);\n          data.initRoot(setting);\n          data.nodeChildren(setting, root, nodes);\n          data.initCache(setting);\n          view.createNodes(setting, 0, data.nodeChildren(setting, root), null, -1);\n        },\n        removeChildNodes: function (node) {\n          if (!node) return null;\n          var nodes = data.nodeChildren(setting, node);\n          view.removeChildNodes(setting, node);\n          return nodes ? nodes : null;\n        },\n        removeNode: function (node, callbackFlag) {\n          if (!node) return;\n          callbackFlag = !!callbackFlag;\n          if (callbackFlag && tools.apply(setting.callback.beforeRemove, [setting.treeId, node], true) == false) return;\n          view.removeNode(setting, node);\n          if (callbackFlag) {\n            this.setting.treeObj.trigger(consts.event.REMOVE, [setting.treeId, node]);\n          }\n        },\n        selectNode: function (node, addFlag, isSilent) {\n          if (!node) return;\n          if (tools.uCanDo(setting)) {\n            addFlag = setting.view.selectedMulti && addFlag;\n            if (node.parentTId) {\n              view.expandCollapseParentNode(setting, node.getParentNode(), true, false, showNodeFocus);\n            } else if (!isSilent) {\n              try {\n                $$(node, setting).focus().blur();\n              } catch (e) {\n              }\n            }\n            view.selectNode(setting, node, addFlag);\n          }\n\n          function showNodeFocus() {\n            if (isSilent) {\n              return;\n            }\n            var a = $$(node, setting).get(0);\n            view.scrollIntoView(setting, a);\n          }\n        },\n        transformTozTreeNodes: function (simpleNodes) {\n          return data.transformTozTreeFormat(setting, simpleNodes);\n        },\n        transformToArray: function (nodes) {\n          return data.transformToArrayFormat(setting, nodes);\n        },\n        updateNode: function (node, checkTypeFlag) {\n          if (!node) return;\n          var nObj = $$(node, setting);\n          if (nObj.get(0) && tools.uCanDo(setting)) {\n            view.setNodeName(setting, node);\n            view.setNodeTarget(setting, node);\n            view.setNodeUrl(setting, node);\n            view.setNodeLineIcos(setting, node);\n            view.setNodeFontCss(setting, node);\n            view.setNodeClasses(setting, node);\n          }\n        }\n      };\n      root.treeTools = zTreeTools;\n      data.setZTreeTools(setting, zTreeTools);\n      var children = data.nodeChildren(setting, root);\n      if (children && children.length > 0) {\n        view.createNodes(setting, 0, children, null, -1);\n      } else if (setting.async.enable && setting.async.url && setting.async.url !== '') {\n        view.asyncNode(setting);\n      }\n      return zTreeTools;\n    }\n  };\n\n  var zt = $.fn.zTree,\n    $$ = tools.$,\n    consts = zt.consts;\n})(jQuery);"]}]}