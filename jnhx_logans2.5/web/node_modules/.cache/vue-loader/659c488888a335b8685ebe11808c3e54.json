{"remainingRequest":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hx_ygg/job/hx_logana3.0/web/src/components/collectTree/collect-tree.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/home/hx_ygg/job/hx_logana3.0/web/src/components/collectTree/collect-tree.vue","mtime":1631238422157},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgojck1lbnUgewoJd2lkdGg6IDkwcHg7Cglmb250LXNpemU6IDEycHg7Cglwb3NpdGlvbjogZml4ZWQ7Cgl2aXNpYmlsaXR5OiBoaWRkZW47Cgl1bCB7CgkJYm9yZGVyOiAxcHggc29saWQgI2NmY2ZjZjsKCQliYWNrZ3JvdW5kLWNvbG9yOiAjZmVmZWZlOwoJCS5pdnUtZHJvcGRvd24taXRlbSB7CgkJCWhlaWdodDogMzBweDsKCQkJbGluZS1oZWlnaHQ6IDMwcHg7CgkJCWZvbnQtc2l6ZTogMTJweCAhaW1wb3J0YW50OwoJCQlmb250LXdlaWdodDogNzAwOwoJCQlwYWRkaW5nOiAwIDVweDsKCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQlib3JkZXItYm90dG9tOiAxcHggc29saWQgI2NmY2ZjZjsKCQl9CgkJJjpudGgtbGFzdC1jaGlsZCgxKSB7CgkJCWJvcmRlci1ib3R0b206IG5vbmU7CgkJfQoJfQogICAgLml2dS1kcm9wZG93bi1pdGVtLWRpc2FibGVkOmhvdmVyIHsKICAgICAgICBjb2xvcjogaW5oZXJpdDsgCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjNmMzsgCiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgfQogICAgLml2dS1kcm9wZG93bi1pdGVtLWRpc2FibGVkIHsKICAgICAgICBjb2xvcjogaW5oZXJpdDsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB9Cn0KLm5vZGUtbmFtZSBpbnB1dCB7CiAgICBoZWlnaHQ6IDMwcHggIWltcG9ydGFudDsKfQo="},{"version":3,"sources":["collect-tree.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"collect-tree.vue","sourceRoot":"src/components/collectTree","sourcesContent":["<template>\n\t<div class=\"collect_tree\">\n\t\t<ul id=\"collectTree\" class=\"ztree\"></ul>\n\t\t<div id=\"rMenu\">\n\t\t\t<DropdownMenu >\n\t\t\t\t<div @click=\"addNodes()\">\n\t\t\t\t\t<DropdownItem v-if=\"rMenuContent.hasCreate\" disabled>\n\t\t\t\t\t\t新建文件夹\n\t\t\t\t\t</DropdownItem>\n\t\t\t\t</div>\n\t\t\t\t<div @click=\"delNode()\">\n\t\t\t\t\t<DropdownItem v-if=\"rMenuContent.hasDel\" disabled>\n\t\t\t\t\t\t删除文件夹\n\t\t\t\t\t</DropdownItem>\n\t\t\t\t</div>\n\t\t\t\t<div @click=\"editNodes()\">\n\t\t\t\t\t<DropdownItem v-if=\"rMenuContent.hasRname\" disabled>\n\t\t\t\t\t\t修改名称\n\t\t\t\t\t</DropdownItem>\n\t\t\t\t</div>\n\t\t\t</DropdownMenu>\n\t\t</div>\n\t<!-- 修改名称 -->\n\t<Modal\n\t\t\tclass=\"classModal\"\n\t\t\tv-model=\"renameVisible\"\n\t\t\ttitle=\"修改名称\"\n\t\t\twidth=\"500\"\n\t\t\t:mask-closable=\"false\"\n\t\t>\n\t\t\t<div class=\"top\">\n\t\t\t\t<label for=\"name\">名称</label>\n\t\t\t\t<Input\n\t\t\t\t\tv-model=\"name\"\n\t\t\t\t\tplaceholder=\"输入名称\"\n\t\t\t\t\tstyle=\"width: calc(100% - 34px)\"\n\t\t\t\t></Input>\n\t\t\t</div>\n\t\t\t<div slot=\"footer\">\n\t\t\t\t<Button type=\"default\" @click=\"renameVisible = false;\">取消</Button>\n\t\t\t\t<Button type=\"primary\" @click=\"changeName\">确定</Button>\n\t\t\t</div>\n\t</Modal>\n\t</div>\n</template>\n<script>\nimport $ from 'jquery';\nimport { getCollect, addCollect, delCollect, editCollect } from '@/api/search';\nimport folderOpen from '@/assets/main/folder-open.png';\nimport folderClose from '@/assets/main/folder-close.png';\nimport { setTreeByJson } from '@/utils/util';\nexport default {\n\tname: 'collect-tree',\n\tdata() {\n\t\treturn {\n\t\t\tcollectTree: null,\n\t\t\t// ztree 配置\n\t\t\tsetting: {\n\t\t\t\tdata: {},\n\t\t\t\tcallback: {\n\t\t\t\t\tonRightClick: this.nodeRightClick,\n\t\t\t\t\tonClick:this.nodeClick\n\t\t\t\t},\n                edit:{},\n\t\t\t},\n\t\t\t// 节点数据\n\t\t\tzNodes: [],\n\t\t\t// 控制右键菜单内容的显示隐藏\n\t\t\trMenuContent: {\n\t\t\t\thasCreate: true,\n\t\t\t\thasDel: true,\n\t\t\t\thasRname: true,\n\t\t\t},\n            curNode:null,\n            zTree:null,\n\t\t\tname:'',\n\t\t\trenameVisible:false\n\t\t};\n\t},\n\tasync mounted() {\n\t\tthis.zNodes = await this.getNodes();\n\t\t$.fn.zTree.init($('#collectTree'), this.setting, this.zNodes);\n\t\tthis.zTree = $.fn.zTree.getZTreeObj('collectTree');\n\t\tthis.curNode = this.zTree.getNodes()[0];\n\t\tthis.zTree.selectNode(this.curNode);\n\t\tthis.$emit('nodeClick',this.curNode);\n\t\t$('body').click(() => this.closeRmenu());\n\t\t// this.getNodes();\n\t},\n\tmethods: {\n\t\tnodeRightClick(event, treeId, treeNode) {\n\t\t\tif (treeNode) {\n\t\t\t\tthis.curNode = treeNode;\n\t\t\t\tthis.zTree.selectNode(treeNode);\n\t\t\t\tthis.showRmenu(treeNode, event.clientX, event.clientY);\n\t\t\t}\n\t\t},\n\t\tnodeClick(event, treeId, treeNode){\n\t\t\tthis.curNode = treeNode;\n\t\t\tthis.$emit('nodeClick',this.curNode);\n\t\t},\n\t\t/**\n\t\t * 右键菜单的开启\n\t\t */\n\t\tshowRmenu(treeNode, x, y) {\n\t\t\tif (this.isRoot(treeNode)) {\n\t\t\t\t// 如果是根节点 只有新增\n\t\t\t\tthis.rMenuContent.hasDel = false;\n\t\t\t\tthis.rMenuContent.hasRname = false;\n\t\t\t} else {\n\t\t\t\t// 全部都有\n\t\t\t\tthis.rMenuContent.hasDel = true;\n\t\t\t\tthis.rMenuContent.hasRname = true;\n\t\t\t}\n\t\t\t$('#rMenu').css({\n\t\t\t\ttop: y + 'px',\n\t\t\t\tleft: x + 'px',\n\t\t\t\tvisibility: 'visible',\n\t\t\t});\n\t\t},\n\t\t// 判断是不是根节点\n\t\tisRoot(treeNode) {\n\t\t\treturn treeNode.level === 0;\n\t\t},\n\t\t/**\n\t\t * 右键菜单的关闭\n\t\t * 1.点击菜单时候\n\t\t * 2.点击空白处的时候\n\t\t */\n\t\tcloseRmenu() {\n\t\t\t$('#rMenu').css({ visibility: 'hidden' });\n\t\t},\n\t\t// 获取节点\n\t\tgetNodes() {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tgetCollect().then((res) => {\n\t\t\t\t\tlet data = res.filter((list) => list.mark_type === 0);\n\t\t\t\t\tresolve(this.setNodes(setTreeByJson(data)));\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t// node设置\n\t\tsetNodes(nodes) {\n\t\t\treturn nodes.map((list) => {\n\t\t\t\tif (list.children) {\n\t\t\t\t\tlist.children = this.setNodes(list.children);\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t...list,\n\t\t\t\t\tname: list.mark_name,\n\t\t\t\t\topen: true,\n\t\t\t\t\ticon: folderClose,\n\t\t\t\t\ticonOpen: folderOpen,\n\t\t\t\t\ticonClose: folderClose,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\t// 添加文件夹\n\t\taddNodes() {\n\t\t\t// 触发addNode函数\n\t\t\tthis.ajaxAdd(null, 0, '新建文件夹');\n\t\t},\n        editNodes(){\n            this.renameVisible = true;\n\t\t\tthis.name = this.curNode.mark_name;\n        },\n\t\tdelNode(){\n\t\t\tthis.ajaxDelete(this.curNode.mark_id,() => {\n\t\t\t\tthis.zTree.removeNode(this.curNode);\n\t\t\t\tthis.curNode = this.zTree.getNodes()[0];\n\t\t\t\tthis.zTree.selectNode(this.curNode);\n\t\t\t\tthis.$emit('nodeClick',this.curNode);\n\t\t\t});\n\t\t},\n\t\tajaxAdd(conditions,mark_type,mark_name,callback){\n\t\t\tif(!mark_name.trim()){\n\t\t\t\tthis.$Message.warning('请输入书签名称');\n\t\t\t\treturn\n\t\t\t}\n\t\t\tlet node = {\n\t\t\t\tmark_name,\n\t\t\t\tmark_type,\n\t\t\t\tmark_qtype: null,\n\t\t\t\tmark_pid: this.curNode.mark_id,\n\t\t\t\tis_root: 0,\n\t\t\t\tmark_condations: conditions,\n\t\t\t};\n\t\t\taddCollect(node).then((res) => {\n\t\t\t\tthis.zTree.addNodes(this.curNode, -1, this.setNode(res));\n\t\t\t\tif(callback){\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tajaxEdit(data,curNode,msg) {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\teditCollect(data,curNode.mark_id).then(() => {\n\t\t\t\t\tthis.$Message.success(msg?msg:'修改成功');\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t})\n\t\t},\n\t\tajaxDelete(id,callback) {\n\t\t\tdelCollect(id).then(() => {\n\t\t\t\tthis.$Message.success('删除成功');\n\t\t\t\tif(callback){\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 处理node\n\t\tsetNode(node){\n\t\t\treturn Object.assign({},node,{\n\t\t\t\tname: node.mark_name,\n\t\t\t\topen: true,\n\t\t\t\ticon: folderClose,\n\t\t\t\ticonOpen: folderOpen,\n\t\t\t\ticonClose: folderClose,\n\t\t\t})\n\t\t},\n\t\t// 修改名称\n\t\tchangeName(){\n\t\t\tthis.ajaxEdit({mark_name:this.name},this.curNode).then(() => {\n\t\t\t\tthis.curNode.mark_name = this.name;\n\t\t\t\tthis.curNode.name = this.name;\n\t\t\t\tthis.zTree.updateNode(this.curNode);\n\t\t\t\tthis.renameVisible = false;\n\t\t\t});\n\t\t}\n\t},\n};\n</script>\n<style lang=\"scss\">\n#rMenu {\n\twidth: 90px;\n\tfont-size: 12px;\n\tposition: fixed;\n\tvisibility: hidden;\n\tul {\n\t\tborder: 1px solid #cfcfcf;\n\t\tbackground-color: #fefefe;\n\t\t.ivu-dropdown-item {\n\t\t\theight: 30px;\n\t\t\tline-height: 30px;\n\t\t\tfont-size: 12px !important;\n\t\t\tfont-weight: 700;\n\t\t\tpadding: 0 5px;\n\t\t\ttext-align: center;\n\t\t\tborder-bottom: 1px solid #cfcfcf;\n\t\t}\n\t\t&:nth-last-child(1) {\n\t\t\tborder-bottom: none;\n\t\t}\n\t}\n    .ivu-dropdown-item-disabled:hover {\n        color: inherit; \n        background-color: #f3f3f3; \n        cursor: pointer;\n    }\n    .ivu-dropdown-item-disabled {\n        color: inherit;\n        cursor: pointer;\n    }\n}\n.node-name input {\n    height: 30px !important;\n}\n</style>\n"]}]}