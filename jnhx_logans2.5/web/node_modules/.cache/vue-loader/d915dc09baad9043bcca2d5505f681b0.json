{"remainingRequest":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hx_ygg/job/hx_logana3.0/web/src/views/operation/expression/expression.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/hx_ygg/job/hx_logana3.0/web/src/views/operation/expression/expression.vue","mtime":1631238422177},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hx_ygg/job/hx_logana3.0/web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHRlc3RSdWxlIH0gZnJvbSAnQC9hcGkvb3BlcmF0aW9uJzsKaW1wb3J0IHsgcmVndWxhclJ1bGVzIH0gZnJvbSAnQC91dGlscy91dGlsJzsKZXhwb3J0IGRlZmF1bHQgewoJbmFtZTogJ2V4cHJlc3Npb24nLAoJZGF0YSgpIHsKCQlyZXR1cm4gewoJCQliYXNpY19ydWxlczogewoJCQkJbG9nRmVhdHVyZTogJycsCgkJCQlleHRyYWN0UnVsZTogJycsCgkJCQlzd2l0Y2hSdWxlOiAnJywKCQkJCXJlcGxhY2VSdWxlOiAnJywKCQkJCXN1cHBsZW1lbnRSdWxlOiAnJywKCQkJfSwKCQkJcnVsZUZvcm1SdWxlOiB7CgkJCQlleHRyYWN0UnVsZTogWwoJCQkJCXsKCQkJCQkJcmVxdWlyZWQ6IHRydWUsCgkJCQkJCU1lc3NhZ2U6ICfor7fovpPlhaXop4TliJnlkI3np7AnLAoJCQkJCQl0cmlnZ2VyOiAnY2hhbmdlJywKCQkJCQl9LAoJCQkJXSwKCQkJCWxvZ0ZlYXR1cmU6IFsKCQkJCQl7CgkJCQkJCXJlcXVpcmVkOiB0cnVlLAoJCQkJCQlNZXNzYWdlOiAn6K+36L6T5YWl5pel5b+X5pWw5o2uJywKCQkJCQkJdHJpZ2dlcjogJ2JsdXInLAoJCQkJCX0sCgkJCQldLAoJCQl9LAoJCQljb2x1bW5zOiBbXSwKCQkJZXhwcmVzc2lvbkRhdGE6IFtdLAoJCQl0YWJlbEZsYWc6IGZhbHNlLAoJCX07Cgl9LAoJbWV0aG9kczogewoJCXJlc2V0KCkgewoJCQl0aGlzLmJhc2ljX3J1bGVzID0gewoJCQkJbG9nRmVhdHVyZTogJycsCgkJCQlleHRyYWN0UnVsZTogJycsCgkJCQlzd2l0Y2hSdWxlOiAnJywKCQkJCXJlcGxhY2VSdWxlOiAnJywKCQkJCXN1cHBsZW1lbnRSdWxlOiAnJywKCQkJfTsKCQl9LAoJCXRlc3QoKSB7CgkJCXRoaXMudGFiZWxGbGFnID0gdHJ1ZTsKCQkJbGV0IHRlbXA7CgkJCWxldCBmbGFnID0gdHJ1ZTsKCQkJaWYgKHRoaXMuYmFzaWNfcnVsZXMuZXh0cmFjdFJ1bGUgIT09ICcnKSB7CgkJCQlpZiAocmVndWxhclJ1bGVzKHRoaXMuYmFzaWNfcnVsZXMuZXh0cmFjdFJ1bGUpKSB7CgkJCQkJdGhpcy4kTWVzc2FnZS53YXJuaW5nKAoJCQkJCQkn5o+Q5Y+W6KGo6L6+5byPID4+5ZCO6Z2i5LiN6IO95piv5pWw5a2X77yM6K+35q2j56Gu5aGr5YaZJwoJCQkJCSk7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgkJCWlmICghdGhpcy5iYXNpY19ydWxlcy5sb2dGZWF0dXJlKSB7CgkJCQl0aGlzLiRNZXNzYWdlLndhcm5pbmcoJ+ivt+Whq+WFpeaXpeW/l+aVsOaNricpOwoJCQkJcmV0dXJuOwoJCQl9CgkJCWlmICghdGhpcy5iYXNpY19ydWxlcy5leHRyYWN0UnVsZSkgewoJCQkJdGhpcy4kTWVzc2FnZS53YXJuaW5nKCfor7floavlhaXmj5Dlj5booajovr7lvI8nKTsKCQkJCXJldHVybjsKCQkJfQoJCQl0cnkgewoJCQkJdGVtcCA9IHRoaXMuYmFzaWNfcnVsZXMuc3VwcGxlbWVudFJ1bGUKCQkJCQk/IEpTT04ucGFyc2UodGhpcy5iYXNpY19ydWxlcy5zdXBwbGVtZW50UnVsZSkKCQkJCQk6ICcnOwoJCQkJaWYgKAoJCQkJCXRlbXAgJiYKCQkJCQlPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGVtcCkgIT09ICdbb2JqZWN0IE9iamVjdF0nCgkJCQkpIHsKCQkJCQlmbGFnID0gZmFsc2U7CgkJCQkJdGhpcy4kTWVzc2FnZS53YXJuaW5nKCfooaXlhYXooajovr7lvI/ovpPlhaXmoLzlvI/mnInor6/vvIzor7fmraPnoa7loavlhpknKTsKCQkJCX0KCQkJfSBjYXRjaCAoZXJyKSB7CgkJCQlmbGFnID0gZmFsc2U7CgkJCQl0aGlzLiRNZXNzYWdlLndhcm5pbmcoJ+ihpeWFheihqOi+vuW8j+i+k+WFpeacieivr++8jOivt+ato+ehruWhq+WGmScpOwoJCQkJcmV0dXJuOwoJCQl9CgkJCWlmICghZmxhZykgewoJCQkJcmV0dXJuOwoJCQl9CgkJCWxldCBwYXJhbXMgPSB7CgkJCQlzcmNfc3RyOiB0aGlzLmJhc2ljX3J1bGVzLmxvZ0ZlYXR1cmUsCgkJCQlleHRyYWN0X3J1bGU6IHRoaXMuYmFzaWNfcnVsZXMuZXh0cmFjdFJ1bGUsCgkJCQlzd2l0Y2hfcnVsZTogdGhpcy5iYXNpY19ydWxlcy5zd2l0Y2hSdWxlLAoJCQkJcmVwbGFjZV9ydWxlOiB0aGlzLmJhc2ljX3J1bGVzLnJlcGxhY2VSdWxlLAoJCQkJc3VwcGxlbWVudDogdGVtcCA9PT0gJycgPyB7fSA6IHRlbXAsCgkJCQl0ZXN0RmlsZVBhdGhzOiAnJywKCQkJCXRlc3RGaWxyUnVsZTogJycsCgkJCQlmbGFnOiBmYWxzZSwKCQkJfTsKCQkJdGVzdFJ1bGUocGFyYW1zKQoJCQkJLnRoZW4oKHJlcykgPT4gewoJCQkJCWlmIChBcnJheS5pc0FycmF5KHJlcykgJiYgcmVzLmxlbmd0aCA+IDApIHsKCQkJCQkJdGhpcy5jb2x1bW5zID0gT2JqZWN0LmtleXMocmVzWzBdKS5tYXAoKGtleXMpID0+IHsKCQkJCQkJCXJldHVybiB7CgkJCQkJCQkJa2V5OiBrZXlzLAoJCQkJCQkJCXRpdGxlOiBrZXlzLAoJCQkJCQkJfTsKCQkJCQkJfSk7CgkJCQkJCXRoaXMuZXhwcmVzc2lvbkRhdGEgPSByZXM7CgkJCQkJfSBlbHNlIGlmIChyZXMuZXJyb3IpIHsKCQkJCQkJdGhpcy4kTWVzc2FnZS5lcnJvcihyZXMuZXJyb3IpOwoJCQkJCX0gZWxzZSBpZiAocmVzLmxlbmd0aCA9PT0gMCkgewoJCQkJCQl0aGlzLiRNZXNzYWdlLmVycm9yKCflh7rnjrDlvILluLgs57y65bCR5o+Q5Y+W6K+t5Y+l5oiW6LWL5YC86K+t5Y+lJyk7CgkJCQkJfQoJCQkJfSkKCQkJCS5jYXRjaCgoZXJyKSA9PiB7CgkJCQkJY29uc29sZS5sb2coZXJyKTsKCQkJCQl0aGlzLiRNZXNzYWdlLmVycm9yKCfooajovr7lvI/mtYvor5XmnI3liqHlvILluLjvvIzor7fogZTns7vnrqHnkIblkZgnKTsKCQkJCX0pOwoJCQl0aGlzLmV4cHJlc3Npb25EYXRhID0gJyc7CgkJfSwKCX0sCn07Cg=="},{"version":3,"sources":["expression.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"expression.vue","sourceRoot":"src/views/operation/expression","sourcesContent":["<template>\n\t<div class=\"expression\">\n\t\t<Card>\n\t\t\t<Form\n\t\t\t\t:model=\"basic_rules\"\n\t\t\t\tref=\"basic_rules\"\n\t\t\t\t:rules=\"ruleFormRule\"\n\t\t\t\tlabel-position=\"top\"\n\t\t\t>\n\t\t\t\t<FormItem label=\"日志数据\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tv-model=\"basic_rules.logFeature\"\n\t\t\t\t\t\tplaceholder=\"请输入一条日志数据\"\n\t\t\t\t\t></Input>\n\t\t\t\t</FormItem>\n\t\t\t\t<FormItem label=\"提取表达式\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tv-model=\"basic_rules.extractRule\"\n\t\t\t\t\t\tplaceholder=\"用于提取字段，形如 %{IPV4>>ip},%{DATA>>result}\"\n\t\t\t\t\t></Input>\n\t\t\t\t</FormItem>\n\t\t\t\t<FormItem label=\"转换表达式\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tv-model=\"basic_rules.switchRule\"\n\t\t\t\t\t\tplaceholder=\"对提取字段进一步处理，形如 ip:$getGeo>>country,city\"\n\t\t\t\t\t></Input>\n\t\t\t\t</FormItem>\n\t\t\t\t<FormItem label=\"替换表达式\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tv-model=\"basic_rules.replaceRule\"\n\t\t\t\t\t\tplaceholder=\"对提取字段进一步处理，形如 result==succeed>>result=success\"\n\t\t\t\t\t></Input>\n\t\t\t\t</FormItem>\n\t\t\t\t<FormItem label=\"补充表达式\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tv-model=\"basic_rules.supplementRule\"\n\t\t\t\t\t\tplaceholder=\"用于补充字段，形如:{“type”:“http”,“opt”:“login”}\"\n\t\t\t\t\t></Input>\n\t\t\t\t</FormItem>\n\t\t\t</Form>\n\t\t\t<div class=\"ar\">\n\t\t\t\t<Button type=\"primary\" @click=\"test\">测试</Button>&nbsp;\n\t\t\t\t<Button type=\"default\" @click=\"reset\">重置</Button>\n\t\t\t</div>\n\t\t</Card>\n\t\t<div v-if=\"tabelFlag\">\n\t\t\t<Table :columns=\"columns\" :data=\"expressionData\" size=\"small\">\n\t\t\t</Table>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { testRule } from '@/api/operation';\nimport { regularRules } from '@/utils/util';\nexport default {\n\tname: 'expression',\n\tdata() {\n\t\treturn {\n\t\t\tbasic_rules: {\n\t\t\t\tlogFeature: '',\n\t\t\t\textractRule: '',\n\t\t\t\tswitchRule: '',\n\t\t\t\treplaceRule: '',\n\t\t\t\tsupplementRule: '',\n\t\t\t},\n\t\t\truleFormRule: {\n\t\t\t\textractRule: [\n\t\t\t\t\t{\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tMessage: '请输入规则名称',\n\t\t\t\t\t\ttrigger: 'change',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tlogFeature: [\n\t\t\t\t\t{\n\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\tMessage: '请输入日志数据',\n\t\t\t\t\t\ttrigger: 'blur',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tcolumns: [],\n\t\t\texpressionData: [],\n\t\t\ttabelFlag: false,\n\t\t};\n\t},\n\tmethods: {\n\t\treset() {\n\t\t\tthis.basic_rules = {\n\t\t\t\tlogFeature: '',\n\t\t\t\textractRule: '',\n\t\t\t\tswitchRule: '',\n\t\t\t\treplaceRule: '',\n\t\t\t\tsupplementRule: '',\n\t\t\t};\n\t\t},\n\t\ttest() {\n\t\t\tthis.tabelFlag = true;\n\t\t\tlet temp;\n\t\t\tlet flag = true;\n\t\t\tif (this.basic_rules.extractRule !== '') {\n\t\t\t\tif (regularRules(this.basic_rules.extractRule)) {\n\t\t\t\t\tthis.$Message.warning(\n\t\t\t\t\t\t'提取表达式 >>后面不能是数字，请正确填写'\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!this.basic_rules.logFeature) {\n\t\t\t\tthis.$Message.warning('请填入日志数据');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this.basic_rules.extractRule) {\n\t\t\t\tthis.$Message.warning('请填入提取表达式');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\ttemp = this.basic_rules.supplementRule\n\t\t\t\t\t? JSON.parse(this.basic_rules.supplementRule)\n\t\t\t\t\t: '';\n\t\t\t\tif (\n\t\t\t\t\ttemp &&\n\t\t\t\t\tObject.prototype.toString.call(temp) !== '[object Object]'\n\t\t\t\t) {\n\t\t\t\t\tflag = false;\n\t\t\t\t\tthis.$Message.warning('补充表达式输入格式有误，请正确填写');\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tflag = false;\n\t\t\t\tthis.$Message.warning('补充表达式输入有误，请正确填写');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!flag) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet params = {\n\t\t\t\tsrc_str: this.basic_rules.logFeature,\n\t\t\t\textract_rule: this.basic_rules.extractRule,\n\t\t\t\tswitch_rule: this.basic_rules.switchRule,\n\t\t\t\treplace_rule: this.basic_rules.replaceRule,\n\t\t\t\tsupplement: temp === '' ? {} : temp,\n\t\t\t\ttestFilePaths: '',\n\t\t\t\ttestFilrRule: '',\n\t\t\t\tflag: false,\n\t\t\t};\n\t\t\ttestRule(params)\n\t\t\t\t.then((res) => {\n\t\t\t\t\tif (Array.isArray(res) && res.length > 0) {\n\t\t\t\t\t\tthis.columns = Object.keys(res[0]).map((keys) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tkey: keys,\n\t\t\t\t\t\t\t\ttitle: keys,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.expressionData = res;\n\t\t\t\t\t} else if (res.error) {\n\t\t\t\t\t\tthis.$Message.error(res.error);\n\t\t\t\t\t} else if (res.length === 0) {\n\t\t\t\t\t\tthis.$Message.error('出现异常,缺少提取语句或赋值语句');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\tthis.$Message.error('表达式测试服务异常，请联系管理员');\n\t\t\t\t});\n\t\t\tthis.expressionData = '';\n\t\t},\n\t},\n};\n</script>\n"]}]}